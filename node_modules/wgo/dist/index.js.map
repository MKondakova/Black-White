{"version":3,"file":"index.js","sources":["../src/SGFParser/SGFSyntaxError.ts","../src/SGFParser/SGFParser.ts","../src/BoardBase/BoardObject.ts","../src/BoardBase/FieldObject.ts","../src/types.ts","../src/BoardBase/BoardMarkupObject.ts","../src/BoardBase/BoardLabelObject.ts","../src/BoardBase/BoardLineObject.ts","../src/utils/EventEmitter.ts","../src/utils/makeConfig.ts","../src/BoardBase/defaultConfig.ts","../src/BoardBase/BoardBase.ts","../src/CanvasBoard/CanvasLayer.ts","../src/CanvasBoard/ShadowLayer.ts","../src/CanvasBoard/GridLayer.ts","../src/CanvasBoard/drawHandlers/DrawHandler.ts","../src/CanvasBoard/drawHandlers/Stone.ts","../src/CanvasBoard/drawHandlers/ShellStoneBlack.ts","../src/CanvasBoard/drawHandlers/ShellStoneWhite.ts","../src/CanvasBoard/drawHandlers/GlassStoneBlack.ts","../src/CanvasBoard/drawHandlers/GlassStoneWhite.ts","../src/CanvasBoard/drawHandlers/PaintedStoneBlack.ts","../src/CanvasBoard/drawHandlers/PaintedStoneWhite.ts","../src/CanvasBoard/drawHandlers/SimpleStone.ts","../src/CanvasBoard/drawHandlers/RealisticStone.ts","../src/CanvasBoard/drawHandlers/MarkupDrawHandler.ts","../src/CanvasBoard/drawHandlers/ShapeMarkup.ts","../src/CanvasBoard/drawHandlers/Circle.ts","../src/CanvasBoard/drawHandlers/Square.ts","../src/CanvasBoard/drawHandlers/Triangle.ts","../src/CanvasBoard/drawHandlers/Label.ts","../src/CanvasBoard/drawHandlers/Dot.ts","../src/CanvasBoard/drawHandlers/XMark.ts","../src/CanvasBoard/drawHandlers/Line.ts","../src/CanvasBoard/drawHandlers/Arrow.ts","../src/CanvasBoard/drawHandlers/Dim.ts","../src/CanvasBoard/themes/baseTheme.ts","../src/CanvasBoard/themes/realisticTheme.ts","../src/CanvasBoard/themes/modernTheme.ts","../src/CanvasBoard/themes/index.ts","../src/CanvasBoard/CanvasBoard.ts","../src/kifu/propertyValueTypes.ts","../src/kifu/KifuNode.ts","../src/Game/rules.ts","../src/Game/Position.ts","../src/Game/Game.ts","../src/SGFParser/sgfTypes.ts","../src/PlayerBase/basePropertyListeners.ts","../src/PlayerBase/PlayerBase.ts","../src/PlayerDOM/PlayerDOM.ts","../src/SVGBoard/types.ts","../src/SVGBoard/svgDrawHandlers/Arrow.ts","../src/SVGBoard/svgDrawHandlers/SVGFieldDrawHandler.ts","../src/SVGBoard/svgDrawHandlers/SVGMarkupDrawHandler.ts","../src/SVGBoard/svgDrawHandlers/Circle.ts","../src/SVGBoard/svgDrawHandlers/Dim.ts","../src/SVGBoard/svgDrawHandlers/Dot.ts","../src/SVGBoard/generateId.ts","../src/SVGBoard/svgDrawHandlers/SVGStoneDrawHandler.ts","../src/SVGBoard/svgDrawHandlers/GlassStoneBlack.ts","../src/SVGBoard/svgDrawHandlers/GlassStoneWhite.ts","../src/SVGBoard/svgDrawHandlers/Label.ts","../src/SVGBoard/svgDrawHandlers/Line.ts","../src/SVGBoard/svgDrawHandlers/ModernStoneBlack.ts","../src/SVGBoard/svgDrawHandlers/ModernStoneWhite.ts","../src/SVGBoard/svgDrawHandlers/RealisticStone.ts","../src/SVGBoard/svgDrawHandlers/SimpleStone.ts","../src/SVGBoard/svgDrawHandlers/Square.ts","../src/SVGBoard/svgDrawHandlers/Triangle.ts","../src/SVGBoard/svgDrawHandlers/XMark.ts","../src/SVGBoard/createGrid.ts","../src/SVGBoard/createCoordinates.ts","../src/SVGBoard/defaultSVGTheme.ts","../src/SVGBoard/SVGBoard.ts","../src/SVGBoard/SVGCustomFieldObject.ts","../src/SVGBoard/SVGCustomLabelObject.ts","../src/PlayerDOM/components/SVGBoardComponent.ts","../src/PlayerDOM/components/CommentsBox.ts","../src/PlayerDOM/components/GameInfoBox.ts","../src/PlayerBase/plugins/EditMode.ts","../src/PlayerDOM/components/Container.ts","../src/PlayerDOM/components/ControlPanel.ts","../src/PlayerDOM/components/ResponsiveComponent.ts","../src/PlayerDOM/components/PlayerTag.ts","../src/SimplePlayer/SimplePlayer.ts"],"sourcesContent":["import SGFParser from './SGFParser';\r\n\r\n/**\r\n * Class for syntax errors in SGF string.\r\n * @ extends Error\r\n */\r\nexport class SGFSyntaxError extends Error {\r\n  // tslint:disable-next-line:variable-name\r\n  __proto__: Error;\r\n\r\n  constructor(message: string, parser?: SGFParser) {\r\n    super(message);\r\n    this.__proto__ = new.target.prototype;\r\n\r\n    // var tempError = Error.apply(this);\r\n    this.name = this.name = 'SGFSyntaxError';\r\n    this.message = message || 'There was an unspecified syntax error in the SGF';\r\n\r\n    if (parser) {\r\n      this.message += ` on line ${parser.lineNo}, char ${parser.charNo}:\\n`;\r\n      this.message += `\\t${parser.sgfString.split('\\n')[parser.lineNo - 1]}\\n`;\r\n      this.message += `\\t${Array(parser.charNo + 1).join(' ')}^`;\r\n    }\r\n  }\r\n}\r\n\r\n// a small ES5 hack because currently in ES6 you can't extend Errors\r\n// SGFSyntaxError.prototype = Object.create(Error.prototype);\r\n// SGFSyntaxError.prototype.constructor = SGFSyntaxError;\r\n\r\nexport default SGFSyntaxError;\r\n","import SGFSyntaxError from './SGFSyntaxError';\r\nimport { PropIdent, SGFProperties, SGFCollection, SGFGameTree, SGFNode } from './sgfTypes';\r\n\r\n/**\r\n * Contains methods for parsing sgf string.\r\n * @module SGFParser\r\n */\r\n\r\nconst CODE_A = 'A'.charCodeAt(0);\r\nconst CODE_Z = 'Z'.charCodeAt(0);\r\nconst CODE_WHITE_CHAR = ' '.charCodeAt(0);\r\n\r\nfunction isCharUCLetter(char: string) {\r\n  if (!char) {\r\n    return false;\r\n  }\r\n\r\n  const charCode = char.charCodeAt(0);\r\n  return charCode >= CODE_A && charCode <= CODE_Z;\r\n}\r\n\r\n/**\r\n * Class for parsing of sgf files. Can be used for parsing of SGF fragments as well.\r\n */\r\n\r\nexport default class SGFParser {\r\n  /** SGF string to be parsed */\r\n  sgfString: string;\r\n\r\n  /** Current character position */\r\n  position: number = 0;\r\n\r\n  /** Current line number */\r\n  lineNo: number = 1;\r\n\r\n  /** Current char number (on the line) */\r\n  charNo: number = 0;\r\n\r\n  /**\r\n   * Creates new instance of SGF parser with SGF loaded ready to be parsed.\r\n   * @param sgf string to parse.\r\n   */\r\n  constructor(sgf: string) {\r\n    this.sgfString = sgf;\r\n  }\r\n\r\n  /**\r\n   * Returns current significant character (ignoring whitespace characters).\r\n   * If there is end of string, return undefined.\r\n   */\r\n  protected currentChar(): string {\r\n    while (this.sgfString.charCodeAt(this.position) <= CODE_WHITE_CHAR) {\r\n      // While the character is a whitespace, increase position pointer and line and column numbers.\r\n      this.nextChar();\r\n    }\r\n\r\n    return this.sgfString[this.position];\r\n  }\r\n\r\n  /**\r\n   * Move pointer to next character and return it (including whitespace).\r\n   */\r\n  protected nextChar() {\r\n    if (this.sgfString[this.position] === '\\n') {\r\n      this.charNo = 0;\r\n      this.lineNo++;\r\n    } else {\r\n      this.charNo++;\r\n    }\r\n    this.position++;\r\n\r\n    return this.sgfString[this.position];\r\n  }\r\n\r\n  /**\r\n   * Reads current significant character and if it isn't equal with the argument, throws an error.\r\n   * Then move pointer to next character.\r\n   */\r\n  protected processChar(char: string) {\r\n    if (this.currentChar() !== char) {\r\n      throw new SGFSyntaxError(`Unexpected character ${this.currentChar()}. Character ${char} was expected.`, this);\r\n    }\r\n\r\n    return this.nextChar();\r\n  }\r\n\r\n  /**\r\n   * Parse SGF property value - `\"[\" CValueType \"]\"`.\r\n   * @param optional\r\n   */\r\n  parsePropertyValue(optional?: boolean): string {\r\n    if (optional && this.currentChar() !== '[') {\r\n      return;\r\n    }\r\n\r\n    let value = '';\r\n\r\n    // process \"[\" and read first char\r\n    let char = this.processChar('[');\r\n\r\n    while (char !== ']') {\r\n      if (!char) {\r\n        // char mustn't be undefined\r\n        throw new SGFSyntaxError('End of SGF inside of property', this);\r\n      } else if (char === '\\\\') {\r\n        // if there is character '\\' save next character\r\n        char = this.nextChar();\r\n\r\n        if (!char) {\r\n          // char have to exist of course\r\n          throw new SGFSyntaxError('End of SGF inside of property', this);\r\n        } else if (char === '\\n') {\r\n          // ignore new line, otherwise save\r\n          continue;\r\n        }\r\n      }\r\n\r\n      // save the character\r\n      value += char;\r\n\r\n      // and move to next one\r\n      char = this.nextChar();\r\n    }\r\n\r\n    this.processChar(']');\r\n\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Reads the property identifiers (One or more UC letters) - `UcLetter { UcLetter }`.\r\n   */\r\n  parsePropertyIdent(): PropIdent {\r\n    let ident = '';\r\n\r\n    // Read current significant character\r\n    let char = this.currentChar();\r\n\r\n    if (!isCharUCLetter(char)) {\r\n      throw new SGFSyntaxError('Property identifier must consists from upper case letters.', this);\r\n    }\r\n\r\n    ident += char;\r\n\r\n    while (char = this.nextChar()) {\r\n      if (!isCharUCLetter(char)) {\r\n        break;\r\n      }\r\n\r\n      ident += char;\r\n    }\r\n\r\n    return ident as PropIdent;\r\n  }\r\n\r\n  /**\r\n   * Parses sequence of property values - `PropValue { PropValue }`.\r\n   */\r\n  parsePropertyValues() {\r\n    const values: string[] = [];\r\n    let value = this.parsePropertyValue();\r\n\r\n    if (value) {\r\n      values.push(value);\r\n    }\r\n\r\n    while (value = this.parsePropertyValue(true)) {\r\n      values.push(value);\r\n    }\r\n\r\n    return values;\r\n  }\r\n\r\n  /**\r\n   * Parses a SGF property - `PropIdent PropValue { PropValue }`.\r\n   */\r\n  parseProperty(): [PropIdent, string[]] {\r\n    if (!isCharUCLetter(this.currentChar())) {\r\n      return;\r\n    }\r\n\r\n    return [this.parsePropertyIdent(), this.parsePropertyValues()];\r\n  }\r\n\r\n  /**\r\n   * Parses a SGF node - `\";\" { Property }`.\r\n   */\r\n  parseNode(): SGFNode {\r\n    this.processChar(';');\r\n\r\n    const properties: SGFProperties = {};\r\n    let property: [PropIdent, string[]];\r\n\r\n    while (property = this.parseProperty()) {\r\n      properties[property[0]] = property[1];\r\n    }\r\n\r\n    return properties;\r\n  }\r\n\r\n  /**\r\n   * Parses a SGF Sequence - `Node { Node }`.\r\n   */\r\n  parseSequence(): SGFNode[] {\r\n    const sequence: SGFNode[] = [];\r\n\r\n    sequence.push(this.parseNode());\r\n\r\n    while (this.currentChar() === ';') {\r\n      sequence.push(this.parseNode());\r\n    }\r\n\r\n    return sequence;\r\n  }\r\n\r\n  /**\r\n   * Parses a SGF *GameTree* - `\"(\" Sequence { GameTree } \")\"`.\r\n   */\r\n  parseGameTree(): SGFGameTree {\r\n    this.processChar('(');\r\n\r\n    const sequence = this.parseSequence();\r\n    let children: SGFGameTree[] = [];\r\n\r\n    if (this.currentChar() === '(') {\r\n      children = this.parseCollection();\r\n    }\r\n\r\n    this.processChar(')');\r\n\r\n    return { sequence, children };\r\n  }\r\n\r\n  /**\r\n   * Parses a SGF *Collection* - `Collection = GameTree { GameTree }`. This is the main method for parsing SGF file.\r\n   */\r\n  parseCollection(): SGFCollection {\r\n    const gameTrees: SGFCollection = [];\r\n    gameTrees.push(this.parseGameTree());\r\n\r\n    while (this.currentChar() === '(') {\r\n      gameTrees.push(this.parseGameTree());\r\n    }\r\n\r\n    return gameTrees;\r\n  }\r\n}\r\n","/**\r\n * Represents generic board object specified by type, which can be painted on the board.\r\n * It contains z-index and opacity.\r\n */\r\nexport default class BoardObject {\r\n  type: string;\r\n  zIndex: number = 0;\r\n  opacity: number = 1;\r\n\r\n  constructor(type: string) {\r\n    this.type = type;\r\n  }\r\n}\r\n","import BoardObject from './BoardObject';\r\n\r\n/**\r\n * Represents board object specified by type, which can be painted on the specific field of the board.\r\n * It can be also transformed.\r\n */\r\nexport default class FieldObject extends BoardObject {\r\n  x: number;\r\n  y: number;\r\n  scaleX: number = 1;\r\n  scaleY: number = 1;\r\n  rotate: number = 0;\r\n\r\n  constructor(type: string, x = 0, y = 0) {\r\n    super(type);\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  setPosition(x: number, y: number) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  setScale(factor: number) {\r\n    this.scaleX = factor;\r\n    this.scaleY = factor;\r\n  }\r\n}\r\n","/**\r\n * Enumeration representing stone color, can be used for representing board position.\r\n */\r\nexport enum Color {\r\n  BLACK = 1,\r\n  B = 1,\r\n  WHITE = -1,\r\n  W = -1,\r\n  EMPTY = 0,\r\n  E = 0,\r\n}\r\n\r\n/**\r\n * Simple 2 dimensional vector for referencing field on the board.\r\n */\r\nexport interface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nexport interface Label extends Point {\r\n  text: string;\r\n}\r\n\r\nexport type Vector = Point[];\r\n\r\nexport interface Label extends Point {\r\n  text: string;\r\n}\r\n\r\nexport interface Field extends Point {\r\n  c: Color;\r\n}\r\n\r\nexport interface Move extends Point {\r\n  c: Color.BLACK | Color.WHITE;\r\n}\r\n","import { Color } from '../types';\r\nimport FieldObject from './FieldObject';\r\n\r\n/**\r\n * Board markup object is special type of field object, which can have 3 variations - for empty field\r\n * and for black and white stone.\r\n */\r\nexport default class BoardMarkupObject extends FieldObject {\r\n  variation: Color;\r\n\r\n  constructor(type: string, x = 0, y = 0, variation: Color = Color.E) {\r\n    super(type, x, y);\r\n    this.variation = variation;\r\n  }\r\n}\r\n","import { Color } from '../types';\r\nimport BoardMarkupObject from './BoardMarkupObject';\r\n\r\n/**\r\n * Board label object is special type of markup object, which renders text on the field.\r\n */\r\nexport default class BoardLabelObject extends BoardMarkupObject {\r\n  text: string;\r\n\r\n  constructor(text: string, x = 0, y = 0, variation?: Color) {\r\n    super('LB', x, y, variation);\r\n\r\n    this.text = text;\r\n  }\r\n}\r\n","import { Point } from '../types';\r\nimport BoardObject from './BoardObject';\r\n\r\n/**\r\n * Board line object is special type of object, which consist from start and end point.\r\n */\r\nexport default class BoardLineObject extends BoardObject {\r\n  start: Point;\r\n  end: Point;\r\n\r\n  constructor(type: string, start: Point, end: Point) {\r\n    super(type);\r\n    this.start = start;\r\n    this.end = end;\r\n  }\r\n}\r\n","/**\r\n * Simple base class for event handling. It tries to follow Node.js EventEmitter class API,\r\n * but contains only basic methods.\r\n */\r\nexport default class EventEmitter {\r\n  // tslint:disable-next-line:variable-name\r\n  private _events: {[eventName: string]: Function[]} = {};\r\n\r\n  on(evName: string, callback: Function) {\r\n    this._events[evName] = this._events[evName] || [];\r\n    this._events[evName].push(callback);\r\n  }\r\n\r\n  off(evName: string, callback: Function) {\r\n    if (this._events[evName]) {\r\n      if (callback == null) {\r\n        this._events[evName] = [];\r\n      }\r\n      this._events[evName] = this._events[evName].filter(fn => fn !== callback);\r\n    }\r\n  }\r\n\r\n  emit(evName: string, ...args: any[]) {\r\n    if (this._events[evName]) {\r\n      this._events[evName].forEach(fn => fn(...args));\r\n    }\r\n  }\r\n}\r\n","export type PartialRecursive<T> = {\r\n  [P in keyof T]?: T[P] | PartialRecursive<T[P]>;\r\n};\r\n\r\n/**\r\n * Helper function for merging default config with provided config.\r\n *\r\n * @param defaults\r\n * @param config\r\n */\r\nexport default function makeConfig<T>(defaults: T, config: PartialRecursive<T> & { [key: string]: any }): T {\r\n  const mergedConfig: any = {};\r\n  const defaultKeys = Object.keys(defaults);\r\n  defaultKeys.forEach((key) => {\r\n    const val = (config as any)[key];\r\n    const defVal = (defaults as any)[key];\r\n\r\n    if (val != null && val.constructor === Object && !Array.isArray(val) && defVal != null) {\r\n      mergedConfig[key] = makeConfig(defVal, val);\r\n    } else if (val !== undefined) {\r\n      mergedConfig[key] = val;\r\n    } else {\r\n      mergedConfig[key] = defVal;\r\n    }\r\n  });\r\n\r\n  Object.keys(config).forEach((key) => {\r\n    if (defaultKeys.indexOf(key) === -1) {\r\n      mergedConfig[key] = (config as any)[key];\r\n    }\r\n  });\r\n\r\n  return mergedConfig;\r\n}\r\n","export const defaultBoardBaseTheme = {\r\n  // basic\r\n  stoneSize: 0.47,\r\n  marginSize: 0.25,\r\n  font: 'calibri',\r\n  backgroundColor: '#CEB053',\r\n  backgroundImage: '',\r\n\r\n  // markup\r\n  markupBlackColor: 'rgba(255,255,255,0.9)',\r\n  markupWhiteColor: 'rgba(0,0,0,0.7)',\r\n  markupNoneColor: 'rgba(0,0,0,0.7)',\r\n  markupLineWidth: 0.05,\r\n\r\n  // shadows\r\n  shadowColor: 'rgba(62,32,32,0.5)',\r\n  shadowTransparentColor: 'rgba(62,32,32,0)',\r\n  shadowBlur: 0.25,\r\n  shadowOffsetX: 0.07,\r\n  shadowOffsetY: 0.13,\r\n\r\n  // grid\r\n  grid: {\r\n    linesWidth: 0.03,\r\n    linesColor: '#654525',\r\n    starColor: '#531',\r\n    starSize: 0.07,\r\n  },\r\n\r\n  // coordinates\r\n  coordinates: {\r\n    color: '#531',\r\n    bold: false,\r\n  },\r\n};\r\n\r\nexport const defaultBoardBaseConfig = {\r\n  size: 19,\r\n  width: 0,\r\n  height: 0,\r\n  starPoints: {\r\n    5: [{ x: 2, y: 2 }],\r\n    7: [{ x: 3, y: 3 }],\r\n    8: [{ x: 2, y: 2 }, { x: 5, y: 2 }, { x: 2, y: 5 }, { x: 5, y: 5 }],\r\n    9: [{ x: 2, y: 2 }, { x: 6, y: 2 }, { x: 4, y: 4 }, { x: 2, y: 6 }, { x: 6, y: 6 }],\r\n    10: [{ x: 2, y: 2 }, { x: 7, y: 2 }, { x: 2, y: 7 }, { x: 7, y: 7 }],\r\n    11: [{ x: 2, y: 2 }, { x: 8, y: 2 }, { x: 5, y: 5 }, { x: 2, y: 8 }, { x: 8, y: 8 }],\r\n    12: [{ x: 3, y: 3 }, { x: 8, y: 3 }, { x: 3, y: 8 }, { x: 8, y: 8 }],\r\n    13: [{ x: 3, y: 3 }, { x: 9, y: 3 }, { x: 6, y: 6 }, { x: 3, y: 9 }, { x: 9, y: 9 }],\r\n    14: [{ x: 3, y: 3 }, { x: 10, y: 3 }, { x: 3, y: 10 }, { x: 10, y: 10 }],\r\n    15: [{ x: 3, y: 3 }, { x: 11, y: 3 }, { x: 7, y: 7 }, { x: 3, y: 11 }, { x: 11, y: 11 }],\r\n    16: [{ x: 3, y: 3 }, { x: 12, y: 3 }, { x: 3, y: 12 }, { x: 12, y: 12 }],\r\n    17: [{ x: 3, y: 3 }, { x: 8, y: 3 }, { x: 13, y: 3 }, { x: 3, y: 8 }, { x: 8, y: 8 },\r\n    { x: 13, y: 8 }, { x: 3, y: 13 }, { x: 8, y: 13 }, { x: 13, y: 13 }],\r\n    18: [{ x: 3, y: 3 }, { x: 14, y: 3 }, { x: 3, y: 14 }, { x: 14, y: 14 }],\r\n    19: [{ x: 3, y: 3 }, { x: 9, y: 3 }, { x: 15, y: 3 }, { x: 3, y: 9 }, { x: 9, y: 9 },\r\n    { x: 15, y: 9 }, { x: 3, y: 15 }, { x: 9, y: 15 }, { x: 15, y: 15 }],\r\n    20: [{ x: 3, y: 3 }, { x: 16, y: 3 }, { x: 3, y: 16 }, { x: 16, y: 16 }],\r\n    21: [{ x: 3, y: 3 }, { x: 10, y: 3 }, { x: 17, y: 3 }, { x: 3, y: 10 }, { x: 10, y: 10 },\r\n    { x: 17, y: 10 }, { x: 3, y: 17 }, { x: 10, y: 17 }, { x: 17, y: 17 }],\r\n  },\r\n  viewport: {\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n  },\r\n  coordinates: false,\r\n  coordinateLabelsX: 'ABCDEFGHJKLMNOPQRSTUVWXYZ',\r\n  coordinateLabelsY: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25],\r\n  theme: defaultBoardBaseTheme,\r\n};\r\n","import EventEmitter from '../utils/EventEmitter';\r\nimport makeConfig, { PartialRecursive } from '../utils/makeConfig';\r\nimport { Board, BoardBaseConfig, BoardViewport } from './types';\r\nimport { BoardObject } from '.';\r\nimport FieldObject from './FieldObject';\r\nimport { defaultBoardBaseConfig } from './defaultConfig';\r\n\r\n/**\r\n * Board class with basic functionality which can be used for creating custom boards.\r\n */\r\nexport default class BoardBase extends EventEmitter implements Board {\r\n  config: BoardBaseConfig;\r\n  element: HTMLElement;\r\n  objects: BoardObject[] = [];\r\n\r\n  constructor(element: HTMLElement, config: PartialRecursive<BoardBaseConfig> = {}) {\r\n    super();\r\n\r\n    // merge user config with default\r\n    this.element = element;\r\n    this.config = makeConfig(defaultBoardBaseConfig, config);\r\n  }\r\n\r\n  /**\r\n   * Updates dimensions and redraws everything\r\n   */\r\n  resize() {\r\n    // subclass may do resize things here\r\n  }\r\n\r\n  /**\r\n   * Redraw everything.\r\n   */\r\n  redraw() {\r\n    // subclass should implement this\r\n  }\r\n\r\n  /**\r\n   * Add board object. Main function for adding graphics on the board.\r\n   *\r\n   * @param boardObject\r\n   */\r\n  addObject(boardObject: BoardObject | BoardObject[]) {\r\n    // handling multiple objects\r\n    if (Array.isArray(boardObject)) {\r\n      for (let i = 0; i < boardObject.length; i++) {\r\n        this.addObject(boardObject[i]);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (!this.hasObject(boardObject)) {\r\n      this.objects.push(boardObject);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Method to update board object. Can be called, when some params of boardObject changes.\r\n   * It is similar to redraw(), but only boardObject can be redrawn, so performance can/should be better.\r\n   *\r\n   * @param boardObject\r\n   */\r\n  updateObject(boardObject: BoardObject | BoardObject[]) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Remove board object. Main function for removing graphics on the board.\r\n   *\r\n   * @param boardObject\r\n   */\r\n  removeObject(boardObject: BoardObject | BoardObject[]) {\r\n    // handling multiple objects\r\n    if (Array.isArray(boardObject)) {\r\n      for (let i = 0; i < boardObject.length; i++) {\r\n        this.removeObject(boardObject[i]);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const objectPos = this.objects.indexOf(boardObject);\r\n\r\n    if (objectPos === -1) {\r\n      // object isn't on the board, ignore it\r\n      return;\r\n    }\r\n\r\n    this.objects.splice(objectPos, 1);\r\n  }\r\n\r\n  /**\r\n   * Removes all objects on specified field.\r\n   *\r\n   * @param x\r\n   * @param y\r\n   */\r\n  removeObjectsAt(x: number, y: number) {\r\n    this.objects.forEach((obj) => {\r\n      if (obj instanceof FieldObject && obj.x === x && obj.y === y) {\r\n        this.removeObject(obj);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Removes all objects on the board.\r\n   */\r\n  removeAllObjects() {\r\n    this.objects = [];\r\n  }\r\n\r\n  /**\r\n   * Returns true if object is already on the board.\r\n   *\r\n   * @param boardObject\r\n   */\r\n  hasObject(boardObject: BoardObject) {\r\n    return this.objects.indexOf(boardObject) >= 0;\r\n  }\r\n\r\n  /**\r\n   * Sets width of the board, height will be automatically computed. Then everything will be redrawn.\r\n   *\r\n   * @param width\r\n   */\r\n  setWidth(width: number) {\r\n    this.config.width = width;\r\n    this.config.height = 0;\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n   * Sets height of the board, width will be automatically computed. Then everything will be redrawn.\r\n   *\r\n   * @param height\r\n   */\r\n  setHeight(height: number) {\r\n    this.config.width = 0;\r\n    this.config.height = height;\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n   * Sets exact dimensions of the board. Then everything will be redrawn.\r\n   *\r\n   * @param width\r\n   * @param height\r\n   */\r\n  setDimensions(width: number, height: number) {\r\n    this.config.width = width;\r\n    this.config.height = height;\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n\t * Get currently visible section of the board.\r\n\t */\r\n\r\n  getViewport() {\r\n    return this.config.viewport;\r\n  }\r\n\r\n  /**\r\n\t * Set section of the board to be displayed.\r\n\t */\r\n  setViewport(viewport: BoardViewport) {\r\n    this.config.viewport = viewport;\r\n  }\r\n\r\n  /**\r\n   * Helper to get board size.\r\n   */\r\n  getSize() {\r\n    return this.config.size;\r\n  }\r\n\r\n  /**\r\n   * Helper to set board size.\r\n   */\r\n  setSize(size: number = 19) {\r\n    this.config.size = size;\r\n  }\r\n\r\n  /**\r\n   * Returns true, if coordinates around board are visible.\r\n   */\r\n  getCoordinates() {\r\n    return this.config.coordinates;\r\n  }\r\n\r\n  /**\r\n   * Enable or disable coordinates around board.\r\n   */\r\n  setCoordinates(coordinates: boolean) {\r\n    this.config.coordinates = coordinates;\r\n  }\r\n}\r\n","/* global document, window */\r\nimport CanvasBoard from './CanvasBoard';\r\nimport { BoardObject, FieldObject } from '../BoardBase';\r\nimport { DrawFunction } from './types';\r\n\r\n/**\r\n * @class\r\n * Implements one layer of the HTML5 canvas\r\n */\r\n\r\nexport default class CanvasLayer {\r\n  element: HTMLCanvasElement;\r\n  context: CanvasRenderingContext2D;\r\n  pixelRatio: number;\r\n  board: CanvasBoard;\r\n\r\n  constructor(board: CanvasBoard) {\r\n    this.board = board;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.element = document.createElement('canvas');\r\n    this.element.style.position = 'absolute';\r\n    // this.element.style.zIndex = weight.toString(10);\r\n    this.element.style.width = '100%';\r\n    this.element.style.height = '100%';\r\n\r\n    this.context = this.element.getContext('2d');\r\n    this.context.scale(this.board.pixelRatio, this.board.pixelRatio);\r\n    this.context.save();\r\n\r\n    this.board.boardElement.appendChild(this.element);\r\n  }\r\n\r\n  resize(width: number, height: number) {\r\n    const linesShift = this.board.config.theme.linesShift;\r\n\r\n    this.element.width = width;\r\n    this.element.height = height;\r\n\r\n    this.context.transform(1, 0, 0, 1, linesShift, linesShift);\r\n  }\r\n\r\n  draw(drawFunction: DrawFunction, boardObject: BoardObject) {\r\n    try {\r\n      // create a \"sandbox\" for drawing function\r\n      this.context.save();\r\n\r\n      if (boardObject instanceof FieldObject) {\r\n        const leftOffset = this.board.getX(boardObject.x);\r\n        const topOffset = this.board.getY(boardObject.y);\r\n        const fieldSize = this.board.fieldSize;\r\n\r\n        this.context.transform(\r\n          fieldSize * boardObject.scaleX,\r\n          0, 0,\r\n          fieldSize * boardObject.scaleY,\r\n          leftOffset,\r\n          topOffset,\r\n        );\r\n        this.context.rotate(boardObject.rotate);\r\n        this.context.globalAlpha = boardObject.opacity;\r\n      } else {\r\n        const leftOffset = this.board.getX(0);\r\n        const topOffset = this.board.getY(0);\r\n        const fieldSize = this.board.fieldSize;\r\n\r\n        this.context.transform(\r\n          fieldSize,\r\n          0, 0,\r\n          fieldSize,\r\n          leftOffset,\r\n          topOffset,\r\n        );\r\n      }\r\n\r\n      const res = drawFunction(this.context, this.board.config, boardObject);\r\n\r\n      // restore context\r\n      this.context.restore();\r\n\r\n      if (res && res.then) {\r\n        res.then(() => {\r\n          this.board.redraw();\r\n        });\r\n      }\r\n    } catch (err) {\r\n      // If the board is too small some canvas painting function can throw an exception, but we don't\r\n      // want to break our app\r\n      // tslint:disable-next-line:no-console\r\n      console.error(`Object couldn't be rendered. Error: ${err.message}`, boardObject);\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.context.clearRect(0, 0, this.element.width, this.element.height);\r\n  }\r\n}\r\n","import CanvasLayer from './CanvasLayer';\r\n\r\n/**\r\n * @class\r\n * @extends WGo.CanvasBoard.CanvasLayer\r\n * Layer for shadows. It is slightly translated.\r\n */\r\n\r\nexport default class ShadowLayer extends CanvasLayer {\r\n  resize(width: number, height: number) {\r\n    super.resize(width, height);\r\n    this.context.transform(\r\n      1,\r\n      0,\r\n      0,\r\n      1,\r\n      this.board.config.theme.shadowOffsetX * this.board.fieldSize,\r\n      this.board.config.theme.shadowOffsetY * this.board.fieldSize,\r\n    );\r\n  }\r\n}\r\n","import CanvasLayer from './CanvasLayer';\r\n\r\nexport default class GridLayer extends CanvasLayer {\r\n  init() {\r\n    super.init();\r\n    this.drawGrid();\r\n  }\r\n\r\n  clear() {\r\n    super.clear();\r\n    this.drawGrid();\r\n  }\r\n\r\n  drawGrid() {\r\n    // draw grid\r\n    let tmp;\r\n    const params = this.board.config.theme.grid;\r\n\r\n    this.context.beginPath();\r\n    this.context.lineWidth = params.linesWidth * this.board.fieldSize;\r\n    this.context.strokeStyle = params.linesColor;\r\n\r\n    const tx = Math.round(this.board.getX(0));\r\n    const ty = Math.round(this.board.getY(0));\r\n    const bw = Math.round((this.board.config.size - 1) * this.board.fieldSize);\r\n    const bh = Math.round((this.board.config.size - 1) * this.board.fieldSize);\r\n\r\n    this.context.strokeRect(tx, ty, bw, bh);\r\n\r\n    for (let i = 1; i < this.board.config.size - 1; i++) {\r\n      tmp = Math.round(this.board.getX(i));\r\n      this.context.moveTo(tmp, ty);\r\n      this.context.lineTo(tmp, ty + bh);\r\n\r\n      tmp = Math.round(this.board.getY(i));\r\n      this.context.moveTo(tx, tmp);\r\n      this.context.lineTo(tx + bw, tmp);\r\n    }\r\n\r\n    this.context.stroke();\r\n\r\n    // draw stars\r\n    this.context.fillStyle = params.starColor;\r\n\r\n    if (this.board.config.starPoints[this.board.config.size]) {\r\n      for (const key in this.board.config.starPoints[this.board.config.size]) {\r\n        this.context.beginPath();\r\n        this.context.arc(\r\n          this.board.getX(this.board.config.starPoints[this.board.config.size][key].x),\r\n          this.board.getY(this.board.config.starPoints[this.board.config.size][key].y),\r\n          params.starSize * this.board.fieldSize, 0, 2 * Math.PI, true,\r\n        );\r\n        this.context.fill();\r\n      }\r\n    }\r\n\r\n    if (this.board.config.coordinates) {\r\n      this.drawCoordinates();\r\n    }\r\n  }\r\n\r\n  drawCoordinates() {\r\n    let t;\r\n    const params = this.board.config.theme.coordinates;\r\n\r\n    this.context.fillStyle = params.color;\r\n    this.context.textBaseline = 'middle';\r\n    this.context.textAlign = 'center';\r\n    // tslint:disable-next-line:max-line-length\r\n    this.context.font = `${params.bold ? 'bold ' : ''}${this.board.fieldSize / 2}px ${this.board.config.theme.font || ''}`;\r\n\r\n    const xRight = this.board.getX(-0.75);\r\n    const xLeft = this.board.getX(this.board.config.size - 0.25);\r\n    const yTop = this.board.getY(-0.75);\r\n    const yBottom = this.board.getY(this.board.config.size - 0.25);\r\n\r\n    const coordinatesX = this.board.config.coordinateLabelsX;\r\n    const coordinatesY = this.board.config.coordinateLabelsY;\r\n\r\n    for (let i = 0; i < this.board.config.size; i++) {\r\n      t = this.board.getY(i);\r\n      this.context.fillText(coordinatesX[i] as string, xRight, t);\r\n      this.context.fillText(coordinatesX[i] as string, xLeft, t);\r\n\r\n      t = this.board.getX(i);\r\n      this.context.fillText(coordinatesY[i] as string, t, yTop);\r\n      this.context.fillText(coordinatesY[i] as string, t, yBottom);\r\n    }\r\n\r\n    this.context.fillStyle = 'black';\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport { BoardObject } from '../../boardBase';\r\n\r\nexport default abstract class DrawHandler<P extends object = {}> {\r\n  params: P;\r\n\r\n  constructor(params: P = {} as any) {\r\n    this.params = params;\r\n  }\r\n\r\n  stone?(context: CanvasRenderingContext2D, config: CanvasBoardConfig, boardObject: BoardObject): void;\r\n  shadow?(context: CanvasRenderingContext2D, config: CanvasBoardConfig, boardObject: BoardObject): void;\r\n  grid?(context: CanvasRenderingContext2D, config: CanvasBoardConfig, boardObject: BoardObject): void;\r\n}\r\n","import DrawHandler from './DrawHandler';\r\nimport { CanvasBoardConfig } from '../types';\r\n\r\n/**\r\n * Provides shadow for the stone.\r\n */\r\nexport default class Stone extends DrawHandler {\r\n  shadow(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    const blur = boardConfig.theme.shadowBlur;\r\n\r\n    const startRadius = Math.max(stoneRadius - stoneRadius * blur, 0.00001);\r\n    const stopRadius = stoneRadius + (1 / 7 * stoneRadius) * blur;\r\n\r\n    const gradient = canvasCtx.createRadialGradient(0, 0, startRadius, 0, 0, stopRadius);\r\n    gradient.addColorStop(0, boardConfig.theme.shadowColor);\r\n    gradient.addColorStop(1, boardConfig.theme.shadowTransparentColor);\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = gradient;\r\n    canvasCtx.arc(0, 0, stopRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport Stone from './Stone';\r\n\r\nexport default class ShellStoneBlack extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = '#000';\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    let radGrad = canvasCtx.createRadialGradient(\r\n      0.4 * stoneRadius,\r\n      0.4 * stoneRadius,\r\n      0,\r\n      0.5 * stoneRadius,\r\n      0.5 * stoneRadius,\r\n      stoneRadius,\r\n    );\r\n    radGrad.addColorStop(0, 'rgba(32,32,32,1)');\r\n    radGrad.addColorStop(1, 'rgba(0,0,0,0)');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(\r\n      0,\r\n      0,\r\n      stoneRadius,\r\n      0,\r\n      2 * Math.PI,\r\n      true,\r\n    );\r\n    canvasCtx.fill();\r\n\r\n    radGrad = canvasCtx.createRadialGradient(\r\n      -0.4 * stoneRadius,\r\n      -0.4 * stoneRadius,\r\n      0.05 * stoneRadius,\r\n      -0.5 * stoneRadius,\r\n      -0.5 * stoneRadius,\r\n      1.5 * stoneRadius,\r\n    );\r\n    radGrad.addColorStop(0, 'rgba(64,64,64,1)');\r\n    radGrad.addColorStop(1, 'rgba(0,0,0,0)');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(\r\n      0,\r\n      0,\r\n      stoneRadius,\r\n      0,\r\n      2 * Math.PI,\r\n      true,\r\n    );\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport Stone from './Stone';\r\nimport { FieldObject } from '../../BoardBase';\r\n\r\n// shell stone helping functions\r\nconst shellSeed = Math.ceil(Math.random() * 9999999);\r\n\r\nexport default class ShellStoneWhite extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig, boardObject: FieldObject) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = '#aaa';\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    // do shell magic here\r\n    const type = shellSeed % (3 + boardObject.x * boardConfig.size + boardObject.y) % 3;\r\n    const z = boardConfig.size * boardConfig.size + boardObject.x * boardConfig.size + boardObject.y;\r\n    const angle = (2 / z) * (shellSeed % z);\r\n\r\n    if (type === 0) {\r\n      this.drawShell({\r\n        ctx: canvasCtx,\r\n        x: 0,\r\n        y: 0,\r\n        radius: stoneRadius,\r\n        angle,\r\n        lines: [0.10, 0.12, 0.11, 0.10, 0.09, 0.09, 0.09, 0.09],\r\n        factor: 0.25,\r\n        thickness: 1.75,\r\n      });\r\n    } else if (type === 1) {\r\n      this.drawShell({\r\n        ctx: canvasCtx,\r\n        x: 0,\r\n        y: 0,\r\n        radius: stoneRadius,\r\n        angle,\r\n        lines: [0.10, 0.09, 0.08, 0.07, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06],\r\n        factor: 0.2,\r\n        thickness: 1.5,\r\n      });\r\n    } else {\r\n      this.drawShell({\r\n        ctx: canvasCtx,\r\n        x: 0,\r\n        y: 0,\r\n        radius: stoneRadius,\r\n        angle,\r\n        lines: [0.12, 0.14, 0.13, 0.12, 0.12, 0.12],\r\n        factor: 0.3,\r\n        thickness: 2,\r\n      });\r\n    }\r\n\r\n    const radGrad = canvasCtx.createRadialGradient(\r\n      -2 * stoneRadius / 5,\r\n      -2 * stoneRadius / 5,\r\n      stoneRadius / 3,\r\n      -stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      5 * stoneRadius / 5,\r\n    );\r\n    radGrad.addColorStop(0, 'rgba(255,255,255,0.9)');\r\n    radGrad.addColorStop(1, 'rgba(255,255,255,0)');\r\n\r\n    // add radial gradient //\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n  }\r\n\r\n  drawShell(arg: any) {\r\n    let fromAngle = arg.angle;\r\n    let toAngle = arg.angle;\r\n\r\n    for (let i = 0; i < arg.lines.length; i++) {\r\n      fromAngle += arg.lines[i];\r\n      toAngle -= arg.lines[i];\r\n      this.drawShellLine(arg.ctx, arg.x, arg.y, arg.radius, fromAngle, toAngle, arg.factor, arg.thickness);\r\n    }\r\n  }\r\n\r\n  drawShellLine(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number,\r\n    y: number,\r\n    r: number,\r\n    startAngle: number,\r\n    endAngle: number,\r\n    factor: number,\r\n    thickness: number,\r\n  ) {\r\n    ctx.strokeStyle = 'rgba(64,64,64,0.2)';\r\n\r\n    ctx.lineWidth = (r / 30) * thickness;\r\n    ctx.beginPath();\r\n\r\n    const radius = r * 0.9;\r\n\r\n    const x1 = x + radius * Math.cos(startAngle * Math.PI);\r\n    const y1 = y + radius * Math.sin(startAngle * Math.PI);\r\n    const x2 = x + radius * Math.cos(endAngle * Math.PI);\r\n    const y2 = y + radius * Math.sin(endAngle * Math.PI);\r\n\r\n    let m;\r\n    let angle;\r\n    let diffX;\r\n    let diffY;\r\n\r\n    if (x2 > x1) {\r\n      m = (y2 - y1) / (x2 - x1);\r\n      angle = Math.atan(m);\r\n    } else if (x2 === x1) {\r\n      angle = Math.PI / 2;\r\n    } else {\r\n      m = (y2 - y1) / (x2 - x1);\r\n      angle = Math.atan(m) - Math.PI;\r\n    }\r\n\r\n    const c = factor * radius;\r\n    diffX = Math.sin(angle) * c;\r\n    diffY = Math.cos(angle) * c;\r\n\r\n    const bx1 = x1 + diffX;\r\n    const by1 = y1 - diffY;\r\n\r\n    const bx2 = x2 + diffX;\r\n    const by2 = y2 - diffY;\r\n\r\n    ctx.moveTo(x1, y1);\r\n    ctx.bezierCurveTo(bx1, by1, bx2, by2, x2, y2);\r\n    ctx.stroke();\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport Stone from './Stone';\r\n\r\nexport default class GlassStoneBlack extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    const radGrad = canvasCtx.createRadialGradient(\r\n      -2 * stoneRadius / 5,\r\n      -2 * stoneRadius / 5,\r\n      1,\r\n      -stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      4 * stoneRadius / 5,\r\n    );\r\n    radGrad.addColorStop(0, '#666');\r\n    radGrad.addColorStop(1, '#000');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import Stone from './Stone';\r\nimport { CanvasBoardConfig } from '../types';\r\n\r\nexport default class GlassStoneWhite extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    const radGrad = canvasCtx.createRadialGradient(\r\n      -2 * stoneRadius / 5,\r\n      -2 * stoneRadius / 5,\r\n      stoneRadius / 3,\r\n      -stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      5 * stoneRadius / 5,\r\n    );\r\n\r\n    radGrad.addColorStop(0, '#fff');\r\n    radGrad.addColorStop(1, '#aaa');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport Stone from './Stone';\r\n\r\nexport default class PaintedStoneBlack extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    const radGrad = canvasCtx.createRadialGradient(\r\n      -2 * stoneRadius / 5,\r\n      -2 * stoneRadius / 5,\r\n      1 * stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      4 * stoneRadius / 5,\r\n    );\r\n    radGrad.addColorStop(0, '#111');\r\n    radGrad.addColorStop(1, '#000');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.lineWidth = stoneRadius / 6;\r\n\r\n    canvasCtx.strokeStyle = '#ccc';\r\n    canvasCtx.arc(-stoneRadius / 8, -stoneRadius / 8, stoneRadius / 2, Math.PI, 1.5 * Math.PI);\r\n\r\n    canvasCtx.stroke();\r\n  }\r\n}\r\n","import Stone from './Stone';\r\nimport { CanvasBoardConfig } from '../types';\r\n\r\nexport default class PaintedStoneWhite extends Stone {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneRadius = boardConfig.theme.stoneSize;\r\n    const radGrad = canvasCtx.createRadialGradient(\r\n      -2 * stoneRadius / 5,\r\n      -2 * stoneRadius / 5,\r\n      2 * stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      -stoneRadius / 5,\r\n      4 * stoneRadius / 5,\r\n    );\r\n    radGrad.addColorStop(0, '#fff');\r\n    radGrad.addColorStop(1, '#ddd');\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.fillStyle = radGrad;\r\n    canvasCtx.arc(0, 0, stoneRadius, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.lineWidth = stoneRadius / 6;\r\n\r\n    canvasCtx.strokeStyle = '#999';\r\n    canvasCtx.arc(stoneRadius / 8, stoneRadius / 8, stoneRadius / 2, 0, Math.PI / 2, false);\r\n\r\n    canvasCtx.stroke();\r\n  }\r\n}\r\n","// Black and white stone\r\nimport { CanvasBoardConfig } from '../types';\r\nimport DrawHandler from './DrawHandler';\r\n\r\nexport default class SimpleStone extends DrawHandler<{ color: string }> {\r\n  constructor (color: string) {\r\n    super({ color });\r\n  }\r\n\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig) {\r\n    const stoneSize = boardConfig.theme.stoneSize;\r\n    const lw = boardConfig.theme.markupLineWidth;\r\n\r\n    canvasCtx.fillStyle = this.params.color;\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.arc(0, 0, stoneSize - lw / 2, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    canvasCtx.lineWidth = lw;\r\n    canvasCtx.strokeStyle = 'black';\r\n    canvasCtx.stroke();\r\n  }\r\n}\r\n","/* global window */\r\nimport { CanvasBoardConfig } from '../types';\r\nimport { FieldObject } from '../../BoardBase';\r\nimport DrawHandler from './DrawHandler';\r\nimport Stone from './Stone';\r\n\r\n// Check if image has been loaded properly\r\n// see https://stereochro.me/ideas/detecting-broken-images-js\r\n/*function isOkay(img: any) {\r\n  if (typeof img === 'string') { return false; }\r\n  if (!img.complete) { return false; }\r\n  if (typeof img.naturalWidth !== 'undefined' && img.naturalWidth === 0) {\r\n    return false;\r\n  }\r\n  return true;\r\n}*/\r\n\r\nexport default class RealisticStone extends Stone {\r\n  paths: string[];\r\n  images: { [path: string]: HTMLImageElement };\r\n  fallback: DrawHandler;\r\n  randSeed: number;\r\n  redrawRequest: number;\r\n\r\n  constructor (paths: string[], fallback: DrawHandler) {\r\n    super();\r\n    this.fallback = fallback;\r\n    this.randSeed = Math.ceil(Math.random() * 9999999);\r\n    this.images = {};\r\n    this.paths = paths;\r\n  }\r\n\r\n  loadImage(path: string): Promise<HTMLImageElement> {\r\n    return new Promise((resolve, reject) => {\r\n      const image = new Image();\r\n      image.onload = () => {\r\n        resolve(image);\r\n      };\r\n      image.onerror = () => {\r\n        reject();\r\n      };\r\n      image.src = path;\r\n    });\r\n  }\r\n\r\n  stone (canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig, boardObject: FieldObject) {\r\n    const count = this.paths.length;\r\n\r\n    if (count) {\r\n      const stoneRadius = boardConfig.theme.stoneSize;\r\n      const idx = this.randSeed % (count + boardObject.x * boardConfig.size + boardObject.y) % count;\r\n\r\n      if (this.images[this.paths[idx]]) {\r\n        canvasCtx.drawImage(this.images[this.paths[idx]], -stoneRadius, -stoneRadius, 2 * stoneRadius, 2 * stoneRadius);\r\n      } else {\r\n        this.fallback.stone(canvasCtx, boardConfig, boardObject);\r\n\r\n        const path = this.paths[idx];\r\n        return this.loadImage(path).then((image) => {\r\n          this.images[path] = image;\r\n        }).catch(() => {\r\n          this.paths = this.paths.filter(p => p !== path);\r\n        });\r\n      }\r\n    } else {\r\n      this.fallback.stone(canvasCtx, boardConfig, boardObject);\r\n    }\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport DrawHandler from './DrawHandler';\r\nimport { Color } from '../../types';\r\nimport { BoardMarkupObject } from '../../boardBase';\r\n\r\ninterface MarkupDrawHandlerParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n  fillColor?: string;\r\n}\r\n\r\nexport default abstract class MarkupDrawHandler<P = {}> extends DrawHandler<MarkupDrawHandlerParams & P> {\r\n  grid(\r\n    canvasCtx: CanvasRenderingContext2D,\r\n    boardConfig: CanvasBoardConfig,\r\n    boardObject: BoardMarkupObject,\r\n  ) {\r\n    if (boardObject.variation === Color.E) {\r\n      canvasCtx.clearRect(\r\n        -boardConfig.theme.stoneSize,\r\n        -boardConfig.theme.stoneSize,\r\n        boardConfig.theme.stoneSize * 2,\r\n        boardConfig.theme.stoneSize * 2,\r\n      );\r\n    }\r\n  }\r\n\r\n  getColor(\r\n    boardConfig: CanvasBoardConfig,\r\n    boardObject: BoardMarkupObject,\r\n  ) {\r\n    if (this.params.color) {\r\n      return this.params.color;\r\n    }\r\n\r\n    if (boardObject.variation === Color.B) {\r\n      return boardConfig.theme.markupBlackColor;\r\n    }\r\n\r\n    if (boardObject.variation === Color.W) {\r\n      return boardConfig.theme.markupWhiteColor;\r\n    }\r\n\r\n    return boardConfig.theme.markupNoneColor;\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport { BoardMarkupObject } from '../../BoardBase';\r\nimport MarkupDrawHandler from './MarkupDrawHandler';\r\n\r\nexport default abstract class ShapeMarkup extends MarkupDrawHandler {\r\n  stone(\r\n    canvasCtx: CanvasRenderingContext2D,\r\n    boardConfig: CanvasBoardConfig,\r\n    boardObject: BoardMarkupObject,\r\n  ) {\r\n    canvasCtx.strokeStyle = this.getColor(boardConfig, boardObject);\r\n    canvasCtx.lineWidth = this.params.lineWidth || boardConfig.theme.markupLineWidth;\r\n    canvasCtx.shadowBlur = 10;\r\n    canvasCtx.shadowColor = canvasCtx.strokeStyle;\r\n\r\n    canvasCtx.beginPath();\r\n    this.drawShape(canvasCtx);\r\n    canvasCtx.stroke();\r\n\r\n    if (this.params.fillColor) {\r\n      canvasCtx.fillStyle = this.params.fillColor;\r\n      canvasCtx.fill();\r\n    }\r\n  }\r\n\r\n  abstract drawShape(canvasCtx: CanvasRenderingContext2D): void;\r\n}\r\n","import ShapeMarkup from './ShapeMarkup';\r\n\r\nexport default class Circle extends ShapeMarkup {\r\n  drawShape(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.arc(0, 0, 0.25, 0, 2 * Math.PI, true);\r\n  }\r\n}\r\n","import ShapeMarkup from './ShapeMarkup';\r\n\r\nexport default class Square extends ShapeMarkup {\r\n  drawShape(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.rect(-0.25, -0.25, 0.5, 0.5);\r\n  }\r\n}\r\n","import ShapeMarkup from './ShapeMarkup';\r\n\r\nexport default class Triangle extends ShapeMarkup {\r\n  drawShape(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.moveTo(0, -0.25);\r\n    canvasCtx.lineTo(-0.25, 0.166666);\r\n    canvasCtx.lineTo(0.25, 0.166666);\r\n    canvasCtx.closePath();\r\n  }\r\n}\r\n","import { CanvasBoardConfig } from '../types';\r\nimport { BoardLabelObject } from '../../BoardBase';\r\nimport MarkupDrawHandler from './MarkupDrawHandler';\r\n\r\ninterface LabelParams {\r\n  font?: string;\r\n}\r\n\r\nexport default class Label extends MarkupDrawHandler<LabelParams> {\r\n  stone(canvasCtx: CanvasRenderingContext2D, boardConfig: CanvasBoardConfig, boardObject: BoardLabelObject) {\r\n    const font = this.params.font || boardConfig.theme.font || '';\r\n\r\n    canvasCtx.fillStyle = this.getColor(boardConfig, boardObject);\r\n    canvasCtx.shadowBlur = 10;\r\n    canvasCtx.shadowColor = canvasCtx.fillStyle;\r\n\r\n    let fontSize = 0.5;\r\n\r\n    if (boardObject.text.length === 1) {\r\n      fontSize = 0.75;\r\n    } else if (boardObject.text.length === 2) {\r\n      fontSize = 0.6;\r\n    }\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.textBaseline = 'middle';\r\n    canvasCtx.textAlign = 'center';\r\n    canvasCtx.font = `${fontSize}px ${font}`;\r\n    canvasCtx.fillText(boardObject.text, 0, 0.02 + (fontSize - 0.5) * 0.08, 1);\r\n  }\r\n}\r\n","import DrawHandler from './DrawHandler';\r\n\r\n/**\r\n * TODO: rename this\r\n */\r\nexport default class Dot extends DrawHandler<{ color: string }> {\r\n  stone(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.fillStyle = this.params.color;\r\n    canvasCtx.shadowBlur = 10;\r\n    canvasCtx.shadowColor = canvasCtx.fillStyle;\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.arc(0, 0, 0.15, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import ShapeMarkup from './ShapeMarkup';\r\n\r\nexport default class XMark extends ShapeMarkup {\r\n  drawShape(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.moveTo(-0.20, -0.20);\r\n    canvasCtx.lineTo(0.20, 0.20);\r\n    canvasCtx.moveTo(0.20, -0.20);\r\n    canvasCtx.lineTo(-0.20, 0.20);\r\n  }\r\n}\r\n","import DrawHandler from './DrawHandler';\r\nimport { CanvasBoardConfig } from '../types';\r\nimport { BoardLineObject } from '../../boardBase';\r\n\r\ninterface LineParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n}\r\n\r\nexport default class Line extends DrawHandler<LineParams> {\r\n  stone(\r\n    canvasCtx: CanvasRenderingContext2D,\r\n    boardConfig: CanvasBoardConfig,\r\n    boardObject: BoardLineObject,\r\n  ) {\r\n    canvasCtx.strokeStyle = this.params.color ? this.params.color : boardConfig.theme.markupNoneColor;\r\n    canvasCtx.lineWidth = this.params.lineWidth || boardConfig.theme.markupLineWidth;\r\n    canvasCtx.shadowBlur = 10;\r\n    canvasCtx.shadowColor = canvasCtx.strokeStyle;\r\n\r\n    canvasCtx.beginPath();\r\n    canvasCtx.moveTo(boardObject.start.x, boardObject.start.y);\r\n    canvasCtx.lineTo(boardObject.end.x, boardObject.end.y);\r\n    canvasCtx.stroke();\r\n  }\r\n}\r\n","import DrawHandler from './DrawHandler';\r\nimport { CanvasBoardConfig } from '../types';\r\nimport { BoardLineObject } from '../../BoardBase';\r\n\r\ninterface ArrowParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n}\r\n\r\nexport default class Arrow extends DrawHandler<ArrowParams> {\r\n  stone(\r\n    canvasCtx: CanvasRenderingContext2D,\r\n    boardConfig: CanvasBoardConfig,\r\n    boardObject: BoardLineObject,\r\n  ) {\r\n    canvasCtx.strokeStyle = this.params.color ? this.params.color : boardConfig.theme.markupNoneColor;\r\n    canvasCtx.fillStyle = canvasCtx.strokeStyle;\r\n    canvasCtx.lineWidth = this.params.lineWidth || boardConfig.theme.markupLineWidth;\r\n    canvasCtx.shadowBlur = 10;\r\n    canvasCtx.shadowColor = canvasCtx.strokeStyle;\r\n\r\n    const x1 = boardObject.start.x;\r\n    const y1 = boardObject.start.y;\r\n    const x2 = boardObject.end.x;\r\n    const y2 = boardObject.end.y;\r\n\r\n    // length of the main line\r\n    const length = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\r\n\r\n    // line parametric functions\r\n    const getLineX = (t: number) => x1 + t * (x2 - x1);\r\n    const getLineY = (t: number) => y1 + t * (y2 - y1);\r\n\r\n    // triangle base line position on the main line\r\n    const triangleLen = 1 / length / 2.5;\r\n    const tx = getLineX(1 - triangleLen);\r\n    const ty = getLineY(1 - triangleLen);\r\n\r\n    // triangle base line parametric functions\r\n    const getBaseLineX = (t: number) => tx + t * (y2 - y1);\r\n    const getBaseLineY = (t: number) => ty + t * (x1 - x2);\r\n\r\n    // initial circle length\r\n    const circleLen = 0.1;\r\n\r\n    // draw initial circle\r\n    canvasCtx.beginPath();\r\n    canvasCtx.arc(x1, y1, circleLen, 0, 2 * Math.PI, true);\r\n    canvasCtx.fill();\r\n\r\n    // draw line\r\n    canvasCtx.beginPath();\r\n    canvasCtx.moveTo(getLineX(1 / length * circleLen), getLineY(1 / length * circleLen));\r\n    canvasCtx.lineTo(tx, ty);\r\n    canvasCtx.stroke();\r\n\r\n    // draw triangle at the end to make arrow\r\n    canvasCtx.beginPath();\r\n    canvasCtx.moveTo(getBaseLineX(- triangleLen / 1.75), getBaseLineY(- triangleLen / 1.75));\r\n    canvasCtx.lineTo(getBaseLineX(triangleLen / 1.75), getBaseLineY(triangleLen / 1.75));\r\n    canvasCtx.lineTo(x2, y2);\r\n    canvasCtx.closePath();\r\n    canvasCtx.fill();\r\n  }\r\n}\r\n","import DrawHandler from './DrawHandler';\r\n\r\nexport default class Dim extends DrawHandler<{ color: string }> {\r\n  stone(canvasCtx: CanvasRenderingContext2D) {\r\n    canvasCtx.fillStyle = this.params.color;\r\n    canvasCtx.fillRect(-0.5, -0.5, 1, 1);\r\n  }\r\n}\r\n","import { CanvasBoardTheme } from '../types';\r\nimport * as drawHandlers from '../drawHandlers';\r\nimport { defaultBoardBaseTheme } from '../../BoardBase/defaultConfig';\r\n\r\nconst baseTheme: CanvasBoardTheme = {\r\n  ...defaultBoardBaseTheme,\r\n  snapToGrid: false,\r\n  linesShift: -0.5,\r\n\r\n  drawHandlers: {\r\n    B: new drawHandlers.SimpleStone('#222'),\r\n    W: new drawHandlers.SimpleStone('#eee'),\r\n    CR: new drawHandlers.Circle(),\r\n    SQ: new drawHandlers.Square(),\r\n    LB: new drawHandlers.Label(),\r\n    TR: new drawHandlers.Triangle(),\r\n    MA: new drawHandlers.XMark({ lineWidth: 0.075 }),\r\n    SL: new drawHandlers.Dot({ color: 'rgba(32, 32, 192, 0.75)' }),\r\n    LN: new drawHandlers.Line(),\r\n    AR: new drawHandlers.Arrow(),\r\n    DD: new drawHandlers.Dim({ color: 'rgba(0, 0, 0, 0.5)' }),\r\n  },\r\n};\r\n\r\nexport default baseTheme;\r\n","import * as drawHandlers from '../drawHandlers';\r\nimport { CanvasBoardTheme } from '../types';\r\nimport baseTheme from './baseTheme';\r\n\r\nconst realisticTheme: CanvasBoardTheme = {\r\n  ...baseTheme,\r\n  font: 'calibri',\r\n  backgroundImage: 'images/wood1.jpg',\r\n  stoneSize: 0.48,\r\n  drawHandlers: {\r\n    ...baseTheme.drawHandlers,\r\n    B: new drawHandlers.RealisticStone([\r\n      'images/stones/black00_128.png',\r\n      'images/stones/black01_128.png',\r\n      'images/stones/black02_128.png',\r\n      'images/stones/black03_128.png',\r\n    ], new drawHandlers.GlassStoneBlack()),\r\n    W: new drawHandlers.RealisticStone([\r\n      'images/stones/white00_128.png',\r\n      'images/stones/white01_128.png',\r\n      'images/stones/white02_128.png',\r\n      'images/stones/white03_128.png',\r\n      'images/stones/white04_128.png',\r\n      'images/stones/white05_128.png',\r\n      'images/stones/white06_128.png',\r\n      'images/stones/white07_128.png',\r\n      'images/stones/white08_128.png',\r\n      'images/stones/white09_128.png',\r\n      'images/stones/white10_128.png',\r\n    ], new drawHandlers.GlassStoneWhite()),\r\n  },\r\n};\r\n\r\nexport default realisticTheme;\r\n","import * as drawHandlers from '../drawHandlers';\r\nimport { CanvasBoardTheme } from '../types';\r\nimport baseTheme from './baseTheme';\r\n\r\nconst modernTheme: CanvasBoardTheme = {\r\n  ...baseTheme,\r\n  font: 'calibri',\r\n  backgroundImage: '',\r\n\r\n  drawHandlers: {\r\n    ...baseTheme.drawHandlers,\r\n    B: new drawHandlers.ShellStoneBlack(),\r\n    W: new drawHandlers.ShellStoneWhite(),\r\n  },\r\n};\r\n\r\nexport default modernTheme;\r\n","// add here all themes, which should be publicly exposed\r\nimport realisticTheme from './realisticTheme';\r\nimport modernTheme from './modernTheme';\r\nimport baseTheme from './baseTheme';\r\n\r\nexport { baseTheme, realisticTheme, modernTheme };\r\n","/**\r\n * Contains implementation of go board.\r\n * @module CanvasBoard\r\n */\r\n\r\nimport ShadowLayer from './ShadowLayer';\r\nimport CanvasLayer from './CanvasLayer';\r\nimport { CanvasBoardConfig } from './types';\r\nimport makeConfig, { PartialRecursive } from '../utils/makeConfig';\r\nimport { Point } from '../types';\r\nimport { BoardObject, BoardBase, BoardViewport } from '../BoardBase';\r\nimport GridLayer from './GridLayer';\r\nimport { baseTheme } from './themes';\r\nimport { defaultBoardBaseConfig } from '../BoardBase/defaultConfig';\r\n\r\nconst canvasBoardDefaultConfig: CanvasBoardConfig = {\r\n  ...defaultBoardBaseConfig,\r\n  theme: baseTheme,\r\n};\r\n\r\nconst zIndexSorter = (obj1: BoardObject, obj2: BoardObject) => obj1.zIndex - obj2.zIndex;\r\n\r\nexport default class CanvasBoard extends BoardBase {\r\n  config: CanvasBoardConfig;\r\n  element: HTMLElement;\r\n  wrapperElement: HTMLElement;\r\n  boardElement: HTMLElement;\r\n  pixelRatio: number;\r\n  objects: BoardObject[] = [];\r\n  layers: {\r\n    grid: CanvasLayer;\r\n    shadow: CanvasLayer;\r\n    stone: CanvasLayer;\r\n    [key: string]: CanvasLayer;\r\n  };\r\n\r\n  // following props are computed in resize() method for performance\r\n  width: number;\r\n  height: number;\r\n  leftOffset: number;\r\n  topOffset: number;\r\n  fieldSize: number;\r\n  resizeCallback: (this: Window, ev: UIEvent) => any;\r\n  redrawScheduled: boolean;\r\n\r\n  /**\r\n\t * CanvasBoard class constructor - it creates a canvas board.\r\n\t */\r\n  constructor(elem: HTMLElement, config: PartialRecursive<CanvasBoardConfig> = {}) {\r\n    super(elem, makeConfig(canvasBoardDefaultConfig, config));\r\n\r\n    // init board HTML\r\n    this.wrapperElement = document.createElement('div');\r\n    this.wrapperElement.className = 'wgo-board';\r\n    this.wrapperElement.style.position = 'relative';\r\n    this.element.appendChild(this.wrapperElement);\r\n\r\n    this.boardElement = document.createElement('div');\r\n    this.boardElement.style.position = 'absolute';\r\n    this.boardElement.style.left = '0';\r\n    this.boardElement.style.top = '0';\r\n    this.boardElement.style.right = '0';\r\n    this.boardElement.style.bottom = '0';\r\n    this.boardElement.style.margin = 'auto';\r\n    this.wrapperElement.appendChild(this.boardElement);\r\n\r\n    this.layers = {\r\n      grid: new GridLayer(this),\r\n      shadow: new ShadowLayer(this),\r\n      stone: new CanvasLayer(this),\r\n    };\r\n\r\n    // set the pixel ratio for HDPI (e.g. Retina) screens\r\n    this.pixelRatio = window.devicePixelRatio || 1;\r\n\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n   * Updates dimensions and redraws everything\r\n   */\r\n  resize() {\r\n    const { marginSize } = this.config.theme;\r\n    const countX = this.config.size - this.config.viewport.left - this.config.viewport.right;\r\n    const countY = this.config.size - this.config.viewport.top - this.config.viewport.bottom;\r\n    const topOffset = marginSize + (this.config.coordinates && !this.config.viewport.top ? 0.5 : 0);\r\n    const rightOffset = marginSize + (this.config.coordinates && !this.config.viewport.right ? 0.5 : 0);\r\n    const bottomOffset = marginSize + (this.config.coordinates && !this.config.viewport.bottom ? 0.5 : 0);\r\n    const leftOffset = marginSize + (this.config.coordinates && !this.config.viewport.left ? 0.5 : 0);\r\n\r\n    if (this.config.width && this.config.height) {\r\n      // exact dimensions\r\n      this.width = this.config.width * this.pixelRatio;\r\n      this.height = this.config.height * this.pixelRatio;\r\n      this.fieldSize = Math.min(\r\n        this.width / (countX + leftOffset + rightOffset),\r\n        this.height / (countY + topOffset + bottomOffset),\r\n      );\r\n\r\n      if (this.resizeCallback) {\r\n        window.removeEventListener('resize', this.resizeCallback);\r\n      }\r\n    } else if (this.config.width) {\r\n      this.width = this.config.width * this.pixelRatio;\r\n      this.fieldSize = this.width / (countX + leftOffset + rightOffset);\r\n      this.height = this.fieldSize * (countY + topOffset + bottomOffset);\r\n\r\n      if (this.resizeCallback) {\r\n        window.removeEventListener('resize', this.resizeCallback);\r\n      }\r\n    } else if (this.config.height) {\r\n      this.height = this.config.height * this.pixelRatio;\r\n      this.fieldSize = this.height / (countY + topOffset + bottomOffset);\r\n      this.width = this.fieldSize * (countX + leftOffset + rightOffset);\r\n\r\n      if (this.resizeCallback) {\r\n        window.removeEventListener('resize', this.resizeCallback);\r\n      }\r\n    } else {\r\n      this.wrapperElement.style.width = 'auto';\r\n      this.width = this.wrapperElement.offsetWidth * this.pixelRatio;\r\n      this.fieldSize = this.width / (countX + leftOffset + rightOffset);\r\n      this.height = this.fieldSize * (countY + topOffset + bottomOffset);\r\n\r\n      if (!this.resizeCallback) {\r\n        this.resizeCallback = () => {\r\n          this.resize();\r\n        };\r\n        window.addEventListener('resize', this.resizeCallback);\r\n      }\r\n    }\r\n\r\n    if (this.config.theme.snapToGrid) {\r\n      this.fieldSize = Math.floor(this.fieldSize);\r\n    }\r\n\r\n    this.leftOffset = this.fieldSize * (leftOffset + 0.5 - this.config.viewport.left);\r\n    this.topOffset = this.fieldSize * (topOffset + 0.5 - this.config.viewport.top);\r\n\r\n    this.wrapperElement.style.width = `${(this.width / this.pixelRatio)}px`;\r\n    this.wrapperElement.style.height = `${(this.height / this.pixelRatio)}px`;\r\n\r\n    const boardWidth = (countX + leftOffset + rightOffset) * this.fieldSize;\r\n    const boardHeight = (countY + topOffset + bottomOffset) * this.fieldSize;\r\n\r\n    this.boardElement.style.width = `${(boardWidth / this.pixelRatio)}px`;\r\n    this.boardElement.style.height = `${(boardHeight / this.pixelRatio)}px`;\r\n\r\n    Object.keys(this.layers).forEach((layer) => {\r\n      this.layers[layer].resize(boardWidth, boardHeight);\r\n    });\r\n\r\n    this.redraw();\r\n  }\r\n\r\n  /**\r\n\t * Get absolute X coordinate\r\n\t *\r\n\t * @param {number} x relative coordinate\r\n\t */\r\n\r\n  getX(x: number) {\r\n    return this.leftOffset + x * this.fieldSize;\r\n  }\r\n\r\n  /**\r\n\t * Get absolute Y coordinate\r\n\t *\r\n\t * @param {number} y relative coordinate\r\n\t */\r\n\r\n  getY(y: number) {\r\n    return this.topOffset + y * this.fieldSize;\r\n  }\r\n\r\n  /**\r\n   * Redraw everything.\r\n   */\r\n  redraw() {\r\n    if (!this.redrawScheduled) {\r\n      this.redrawScheduled = true;\r\n\r\n      window.requestAnimationFrame(() => {\r\n        this.redrawScheduled = false;\r\n\r\n        // set correct background\r\n        this.boardElement.style.backgroundColor = this.config.theme.backgroundColor;\r\n\r\n        if (this.config.theme.backgroundImage) {\r\n          this.boardElement.style.backgroundImage = `url(\"${this.config.theme.backgroundImage}\")`;\r\n        }\r\n\r\n        // sort objects by zIndex\r\n        this.objects.sort(zIndexSorter);\r\n\r\n        // redraw all layers\r\n        Object.keys(this.layers).forEach((layer) => {\r\n          this.layers[layer].clear();\r\n\r\n          this.objects.forEach((object) => {\r\n            const handler = typeof object.type === 'string' ? this.config.theme.drawHandlers[object.type] : object.type;\r\n            if ((handler as any)[layer]) {\r\n              this.layers[layer].draw((handler as any)[layer].bind(handler), object);\r\n            }\r\n          });\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  addObject(boardObject: BoardObject | BoardObject[]) {\r\n    if (!Array.isArray(boardObject)) {\r\n      if (typeof boardObject.type === 'string') {\r\n        if (!this.config.theme.drawHandlers[boardObject.type]) {\r\n          // tslint:disable-next-line:max-line-length\r\n          throw new TypeError(`Board object type \"${boardObject.type}\" doesn't exist in \\`config.theme.drawHandlers\\`.`);\r\n        }\r\n      } else {\r\n        throw new TypeError('Invalid board object type. Custom canvas board objects not yet supported.');\r\n      }\r\n    }\r\n\r\n    super.addObject(boardObject);\r\n    this.redraw();\r\n  }\r\n\r\n  updateObject(boardObject: BoardObject | BoardObject[]) {\r\n    // just redraw everything\r\n    this.redraw();\r\n  }\r\n\r\n  removeObject(boardObject: BoardObject | BoardObject[]) {\r\n    super.removeObject(boardObject);\r\n    this.redraw();\r\n  }\r\n\r\n  removeAllObjects() {\r\n    super.removeAllObjects();\r\n    this.redraw();\r\n  }\r\n\r\n  on(type: string, callback: (event: UIEvent, point: Point) => void) {\r\n    super.on(type, callback);\r\n    this.registerBoardListener(type);\r\n  }\r\n\r\n  registerBoardListener(type: string) {\r\n    this.boardElement.addEventListener(type, (evt) => {\r\n      if ((evt as any).layerX != null) {\r\n        const pos = this.getRelativeCoordinates((evt as any).layerX, (evt as any).layerY);\r\n        this.emit(type, evt, pos);\r\n      } else {\r\n        this.emit(type, evt);\r\n      }\r\n    });\r\n  }\r\n\r\n  getRelativeCoordinates(absoluteX: number, absoluteY: number) {\r\n    // new hopefully better translation of coordinates\r\n\r\n    const x = Math.round((absoluteX * this.pixelRatio - this.leftOffset) / this.fieldSize);\r\n    const y = Math.round((absoluteY * this.pixelRatio - this.topOffset) / this.fieldSize);\r\n\r\n    if (x < 0 || x >= this.config.size || y < 0 || y >= this.config.size) {\r\n      return null;\r\n    }\r\n\r\n    return { x, y };\r\n  }\r\n\r\n  setSize(size: number) {\r\n    super.setSize(size);\r\n    this.resize();\r\n  }\r\n\r\n  setViewport(viewport: BoardViewport) {\r\n    super.setViewport(viewport);\r\n    this.resize();\r\n  }\r\n\r\n  setCoordinates(coordinates: boolean) {\r\n    super.setCoordinates(coordinates);\r\n    this.resize();\r\n  }\r\n}\r\n","/**\r\n * From SGF specification, there are these types of property values:\r\n *\r\n * CValueType = (ValueType | *Compose*)\r\n * ValueType  = (*None* | *Number* | *Real* | *Double* | *Color* | *SimpleText* | *Text* | *Point*  | *Move* | *Stone*)\r\n *\r\n * WGo's kifu node (KNode object) implements similar types with few exceptions:\r\n *\r\n * - Types `Number`, `Real` and `Double` are implemented by javascript's `number`.\r\n * - Types `SimpleText` and `Text` are considered as the same.\r\n * - Types `Point`, `Move` and `Stone` are all the same, implemented as simple object with `x` and `y` coordinates.\r\n * - Type `None` is implemented as `true`\r\n *\r\n * Each `Compose` type, which is used in SGF, has its own type.\r\n *\r\n * - `Point ':' Point` (used in AR property) has special type `Line` - object with two sets of coordinates.\r\n * - `Point ':' Simpletext` (used in LB property) has special type `Label` - object with coordinates and text property\r\n * - `Simpletext \":\" Simpletext` (used in AP property) - not implemented\r\n * - `Number \":\" SimpleText` (used in FG property) - not implemented\r\n *\r\n * Moreover each property value has these settings:\r\n *\r\n * - *Single value* / *Array* (more values)\r\n * - *Not empty* / *Empty* (value or array can be empty)\r\n *\r\n * {@link http://www.red-bean.com/sgf/sgf4.html}\r\n */\r\n\r\nimport { Color, Point, Label, Vector } from '../types';\r\n\r\ninterface PropertyValueTransformer<T = any> {\r\n  read(str: string): T;\r\n  write(value: T): string;\r\n}\r\n\r\nexport const NONE = {\r\n  read: (str: string) => true,\r\n  write: (value: boolean) => '',\r\n};\r\n\r\nexport const NUMBER = {\r\n  read: (str: string) => parseFloat(str),\r\n  write: (value: number) => value.toString(10),\r\n};\r\n\r\nexport const TEXT = {\r\n  read: (str: string) => str,\r\n  write: (value: string) => value,\r\n};\r\n\r\nexport const COLOR = {\r\n  read: (str: string) => (str === 'w' || str === 'W' ? Color.WHITE : Color.BLACK),\r\n  write: (value: Color) => (value === Color.WHITE ? 'W' : 'B'),\r\n};\r\n\r\nexport const POINT = {\r\n  read: (str: string): Point => str ? {\r\n    x: str.charCodeAt(0) - 97,\r\n    y: str.charCodeAt(1) - 97,\r\n  } : null,\r\n  write: (value?: Point) => value ? String.fromCharCode(value.x + 97) + String.fromCharCode(value.y + 97) : '',\r\n};\r\n\r\nexport const LABEL = {\r\n  read: (str: string): Label => ({\r\n    x: str.charCodeAt(0) - 97,\r\n    y: str.charCodeAt(1) - 97,\r\n    text: str.substr(3),\r\n  }),\r\n  write: (value: Label) => (\r\n    `${String.fromCharCode(value.x + 97) + String.fromCharCode(value.y + 97)}:${value.text}`\r\n  ),\r\n};\r\n\r\nexport const VECTOR = {\r\n  read: (str: string): Vector => str ? [\r\n    {\r\n      x: str.charCodeAt(0) - 97,\r\n      y: str.charCodeAt(1) - 97,\r\n    },\r\n    {\r\n      x: str.charCodeAt(3) - 97,\r\n      y: str.charCodeAt(4) - 97,\r\n    },\r\n  ] : null,\r\n  write: (value?: Vector) => (\r\n    // tslint:disable-next-line:max-line-length\r\n    value ? `${String.fromCharCode(value[0].x + 97) + String.fromCharCode(value[0].y + 97)}:${String.fromCharCode(value[1].x + 97) + String.fromCharCode(value[1].y + 97)}` : ''\r\n  ),\r\n};\r\n\r\n/// Property definitions --------------------------------------------------------------------------\r\n\r\ninterface PropertyValueDefinition<T> {\r\n  transformer: PropertyValueTransformer<T>;\r\n  multiple: boolean;\r\n  notEmpty: boolean;\r\n}\r\n\r\nconst propertyValueTypes: {[propIdent: string]: PropertyValueDefinition<any>} = {\r\n  _default: {\r\n    transformer: TEXT,\r\n    multiple: false,\r\n    notEmpty: true,\r\n  },\r\n};\r\n\r\n/// Move properties -------------------------------------------------------------------------------\r\n\r\npropertyValueTypes.B = propertyValueTypes.W = {\r\n  transformer: POINT,\r\n  multiple: false,\r\n  notEmpty: false,\r\n};\r\n\r\npropertyValueTypes.KO = {\r\n  transformer: NONE,\r\n  multiple: false,\r\n  notEmpty: false,\r\n};\r\n\r\npropertyValueTypes.MN = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Setup properties ------------------------------------------------------------------------------\r\n\r\npropertyValueTypes.AB = propertyValueTypes.AW = propertyValueTypes.AE = {\r\n  transformer: POINT,\r\n  multiple: true,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.PL = {\r\n  transformer: COLOR,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Node annotation properties --------------------------------------------------------------------\r\n\r\npropertyValueTypes.C = propertyValueTypes.N = {\r\n  transformer: TEXT,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n// tslint:disable-next-line:max-line-length\r\npropertyValueTypes.DM = propertyValueTypes.GB = propertyValueTypes.GW = propertyValueTypes.HO = propertyValueTypes.UC = propertyValueTypes.V = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Move annotation properties --------------------------------------------------------------------\r\n\r\npropertyValueTypes.BM = propertyValueTypes.TE = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.DO = propertyValueTypes.IT = {\r\n  transformer: NONE,\r\n  multiple: false,\r\n  notEmpty: false,\r\n};\r\n\r\n/// Markup properties -----------------------------------------------------------------------------\r\n\r\n// tslint:disable-next-line:max-line-length\r\npropertyValueTypes.CR = propertyValueTypes.MA = propertyValueTypes.SL = propertyValueTypes.SQ = propertyValueTypes.TR = {\r\n  transformer: POINT,\r\n  multiple: true,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.LB = {\r\n  transformer: LABEL,\r\n  multiple: true,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.AR = propertyValueTypes.LN = {\r\n  transformer: VECTOR,\r\n  multiple: true,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.DD = propertyValueTypes.TB = propertyValueTypes.TW = {\r\n  transformer: POINT,\r\n  multiple: true,\r\n  notEmpty: false,\r\n};\r\n\r\n/// Root properties -------------------------------------------------------------------------------\r\n\r\npropertyValueTypes.AP = propertyValueTypes.CA = {\r\n  transformer: TEXT,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n// note: rectangular board is not implemented (in SZ property)\r\npropertyValueTypes.FF = propertyValueTypes.GM = propertyValueTypes.ST = propertyValueTypes.SZ = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Game info properties --------------------------------------------------------------------------\r\n\r\npropertyValueTypes.AN = propertyValueTypes.BR = propertyValueTypes.BT =\r\npropertyValueTypes.CP = propertyValueTypes.DT = propertyValueTypes.EV =\r\npropertyValueTypes.GN = propertyValueTypes.GC = propertyValueTypes.GN =\r\npropertyValueTypes.ON = propertyValueTypes.OT = propertyValueTypes.PB =\r\npropertyValueTypes.PC = propertyValueTypes.PW = propertyValueTypes.RE =\r\npropertyValueTypes.RO = propertyValueTypes.RU = propertyValueTypes.SO =\r\npropertyValueTypes.US = propertyValueTypes.WR = propertyValueTypes.WT = {\r\n  transformer: TEXT,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\npropertyValueTypes.TM = propertyValueTypes.HA = propertyValueTypes.KM = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Timing properties -----------------------------------------------------------------------------\r\n\r\npropertyValueTypes.BL = propertyValueTypes.WL = propertyValueTypes.OB = propertyValueTypes.OW = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n/// Miscellaneous properties ----------------------------------------------------------------------\r\n\r\npropertyValueTypes.PM = {\r\n  transformer: NUMBER,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\n// VW property must be specified as compressed list (ab:cd) and only one value is allowed\r\n// empty value [] will reset the viewport. Other options are not supported.\r\npropertyValueTypes.VW = {\r\n  transformer: VECTOR,\r\n  multiple: false,\r\n  notEmpty: true,\r\n};\r\n\r\nexport default propertyValueTypes;\r\n","import SGFParser, { SGFSyntaxError } from '../SGFParser';\r\nimport propertyValueTypes from './propertyValueTypes';\r\nimport { SGFGameTree, SGFProperties } from '../SGFParser/sgfTypes';\r\n\r\nconst processJSGF = function (gameTree: SGFGameTree, rootNode: KifuNode) {\r\n  rootNode.setSGFProperties(gameTree.sequence[0] || {});\r\n\r\n  let lastNode = rootNode;\r\n\r\n  for (let i = 1; i < gameTree.sequence.length; i++) {\r\n    const node = new KifuNode();\r\n    node.setSGFProperties(gameTree.sequence[i]);\r\n    lastNode.appendChild(node);\r\n    lastNode = node;\r\n  }\r\n\r\n  for (let i = 0; i < gameTree.children.length; i++) {\r\n    lastNode.appendChild(processJSGF(gameTree.children[i], new KifuNode()));\r\n  }\r\n\r\n  return rootNode;\r\n};\r\n\r\n// Characters, which has to be escaped when transforming to SGF\r\nconst escapeCharacters = ['\\\\\\\\', '\\\\]'];\r\n\r\nconst escapeSGFValue = function (value: string) {\r\n  return escapeCharacters.reduce((prev, current) => prev.replace(new RegExp(current, 'g'), current), value);\r\n};\r\n\r\n/**\r\n * Contains path to certain node in game tree.\r\n */\r\nexport interface Path {\r\n  /** Depth of node (for root node it is 0) */\r\n  depth: number;\r\n  /** Array of children array indexes of all predecessors which have siblings. */\r\n  forks: number[];\r\n}\r\n\r\n/**\r\n * Class representing one kifu node.\r\n */\r\nexport default class KifuNode {\r\n  parent: KifuNode | null;\r\n  children: KifuNode[];\r\n  properties: {[key: string]: any};\r\n\r\n  constructor() {\r\n    this.parent = null;\r\n    this.children = [];\r\n    this.properties = {};\r\n  }\r\n\r\n  get root() {\r\n    // tslint:disable-next-line:no-this-assignment\r\n    let node: KifuNode = this;\r\n\r\n    while (node.parent != null) {\r\n      node = node.parent;\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  set innerSGF(sgf: string) {\r\n    // clean up\r\n    this.clean();\r\n\r\n    let transformedSgf = sgf;\r\n\r\n    // create regular SGF from sgf-like string\r\n    if (transformedSgf[0] !== '(') {\r\n      if (transformedSgf[0] !== ';') {\r\n        transformedSgf = `;${transformedSgf}`;\r\n      }\r\n      transformedSgf = `(${transformedSgf})`;\r\n    }\r\n\r\n    KifuNode.fromSGF(transformedSgf, 0, this);\r\n  }\r\n\r\n  /**\r\n   * Kifu node representation as sgf-like string - will contain `;`, all properties and all children.\r\n   */\r\n  get innerSGF(): string {\r\n    let output = ';';\r\n\r\n    for (const propIdent in this.properties) {\r\n      if (this.properties.hasOwnProperty(propIdent)) {\r\n        output += `${propIdent}[${this.getSGFProperty(propIdent).map(escapeSGFValue).join('][')}]`;\r\n      }\r\n    }\r\n\r\n    if (this.children.length === 1) {\r\n      return `${output}${this.children[0].innerSGF}`;\r\n    }\r\n    if (this.children.length > 1) {\r\n      return this.children.reduce((prev, current) => `${prev}(${current.innerSGF})`, output);\r\n    }\r\n\r\n    return output;\r\n  }\r\n\r\n  getPath() {\r\n    const path: Path = { depth: 0, forks: [] };\r\n    // tslint:disable-next-line:no-this-assignment\r\n    let node: KifuNode = this;\r\n\r\n    while (node.parent) {\r\n      path.depth++;\r\n      if (node.parent.children.length > 1) {\r\n        path.forks.unshift(node.parent.children.indexOf(node));\r\n      }\r\n      node = node.parent;\r\n    }\r\n\r\n    return path;\r\n  }\r\n\r\n  /// GENERAL TREE NODE MANIPULATION METHODS (subset of DOM API's Node)\r\n\r\n  /**\r\n   * Insert a KNode as the last child node of this node.\r\n   *\r\n   * @throws  {Error} when argument is invalid.\r\n   * @param   {KifuNode} node to append.\r\n   * @returns {number} position(index) of appended node.\r\n   */\r\n\r\n  appendChild(node: KifuNode): number {\r\n    if (node == null || !(node instanceof KifuNode) || node === this) {\r\n      throw new Error('Invalid argument passed to `appendChild` method, KNode was expected.');\r\n    }\r\n\r\n    if (node.parent) {\r\n      node.parent.removeChild(node);\r\n    }\r\n\r\n    node.parent = this;\r\n\r\n    return this.children.push(node) - 1;\r\n  }\r\n\r\n  /**\r\n   * Returns a Boolean value indicating whether a node is a descendant of a given node or not.\r\n   *\r\n   * @param   {KifuNode}   node to be tested\r\n   * @returns {boolean} true, if this node contains given node.\r\n   */\r\n\r\n  contains(node: KifuNode): boolean {\r\n    if (this.children.indexOf(node) >= 0) {\r\n      return true;\r\n    }\r\n\r\n    return this.children.some(child => child.contains(node));\r\n  }\r\n\r\n  /**\r\n   * Inserts the first KNode given in a parameter immediately before the second, child of this KNode.\r\n   *\r\n   * @throws  {Error}   when argument is invalid.\r\n   * @param   {KifuNode}   newNode       node to be inserted\r\n   * @param   {(KifuNode)} referenceNode reference node, if omitted, new node will be inserted at the end.\r\n   * @returns {KifuNode}   this node\r\n   */\r\n\r\n  insertBefore(newNode: KifuNode, referenceNode?: KifuNode): KifuNode {\r\n    if (newNode == null || !(newNode instanceof KifuNode) || newNode === this) {\r\n      throw new Error('Invalid argument passed to `insertBefore` method, KNode was expected.');\r\n    }\r\n    if (referenceNode == null) {\r\n      this.appendChild(newNode);\r\n      return this;\r\n    }\r\n\r\n    if (newNode.parent) {\r\n      newNode.parent.removeChild(newNode);\r\n    }\r\n\r\n    newNode.parent = this;\r\n\r\n    this.children.splice(this.children.indexOf(referenceNode), 0, newNode);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Removes a child node from the current element, which must be a child of the current node.\r\n   *\r\n   * @param   {KifuNode} child node to be removed\r\n   * @returns {KifuNode}  this node\r\n   */\r\n\r\n  removeChild(child: KifuNode): KifuNode {\r\n    this.children.splice(this.children.indexOf(child), 1);\r\n\r\n    child.parent = null;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Replaces one child Node of the current one with the second one given in parameter.\r\n   *\r\n   * @throws  {Error} when argument is invalid\r\n   * @param   {KifuNode} newChild node to be inserted\r\n   * @param   {KifuNode} oldChild node to be replaced\r\n   * @returns {KifuNode} this node\r\n   */\r\n\r\n  replaceChild(newChild: KifuNode, oldChild: KifuNode): KifuNode {\r\n    if (newChild == null || !(newChild instanceof KifuNode) || newChild === this) {\r\n      throw new Error('Invalid argument passed to `replaceChild` method, KNode was expected.');\r\n    }\r\n\r\n    this.insertBefore(newChild, oldChild);\r\n    this.removeChild(oldChild);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Remove all properties and children. Parent will remain.\r\n   */\r\n  clean() {\r\n    for (let i = this.children.length - 1; i >= 0; i--) {\r\n      this.removeChild(this.children[i]);\r\n    }\r\n    this.properties = {};\r\n  }\r\n\r\n  /// BASIC PROPERTY GETTER and SETTER\r\n\r\n  /**\r\n   * Gets property by SGF property identificator. Returns property value (type depends on property type)\r\n   *\r\n   * @param   {string}   propIdent - SGF property idetificator\r\n   * @returns {any}    property value or values or undefined, if property is missing.\r\n   */\r\n\r\n  getProperty(propIdent: string): any {\r\n    return this.properties[propIdent];\r\n  }\r\n\r\n  /**\r\n   * Sets property by SGF property identificator.\r\n   *\r\n   * @param   {string}  propIdent - SGF property idetificator\r\n   * @param   {any}     value - property value or values\r\n   */\r\n\r\n  setProperty(propIdent: string, value?: any) {\r\n    if (value === undefined) {\r\n      delete this.properties[propIdent];\r\n    } else {\r\n      this.properties[propIdent] = value;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Alias for `setProperty` without second parameter.\r\n   * @param propIdent\r\n   */\r\n  removeProperty(propIdent: string) {\r\n    this.setProperty(propIdent);\r\n  }\r\n\r\n  /**\r\n   * Iterates through all properties.\r\n   */\r\n  forEachProperty(callback: (propIdent: string, value: any) => void) {\r\n    Object.keys(this.properties).forEach((propIdent: string) => callback(propIdent, this.properties[propIdent]));\r\n  }\r\n\r\n  /// SGF RAW METHODS\r\n\r\n  /**\r\n   * Gets one SGF property value as string (with brackets `[` and `]`).\r\n   *\r\n   * @param   {string} propIdent SGF property identificator.\r\n   * @returns {string[]} Array of SGF property values or null if there is not such property.\r\n   */\r\n\r\n  getSGFProperty(propIdent: string): string[] {\r\n    if (this.properties[propIdent] !== undefined) {\r\n      const propertyValueType = propertyValueTypes[propIdent] || propertyValueTypes._default;\r\n\r\n      if (propertyValueType.multiple) {\r\n        return this.properties[propIdent].map(\r\n          (propValue: any) => propertyValueType.transformer.write(propValue),\r\n        );\r\n      }\r\n\r\n      return [propertyValueType.transformer.write(this.properties[propIdent])];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Sets one SGF property.\r\n   *\r\n   * @param   {string}   propIdent SGF property identificator\r\n   * @param   {string[]} propValues SGF property values\r\n   * @returns {KifuNode}    this KNode for chaining\r\n   */\r\n\r\n  setSGFProperty(propIdent: string, propValues?: string[]): KifuNode {\r\n    const propertyValueType = propertyValueTypes[propIdent] || propertyValueTypes._default;\r\n\r\n    if (propValues === undefined) {\r\n      delete this.properties[propIdent];\r\n      return this;\r\n    }\r\n\r\n    if (propertyValueType.multiple) {\r\n      this.properties[propIdent] = propValues.map(val => propertyValueType.transformer.read(val));\r\n    } else {\r\n      this.properties[propIdent] = propertyValueType.transformer.read(propValues[0]);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Sets multiple SGF properties.\r\n   *\r\n   * @param   {Object}   properties - map with signature propIdent -> propValues.\r\n   * @returns {KifuNode}    this KNode for chaining\r\n   */\r\n\r\n  setSGFProperties(properties: SGFProperties): KifuNode {\r\n    for (const ident in properties) {\r\n      if (properties.hasOwnProperty(ident)) {\r\n        this.setSGFProperty(ident, properties[ident as keyof SGFProperties]);\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Transforms KNode object to standard SGF string.\r\n   */\r\n  toSGF() {\r\n    return `(${this.innerSGF})`;\r\n  }\r\n\r\n  /**\r\n   * Deeply clones the node. If node isn't root, its predecessors won't be cloned, and the node becomes root.\r\n   */\r\n  cloneNode(appendToParent?: boolean) {\r\n    const node = new KifuNode();\r\n    const properties = JSON.parse(JSON.stringify(this.properties));\r\n    node.properties = properties;\r\n\r\n    this.children.forEach((child) => {\r\n      node.appendChild(child.cloneNode());\r\n    });\r\n\r\n    if (appendToParent && this.parent) {\r\n      this.parent.appendChild(node);\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * Creates KNode object from SGF transformed to JavaScript object.\r\n   *\r\n   * @param gameTree\r\n   */\r\n  static fromJS(gameTree: SGFGameTree, kifuNode = new KifuNode()) {\r\n    return processJSGF(gameTree, kifuNode);\r\n  }\r\n\r\n  /**\r\n   * Creates KNode object from SGF string.\r\n   *\r\n   * @param sgf\r\n   * @param gameNo\r\n   */\r\n  static fromSGF(sgf: string, gameNo: number = 0, kifuNode = new KifuNode()) {\r\n    const parser = new SGFParser(sgf);\r\n    return KifuNode.fromJS(parser.parseCollection()[gameNo], kifuNode);\r\n  }\r\n}\r\n","/**\r\n * WGo's game engine offers to set 3 rules:\r\n *\r\n * - *checkRepeat* - one of `repeat.KO`, `repeat.ALL`, `repeat.NONE` - defines if or when a move can be repeated.\r\n * - *allowRewrite* - if set true a move can rewrite existing move (for uncommon applications)\r\n * - *allowSuicide* - if set true a suicide will be allowed (and stone will be immediately captured)\r\n *\r\n * In this module there are some common preset rule sets (Japanese, Chinese etc...).\r\n * Extend object `gameRules` if you wish to add some rule set. Names of the rules should correspond with\r\n * SGF `RU` property.\r\n */\r\n\r\nexport enum Repeating {\r\n  KO = 'KO',\r\n  ALL = 'ALL',\r\n  NONE = 'NONE',\r\n}\r\n\r\nexport interface GoRules {\r\n  repeating: Repeating;\r\n  allowRewrite: boolean;\r\n  allowSuicide: boolean;\r\n  komi: number;\r\n}\r\n\r\nexport const JAPANESE_RULES: GoRules = {\r\n  repeating: Repeating.KO,\r\n  allowRewrite: false,\r\n  allowSuicide: false,\r\n  komi: 6.5,\r\n};\r\n\r\nexport const CHINESE_RULES: GoRules = {\r\n  repeating: Repeating.NONE,\r\n  allowRewrite: false,\r\n  allowSuicide: false,\r\n  komi: 7.5,\r\n};\r\n\r\nexport const ING_RULES: GoRules = {\r\n  repeating: Repeating.NONE,\r\n  allowRewrite: false,\r\n  allowSuicide: true,\r\n  komi: 7.5,\r\n};\r\n\r\nexport const NO_RULES: GoRules = {\r\n  repeating: Repeating.ALL,\r\n  allowRewrite: true,\r\n  allowSuicide: true,\r\n  komi: 0,\r\n};\r\n\r\nexport default {\r\n  Japanese: JAPANESE_RULES,\r\n  GOE: ING_RULES,\r\n  NZ: ING_RULES,\r\n  AGA: CHINESE_RULES,\r\n  Chinese: CHINESE_RULES,\r\n};\r\n","/**\r\n * Contains implementation of go position class.\r\n * @module Position\r\n */\r\n\r\nimport { Color, Field } from '../types';\r\n\r\n// creates 2-dim array\r\nfunction createGrid<T>(size: number) {\r\n  const grid: T[][] = [];\r\n  for (let i = 0; i < size; i++) {\r\n    grid.push([]);\r\n  }\r\n  return grid;\r\n}\r\n\r\n/**\r\n * Position class represents a state of the go game in one moment in time. It is composed from a grid containing black\r\n * and white stones, capture counts, and actual turn. It is designed to be mutable.\r\n */\r\nexport default class Position {\r\n  /**\r\n\t * Size of the board.\r\n\t * @constant\r\n\t */\r\n\r\n  size: number;\r\n\r\n  /**\r\n   * One dimensional array containing stones of the position.\r\n   */\r\n  grid: Color[] = [];\r\n\r\n  /**\r\n   * Contains numbers of stones that both players captured.\r\n   *\r\n   * @property {number} black - Count of white stones captured by **black**.\r\n   * @property {number} white - Count of black stones captured by **white**.\r\n   */\r\n\r\n  capCount = {\r\n    black: 0,\r\n    white: 0,\r\n  };\r\n\r\n  /**\r\n   * Who plays next move.\r\n   */\r\n\r\n  turn: Color.BLACK | Color.WHITE = Color.BLACK;\r\n\r\n  /**\r\n   * Creates instance of position object.\r\n   *\r\n   * @alias WGo.Position\r\n   * @class\r\n   *\r\n   * @param {number} [size = 19] - Size of the board.\r\n   */\r\n  constructor(size: number = 19) {\r\n    this.size = size;\r\n\r\n    // init grid\r\n    this.clear();\r\n  }\r\n\r\n  isOnPosition(x: number, y: number) {\r\n    return x >= 0 && y >= 0 && x < this.size && y < this.size;\r\n  }\r\n\r\n  /**\r\n   * Returns stone on the given field.\r\n   *\r\n   * @param {number} x - X coordinate\r\n   * @param {number} y - Y coordinate\r\n   * @return {Color} Color\r\n   */\r\n  get(x: number, y: number): Color {\r\n    if (!this.isOnPosition(x, y)) {\r\n      return undefined;\r\n    }\r\n\r\n    return this.grid[x * this.size + y];\r\n  }\r\n\r\n  /**\r\n   * Sets stone on the given field.\r\n   *\r\n   * @param {number} x - X coordinate\r\n   * @param {number} y - Y coordinate\r\n   * @param {Color} c - Color\r\n   */\r\n  set(x: number, y: number, c: Color) {\r\n    if (!this.isOnPosition(x, y)) {\r\n      throw new TypeError('Attempt to set field outside of position.');\r\n    }\r\n\r\n    this.grid[x * this.size + y] = c;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Clears the whole position (every value is set to EMPTY).\r\n   */\r\n  clear() {\r\n    for (let i = 0; i < this.size * this.size; i++) {\r\n      this.grid[i] = Color.EMPTY;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Clones the whole position.\r\n   *\r\n   * @return {WGo.Position} Copy of the position.\r\n   * @todo Clone turn as well.\r\n   */\r\n\r\n  clone(): Position {\r\n    const clone = new Position(this.size);\r\n    clone.grid = this.grid.slice(0);\r\n    clone.capCount.black = this.capCount.black;\r\n    clone.capCount.white = this.capCount.white;\r\n    clone.turn = this.turn;\r\n    return clone;\r\n  }\r\n\r\n  /**\r\n   * Compares this position with another position and return object with changes\r\n   *\r\n   * @param {WGo.Position} position - Position to compare to.\r\n   * @return {Field[]} Array of different fields\r\n   */\r\n\r\n  compare(position: Position): Field[] {\r\n    if (position.size !== this.size) {\r\n      throw new TypeError('Positions of different sizes cannot be compared.');\r\n    }\r\n\r\n    const diff: Field[] = [];\r\n\r\n    for (let i = 0; i < this.size * this.size; i++) {\r\n      if (this.grid[i] !== position.grid[i]) {\r\n        diff.push({\r\n          x: Math.floor(i / this.size),\r\n          y: i % this.size,\r\n          c: position.grid[i],\r\n        });\r\n      }\r\n    }\r\n\r\n    return diff;\r\n  }\r\n\r\n  /**\r\n   * Sets stone on given coordinates and capture adjacent stones without liberties if there are any.\r\n   * If move is invalid, false is returned.\r\n   */\r\n  applyMove(x: number, y: number, c: Color = this.turn, allowSuicide = false, allowRewrite = false) {\r\n    // check if move is on empty field of the board\r\n    if (!(allowRewrite || this.get(x, y) === Color.EMPTY)) {\r\n      return false;\r\n    }\r\n\r\n    // clone position and add a stone\r\n    const prevColor = this.get(x, y);\r\n    this.set(x, y, c);\r\n\r\n    // check capturing of all surrounding stones\r\n    const capturesAbove = this.get(x, y - 1) === -c && this.captureIfNoLiberties(x, y - 1);\r\n    const capturesRight = this.get(x + 1, y) === -c && this.captureIfNoLiberties(x + 1, y);\r\n    const capturesBelow = this.get(x, y + 1) === -c && this.captureIfNoLiberties(x, y + 1);\r\n    const capturesLeft = this.get(x - 1, y) === -c && this.captureIfNoLiberties(x - 1, y);\r\n    const hasCaptured = capturesAbove || capturesRight || capturesBelow || capturesLeft;\r\n\r\n    // check suicide\r\n    if (!hasCaptured) {\r\n      if (!this.hasLiberties(x, y)) {\r\n        if (allowSuicide) {\r\n          this.capture(x, y, c);\r\n        } else {\r\n          // revert position\r\n          this.set(x, y, prevColor);\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.turn = -c;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Validate position. Position is tested from 0:0 to size:size, if there are some moves,\r\n   * that should be captured, they will be removed. Returns a new Position object.\r\n   * This position isn't modified.\r\n   */\r\n\r\n  validatePosition() {\r\n    for (let x = 0; x < this.size; x++) {\r\n      for (let y = 0; y < this.size; y++) {\r\n        this.captureIfNoLiberties(x - 1, y);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Returns true if stone or group on the given coordinates has at least one liberty.\r\n   */\r\n  hasLiberties(x: number, y: number, alreadyTested = createGrid(this.size), c = this.get(x, y)): boolean {\r\n    // out of the board there aren't liberties\r\n    if (!this.isOnPosition(x, y)) {\r\n      return false;\r\n    }\r\n\r\n    // however empty field means liberty\r\n    if (this.get(x, y) === Color.EMPTY) {\r\n      return true;\r\n    }\r\n\r\n    // already tested field or stone of enemy isn't a liberty.\r\n    if (alreadyTested[x][y] || this.get(x, y) === -c) {\r\n      return false;\r\n    }\r\n\r\n    // set this field as tested\r\n    alreadyTested[x][y] = true;\r\n\r\n    // in this case we are checking our stone, if we get 4 false, it has no liberty\r\n    return (\r\n      this.hasLiberties(x, y - 1, alreadyTested, c) ||\r\n      this.hasLiberties(x, y + 1, alreadyTested, c) ||\r\n      this.hasLiberties(x - 1, y, alreadyTested, c) ||\r\n      this.hasLiberties(x + 1, y, alreadyTested, c)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if specified stone/group has zero liberties and if so it captures/removes stones from the position.\r\n   */\r\n  protected captureIfNoLiberties(x: number, y: number) {\r\n    // if it has zero liberties capture it\r\n    if (!this.hasLiberties(x, y)) {\r\n      // capture stones from game\r\n      this.capture(x, y);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Captures/removes stone on specified position and all adjacent and connected stones. This method ignores liberties.\r\n   */\r\n  capture(x: number, y: number, c: Color = this.get(x, y)) {\r\n    if (this.isOnPosition(x, y) && c !== Color.EMPTY && this.get(x, y) === c) {\r\n      this.set(x, y, Color.EMPTY);\r\n\r\n      if (c === Color.BLACK) {\r\n        this.capCount.white = this.capCount.white + 1;\r\n      } else {\r\n        this.capCount.black = this.capCount.black + 1;\r\n      }\r\n\r\n      this.capture(x, y - 1, c);\r\n      this.capture(x, y + 1, c);\r\n      this.capture(x - 1, y, c);\r\n      this.capture(x + 1, y, c);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * For debug purposes.\r\n   */\r\n  toString() {\r\n    const TL = '┌';\r\n    const TM = '┬';\r\n    const TR = '┐';\r\n    const ML = '├';\r\n    const MM = '┼';\r\n    const MR = '┤';\r\n    const BL = '└';\r\n    const BM = '┴';\r\n    const BR = '┘';\r\n    const BS = '●';\r\n    const WS = '○';\r\n    const HF = '─'; // horizontal fill\r\n\r\n    let output = '   ';\r\n\r\n    for (let i = 0; i < this.size; i++) {\r\n      output += i < 9 ? `${i} ` : i;\r\n    }\r\n\r\n    output += '\\n';\r\n\r\n    for (let y = 0; y < this.size; y++) {\r\n      for (let x = 0; x < this.size; x++) {\r\n        const color = this.grid[x * this.size + y];\r\n\r\n        if (x === 0) {\r\n          output += `${(y < 10 ? ` ${y}` : y)} `;\r\n        }\r\n\r\n        if (color !== Color.EMPTY) {\r\n          output += color === Color.BLACK ? BS : WS;\r\n        } else {\r\n          let char;\r\n\r\n          if (y === 0) {\r\n            // top line\r\n            if (x === 0) {\r\n              char = TL;\r\n            } else if (x < this.size - 1) {\r\n              char = TM;\r\n            } else {\r\n              char = TR;\r\n            }\r\n          } else if (y < this.size - 1) {\r\n            // middle line\r\n            if (x === 0) {\r\n              char = ML;\r\n            } else if (x < this.size - 1) {\r\n              char = MM;\r\n            } else {\r\n              char = MR;\r\n            }\r\n          } else {\r\n            // bottom line\r\n            if (x === 0) {\r\n              char = BL;\r\n            } else if (x < this.size - 1) {\r\n              char = BM;\r\n            } else {\r\n              char = BR;\r\n            }\r\n          }\r\n\r\n          output += char;\r\n        }\r\n\r\n        if (x === this.size - 1) {\r\n          if (y !== this.size - 1) {\r\n            output += '\\n';\r\n          }\r\n        } else {\r\n          output += HF;\r\n        }\r\n      }\r\n    }\r\n\r\n    return output;\r\n  }\r\n\r\n  /**\r\n   * Returns position grid as two dimensional array.\r\n   */\r\n  toTwoDimensionalArray() {\r\n    const arr: Color[][] = [];\r\n\r\n    for (let x = 0; x < this.size; x++) {\r\n      arr[x] = [];\r\n      for (let y = 0; y < this.size; y++) {\r\n        arr[x][y] = this.grid[x * this.size + y];\r\n      }\r\n    }\r\n\r\n    return arr;\r\n  }\r\n}\r\n\r\n// import { Color, Field, Move } from '../types';\r\n\r\n// /**\r\n//  * Position of the board (grid) is represented as 2 dimensional array of colors.\r\n//  */\r\n// export type Position = Color[][];\r\n\r\n// /**\r\n//  * Creates empty position (filled with Color.EMPTY) of specified size.\r\n//  * @param size\r\n//  */\r\n// export function createPosition(size: number) {\r\n//   const position: Color[][] = [];\r\n//   for (let i = 0; i < size; i++) {\r\n//     const row: Color[] = [];\r\n//     for (let j = 0; j < size; j++) {\r\n//       row.push(Color.EMPTY);\r\n//     }\r\n//     position.push(row);\r\n//   }\r\n//   return position;\r\n// }\r\n\r\n// /**\r\n//  * Deep clones a position.\r\n//  * @param position\r\n//  */\r\n// export function clonePosition(position: Position) {\r\n//   return position.map(row => row.slice(0));\r\n// }\r\n\r\n// /**\r\n//  * Compares position `pos1` with position `pos2` and returns all differences on `pos2`.\r\n//  * @param pos1\r\n//  * @param pos2\r\n//  */\r\n// export function comparePositions(pos1: Position, pos2: Position): Field[] {\r\n//   if (pos1.length !== pos2.length) {\r\n//     throw new TypeError('Positions of different sizes cannot be compared.');\r\n//   }\r\n\r\n//   const diff: Field[] = [];\r\n\r\n//   for (let x = 0; x < pos1.length; x++) {\r\n//     for (let y = 0; y < pos2.length; y++) {\r\n//       if (pos1[x][y] !== pos2[x][y]) {\r\n//         diff.push({ x, y, c: pos2[x][y] });\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   return diff;\r\n// }\r\n\r\n// function isOnBoard(position: Position, x: number, y: number) {\r\n//   return x >= 0 && x < position.length && y >= 0 && y < position.length;\r\n// }\r\n\r\n// /**\r\n//  * Creates new position with specified move (with rules applied - position won't contain captured stones).\r\n//  * If move is invalid, null is returned.\r\n//  */\r\n// export function applyMove(position: Position, x: number, y: number, c: Color.B | Color.W, allowSuicide = false) {\r\n//   // check if move is on empty field of the board\r\n//   if (!isOnBoard(position, x, y) || position[x][y] !== Color.EMPTY) {\r\n//     return null;\r\n//   }\r\n\r\n//   // clone position and add a stone\r\n//   const newPosition = clonePosition(position);\r\n//   newPosition[x][y] = c;\r\n\r\n//   // check capturing of all surrounding stones\r\n//   const capturesAbove = captureIfNoLiberties(newPosition, x, y - 1, -c);\r\n//   const capturesRight = captureIfNoLiberties(newPosition, x + 1, y, -c);\r\n//   const capturesBelow = captureIfNoLiberties(newPosition, x, y + 1, -c);\r\n//   const capturesLeft = captureIfNoLiberties(newPosition, x - 1, y, -c);\r\n//   const hasCaptured = capturesAbove || capturesRight || capturesBelow || capturesLeft;\r\n\r\n//   // check suicide\r\n//   if (!hasCaptured) {\r\n//     if (!hasLiberties(newPosition, x, y)) {\r\n//       if (allowSuicide) {\r\n//         capture(newPosition, x, y, c);\r\n//       } else {\r\n//         return null;\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   return newPosition;\r\n// }\r\n\r\n// /**\r\n//  * Validate position. Position is tested from 0:0 to size:size, if there are some moves,\r\n//  * that should be captured, they will be removed. Returns a new Position object.\r\n//  */\r\n\r\n// export function getValidatedPosition(position: Position) {\r\n//   const newPosition = clonePosition(position);\r\n\r\n//   for (let x = 0; x < position.length; x++) {\r\n//     for (let y = 0; y < position.length; y++) {\r\n//       captureIfNoLiberties(newPosition, x, y);\r\n//     }\r\n//   }\r\n\r\n//   return newPosition;\r\n// }\r\n\r\n// /**\r\n//  * Capture stone or group of stones if they are zero liberties. Mutates the given position.\r\n//  *\r\n//  * @param position\r\n//  * @param x\r\n//  * @param y\r\n//  * @param c\r\n//  */\r\n// function captureIfNoLiberties(position: Position, x: number, y: number, c: Color = position[x][y]) {\r\n//   let hasCaptured = false;\r\n\r\n//   // is there a stone possible to capture?\r\n//   if (isOnBoard(position, x, y) && c !== Color.EMPTY && position[x][y] === c) {\r\n//     // if it has zero liberties capture it\r\n//     if (!hasLiberties(position, x, y)) {\r\n//       // capture stones from game\r\n//       capture(position, x, y, c);\r\n//       hasCaptured = true;\r\n//     }\r\n//   }\r\n\r\n//   return hasCaptured;\r\n// }\r\n\r\n// function createTestGrid(size: number) {\r\n//   const grid: boolean[][] = [];\r\n//   for (let i = 0; i < size; i++) {\r\n//     grid.push([]);\r\n//   }\r\n//   return grid;\r\n// }\r\n\r\n// /**\r\n//  * Returns true if stone or group on the given position has at least one liberty.\r\n//  */\r\n// function hasLiberties(\r\n//   position: Position,\r\n//   x: number,\r\n//   y: number,\r\n//   alreadyTested = createTestGrid(position.length),\r\n//   c = position[x][y],\r\n// ): boolean {\r\n//   // out of the board there aren't liberties\r\n//   if (!isOnBoard(position, x, y)) {\r\n//     return false;\r\n//   }\r\n\r\n//   // however empty field means liberty\r\n//   if (position[x][y] === Color.EMPTY) {\r\n//     return true;\r\n//   }\r\n\r\n//   // already tested field or stone of enemy isn't a liberty.\r\n//   if (alreadyTested[x][y] || position[x][y] === -c) {\r\n//     return false;\r\n//   }\r\n\r\n//   // set this field as tested\r\n//   alreadyTested[x][y] = true;\r\n\r\n//   // in this case we are checking our stone, if we get 4 false, it has no liberty\r\n//   return (\r\n//     hasLiberties(position, x, y - 1, alreadyTested, c) ||\r\n//     hasLiberties(position, x, y + 1, alreadyTested, c) ||\r\n//     hasLiberties(position, x - 1, y, alreadyTested, c) ||\r\n//     hasLiberties(position, x + 1, y, alreadyTested, c)\r\n//   );\r\n// }\r\n\r\n// /**\r\n//  * Captures/removes stone on specified position and all adjacent and connected stones. This method ignores liberties.\r\n//  * Mutates the given position.\r\n//  */\r\n// function capture(position: Position, x: number, y: number, c: Color = position[x][y]) {\r\n//   if (isOnBoard(position, x, y) && position[x][y] !== Color.EMPTY && position[x][y] === c) {\r\n//     position[x][y] = Color.EMPTY;\r\n\r\n//     capture(position, x, y - 1, c);\r\n//     capture(position, x, y + 1, c);\r\n//     capture(position, x - 1, y, c);\r\n//     capture(position, x + 1, y, c);\r\n//   }\r\n// }\r\n\r\n// /**\r\n//  * For debug purposes.\r\n//  */\r\n// export function stringifyPosition(position: Position) {\r\n//   const TL = '┌';\r\n//   const TM = '┬';\r\n//   const TR = '┐';\r\n//   const ML = '├';\r\n//   const MM = '┼';\r\n//   const MR = '┤';\r\n//   const BL = '└';\r\n//   const BM = '┴';\r\n//   const BR = '┘';\r\n//   const BS = '●';\r\n//   const WS = '○';\r\n//   const HF = '─'; // horizontal fill\r\n\r\n//   let output = '   ';\r\n\r\n//   for (let i = 0; i < position.length; i++) {\r\n//     output += i < 9 ? `${i} ` : i;\r\n//   }\r\n\r\n//   output += '\\n';\r\n\r\n//   for (let y = 0; y < position.length; y++) {\r\n//     for (let x = 0; x < position.length; x++) {\r\n//       const color = position[x][y];\r\n\r\n//       if (x === 0) {\r\n//         output += `${(y < 10 ? ` ${y}` : y)} `;\r\n//       }\r\n\r\n//       if (color !== Color.EMPTY) {\r\n//         output += color === Color.BLACK ? BS : WS;\r\n//       } else {\r\n//         let char;\r\n\r\n//         if (y === 0) {\r\n//           // top line\r\n//           if (x === 0) {\r\n//             char = TL;\r\n//           } else if (x < position.length - 1) {\r\n//             char = TM;\r\n//           } else {\r\n//             char = TR;\r\n//           }\r\n//         } else if (y < position.length - 1) {\r\n//           // middle line\r\n//           if (x === 0) {\r\n//             char = ML;\r\n//           } else if (x < position.length - 1) {\r\n//             char = MM;\r\n//           } else {\r\n//             char = MR;\r\n//           }\r\n//         } else {\r\n//           // bottom line\r\n//           if (x === 0) {\r\n//             char = BL;\r\n//           } else if (x < position.length - 1) {\r\n//             char = BM;\r\n//           } else {\r\n//             char = BR;\r\n//           }\r\n//         }\r\n\r\n//         output += char;\r\n//       }\r\n\r\n//       if (x === position.length - 1) {\r\n//         if (y !== position.length - 1) {\r\n//           output += '\\n';\r\n//         }\r\n//       } else {\r\n//         output += HF;\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   return output;\r\n// }\r\n","import { GoRules, JAPANESE_RULES, Repeating } from './rules';\r\nimport Position from './Position';\r\nimport { Color } from '../types';\r\n\r\nexport default class Game {\r\n  size: number;\r\n  rules: GoRules;\r\n  komi: number;\r\n  positionStack: Position[];\r\n\r\n  /**\r\n   * Creates instance of game class.\r\n   *\r\n   * @class\r\n   * This class implements game logic. It basically analyses given moves and returns capture stones.\r\n   * WGo.Game also stores every position from beginning, so it has ability to check repeating positions\r\n   * and it can effectively restore old positions.\r\n   *\r\n   *\r\n   * @param {number} [size = 19] Size of the board\r\n   * @param {string} [checkRepeat = KO] How to handle repeated position:\r\n   *\r\n   * * KO - ko is properly handled - position cannot be same like previous position\r\n   * * ALL - position cannot be same like any previous position - e.g. it forbids triple ko\r\n   * * NONE - position can be repeated\r\n   *\r\n   * @param {boolean} [allowRewrite = false] Allow to play moves, which were already played\r\n   * @param {boolean} [allowSuicide = false] Allow to play suicides, stones are immediately captured\r\n   */\r\n\r\n  constructor(size: number = 19, rules: GoRules = JAPANESE_RULES) {\r\n    this.size = size;\r\n    this.rules = rules;\r\n    this.komi = rules.komi;\r\n    this.positionStack = [new Position(size)];\r\n  }\r\n\r\n  get position() {\r\n    return this.positionStack[this.positionStack.length - 1];\r\n  }\r\n\r\n  set position(pos) {\r\n    this.positionStack[this.positionStack.length - 1] = pos;\r\n  }\r\n\r\n  get turn() {\r\n    return this.position.turn;\r\n  }\r\n\r\n  set turn(color: Color.WHITE | Color.BLACK) {\r\n    this.position.turn = color;\r\n  }\r\n\r\n  get capCount() {\r\n    return this.position.capCount;\r\n  }\r\n\r\n  /**\r\n   * Play move. You can specify color.\r\n   */\r\n  play(x: number, y: number) {\r\n    const nextPosition = this.tryToPlay(x, y);\r\n\r\n    if (nextPosition) {\r\n      this.pushPosition(nextPosition);\r\n    }\r\n\r\n    return nextPosition;\r\n  }\r\n\r\n  /**\r\n   * Tries to play on given coordinates, returns new position after the play, or error code.\r\n   */\r\n  protected tryToPlay(x: number, y: number) {\r\n    const nextPosition = this.position.clone();\r\n    const success = nextPosition.applyMove(x, y, nextPosition.turn, this.rules.allowSuicide, this.rules.allowRewrite);\r\n\r\n    if (success && !this.hasPositionRepeated(nextPosition)) {\r\n      return nextPosition;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {Position} position to check\r\n   * @return {boolean} Returns true if the position didn't occurred in the past (according to the rule set)\r\n   */\r\n  hasPositionRepeated(position: Position): boolean {\r\n    let depth: number;\r\n\r\n    if (this.rules.repeating === Repeating.KO && this.positionStack.length - 2 >= 0) {\r\n      depth = this.positionStack.length - 2;\r\n    } else if (this.rules.repeating === Repeating.NONE) {\r\n      depth = 0;\r\n    } else {\r\n      return false;\r\n    }\r\n\r\n    for (let i = this.positionStack.length - 1; i >= depth; i--) {\r\n      if (this.positionStack[i].compare(position).length === 0) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Play pass.\r\n   *\r\n   * @param {(BLACK|WHITE)} c color\r\n   */\r\n\r\n  pass(c: Color.BLACK | Color.WHITE = this.turn) {\r\n    const nextPosition = this.position.clone();\r\n    nextPosition.turn = -(c || this.turn);\r\n    this.pushPosition(nextPosition);\r\n  }\r\n\r\n  /**\r\n   * Finds out validity of the move.\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @return {boolean} true if move can be played.\r\n   */\r\n\r\n  isValid(x: number, y: number): boolean {\r\n    return !!this.tryToPlay(x, y);\r\n  }\r\n\r\n  /**\r\n   * Controls position of the move.\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @return {boolean} true if move is on board.\r\n   */\r\n\r\n  isOnBoard(x: number, y: number): boolean {\r\n    return this.position.isOnPosition(x, y);\r\n  }\r\n\r\n  /**\r\n   * Inserts move into current position. Use for setting position, for example in handicap game. Field must be empty.\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @param {Color} c color\r\n   * @return {boolean} true if operation is successful.\r\n   */\r\n\r\n  addStone(x: number, y: number, c: Color.BLACK | Color.WHITE): boolean {\r\n    if (this.isOnBoard(x, y) && this.position.get(x, y) === Color.EMPTY) {\r\n      this.position.set(x, y, c);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Removes move from current position.\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @return {boolean} true if operation is successful.\r\n   */\r\n\r\n  removeStone(x: number, y: number): boolean {\r\n    if (this.isOnBoard(x, y) && this.position.get(x, y) !== Color.EMPTY) {\r\n      this.position.set(x, y, Color.EMPTY);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Set or insert move of current position.\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @param {(BLACK|WHITE)} [c] color\r\n   * @return {boolean} true if operation is successful.\r\n   */\r\n\r\n  setStone(x: number, y: number, c: Color): boolean {\r\n    if (this.isOnBoard(x, y)) {\r\n      this.position.set(x, y, c);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Get stone on given position.s\r\n   *\r\n   * @param {number} x coordinate\r\n   * @param {number} y coordinate\r\n   * @return {(Color|null)} color\r\n   */\r\n\r\n  getStone(x: any, y: any): (Color | null) {\r\n    return this.position.get(x, y);\r\n  }\r\n\r\n  /**\r\n   * Add position to stack. If position isn't specified current position is cloned and stacked.\r\n   * Pointer of actual position is moved to the new position.\r\n   *\r\n   * @param {WGo.Position} tmp position (optional)\r\n   */\r\n\r\n  pushPosition(pos: Position) {\r\n    return this.positionStack.push(pos);\r\n  }\r\n\r\n  /**\r\n   * Remove current position from stack. Pointer of actual position is moved to the previous position.\r\n   */\r\n\r\n  popPosition() {\r\n    if (this.positionStack.length > 1) {\r\n      return this.positionStack.pop();\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Removes all positions except the initial.\r\n   */\r\n\r\n  clear() {\r\n    this.positionStack = [this.positionStack[0]];\r\n  }\r\n}\r\n","export enum PropIdent {\r\n  // Move Properties\r\n  BLACK_MOVE = 'B',\r\n  EXECUTE_ILLEGAL = 'KO',\r\n  MOVE_NUMBER = 'MN',\r\n  WHITE_MOVE = 'W',\r\n\r\n  // Setup Properties\r\n  ADD_BLACK = 'AB',\r\n  CLEAR_FIELD = 'AE',\r\n  ADD_WHITE = 'AW',\r\n  SET_TURN = 'PL',\r\n\r\n  // Node Annotation Properties\r\n  COMMENT = 'C',\r\n  EVEN_POSITION = 'DM',\r\n  GOOD_FOR_BLACK = 'GB',\r\n  GOOD_FOR_WHITE = 'GW',\r\n  HOTSPOT = 'HO',\r\n  NODE_NAME = 'N',\r\n  UNCLEAR_POSITION = 'UC',\r\n  NODE_VALUE = 'V',\r\n\r\n  // Move Annotation Properties\r\n  BAD_MOVE = 'BM',\r\n  DOUBTFUL_MOVE = 'DM',\r\n  INTERESTING_MOVE = 'IT',\r\n  GOOD_MOVE = 'TE',\r\n\r\n  // Markup Properties\r\n  ARROW = 'AR',\r\n  CIRCLE = 'CR',\r\n  DIM = 'DD',\r\n  LABEL = 'LB',\r\n  LINE = 'LN',\r\n  X_MARK = 'MA',\r\n  SELECTED = 'SL',\r\n  SQUARE = 'SQ',\r\n  TRIANGLE = 'TR',\r\n\r\n  // Root Properties\r\n  APPLICATION = 'AP',\r\n  CHARSET = 'CA',\r\n  SGF_VERSION = 'FF',\r\n  GAME_TYPE = 'GM',\r\n  VARIATIONS_STYLE = 'ST',\r\n  BOARD_SIZE = 'SZ',\r\n\r\n  // Game Info Properties\r\n  ANNOTATOR = 'AN',\r\n  BLACK_RANK = 'BR',\r\n  BLACK_TEAM = 'BT',\r\n  COPYRIGHT = 'CP',\r\n  DATE = 'DT',\r\n  EVENT = 'EV',\r\n  GAME_NAME = 'GN',\r\n  GAME_COMMENT = 'GC',\r\n  OPENING_INFO = 'ON',\r\n  OVER_TIME = 'OT',\r\n  BLACK_NAME = 'BN',\r\n  PLACE = 'PC',\r\n  WHITE_NAME = 'PW',\r\n  RESULT = 'RE',\r\n  ROUND = 'RO',\r\n  RULES = 'RU',\r\n  SOURCE = 'SO',\r\n  TIME_LIMITS = 'TM',\r\n  AUTHOR = 'US',\r\n  WHITE_RANK = 'WR',\r\n  WHITE_TEAM = 'WT',\r\n\r\n  // Timing Properties\r\n  BLACK_TIME_LEFT = 'BL',\r\n  BLACK_STONES_LEFT = 'OB',\r\n  WHITE_STONES_LEFT = 'OW',\r\n  WHITE_TIME_LEFT = 'WL',\r\n\r\n  // Miscellaneous Properties\r\n  FIGURE = 'FG',\r\n  PRINT_MOVE_NUMBERS = 'PM',\r\n  BOARD_SECTION = 'VW',\r\n  HANDICAP = 'HA',\r\n\r\n  // GO specific Properties\r\n  KOMI = 'KM',\r\n  BLACK_TERRITORY = 'TB',\r\n  WHITE_TERRITORY = 'TW',\r\n}\r\n\r\nexport type SGFProperties = {\r\n  [key in PropIdent]?: string[];\r\n};\r\n\r\nexport type SGFNode = SGFProperties;\r\n\r\nexport interface SGFGameTree {\r\n  sequence: SGFNode[];\r\n  children: SGFGameTree[];\r\n}\r\n\r\nexport type SGFCollection = SGFGameTree[];\r\n","import { LifeCycleEvent } from './types';\r\nimport { PropIdent } from '../SGFParser/sgfTypes';\r\nimport { Color, Point } from '../types';\r\nimport { goRules } from '../Game';\r\n\r\nexport function beforeInitSZ(event: LifeCycleEvent<number>) {\r\n  event.target.params.size = event.value;\r\n}\r\n\r\nexport function beforeInitRU(event: LifeCycleEvent<string>) {\r\n  if ((goRules as any)[event.value]) {\r\n    event.target.params.rules = (goRules as any)[event.value];\r\n  }\r\n}\r\n\r\nexport function applyGameChangesHA(event: LifeCycleEvent<number>) {\r\n  if (\r\n    event.value > 1 &&\r\n    event.target.currentNode === event.target.rootNode &&\r\n    !event.target.getProperty(PropIdent.SET_TURN)\r\n  ) {\r\n    event.target.game.position.turn = Color.WHITE;\r\n  }\r\n}\r\n\r\nexport function applyGameChangesMove(event: LifeCycleEvent<Point>) {\r\n  const color = event.propIdent === 'B' ? Color.B : Color.W;\r\n\r\n  // if this is false, move is pass\r\n  if (event.value) {\r\n    event.target.game.position.applyMove(event.value.x, event.value.y, color, true, true);\r\n  }\r\n\r\n  event.target.game.position.turn = -color;\r\n}\r\n\r\nexport function applyGameChangesPL(event: LifeCycleEvent<Color.BLACK | Color.WHITE>) {\r\n  event.target.game.turn = event.value;\r\n}\r\n\r\nexport function applyGameChangesSetup(event: LifeCycleEvent<Point[]>) {\r\n  let color: Color;\r\n  switch (event.propIdent) {\r\n    case 'AB': color = Color.B; break;\r\n    case 'AW': color = Color.W; break;\r\n    case 'AE': color = Color.E; break;\r\n  }\r\n\r\n  event.value.forEach((value) => {\r\n    // add stone\r\n    event.target.game.setStone(value.x, value.y, color);\r\n  });\r\n}\r\n","import KifuNode, { Path } from '../kifu/KifuNode';\r\nimport EventEmitter from '../utils/EventEmitter';\r\nimport { Game, goRules, GoRules, JAPANESE_RULES } from '../Game';\r\nimport { PropIdent } from '../SGFParser/sgfTypes';\r\nimport PropertyHandler from './PropertyHandler';\r\nimport { PlayerInitParams } from './types';\r\nimport * as basePropertyListeners from './basePropertyListeners';\r\nimport { Color } from '../types';\r\nimport PlayerPlugin from './PlayerPlugin';\r\n\r\nexport default class PlayerBase extends EventEmitter {\r\n  rootNode: KifuNode;\r\n  currentNode: KifuNode;\r\n  game: Game;\r\n  params: PlayerInitParams;\r\n  plugins: PlayerPlugin[];\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.loadKifu(new KifuNode());\r\n    this.plugins = [];\r\n\r\n    this.on('beforeInit.SZ', basePropertyListeners.beforeInitSZ);\r\n    this.on('beforeInit.RU', basePropertyListeners.beforeInitRU);\r\n    this.on('applyGameChanges.HA', basePropertyListeners.applyGameChangesHA);\r\n    this.on('applyGameChanges.B', basePropertyListeners.applyGameChangesMove);\r\n    this.on('applyGameChanges.W', basePropertyListeners.applyGameChangesMove);\r\n    this.on('applyGameChanges.PL', basePropertyListeners.applyGameChangesPL);\r\n    this.on('applyGameChanges.AB', basePropertyListeners.applyGameChangesSetup);\r\n    this.on('applyGameChanges.AW', basePropertyListeners.applyGameChangesSetup);\r\n    this.on('applyGameChanges.AE', basePropertyListeners.applyGameChangesSetup);\r\n  }\r\n\r\n  /**\r\n   * Load game (kifu) from KifuNode.\r\n   */\r\n  loadKifu(rootNode: KifuNode) {\r\n    this.rootNode = rootNode;\r\n    this.currentNode = rootNode;\r\n\r\n    this.emit('loadKifu', {\r\n      name: 'loadKifu',\r\n      kifuNode: rootNode,\r\n      target: this,\r\n    });\r\n    this.executeRoot();\r\n  }\r\n\r\n  /**\r\n   * Create new game (kifu) and init player with it.\r\n   */\r\n  newGame(size?: number, rules?: GoRules) {\r\n    const rootNode = new KifuNode();\r\n\r\n    if (size) {\r\n      rootNode.setProperty('SZ', size);\r\n    }\r\n\r\n    if (rules) {\r\n      // TODO: handle rules more correctly\r\n      const rulesName = Object.keys(goRules).find(name => (goRules as any)[name] === rules);\r\n      if (rulesName) {\r\n        rootNode.setProperty('RU', rulesName);\r\n      }\r\n    }\r\n\r\n    this.loadKifu(rootNode);\r\n  }\r\n\r\n  /**\r\n   * Executes root properties during initialization. If some properties change, call this to re-init player.\r\n   */\r\n  protected executeRoot() {\r\n    this.params = {\r\n      size: 19,\r\n      rules: JAPANESE_RULES,\r\n    };\r\n\r\n    this.emitNodeLifeCycleEvent('beforeInit');\r\n    this.game = new Game(this.params.size, this.params.rules);\r\n\r\n    this.executeNode();\r\n  }\r\n\r\n  protected executeNode() {\r\n    this.emitNodeLifeCycleEvent('applyGameChanges');\r\n    this.emitNodeLifeCycleEvent('applyNodeChanges');\r\n  }\r\n\r\n  /**\r\n   * Change current node to specified next node and executes its properties.\r\n   */\r\n  protected executeNext(i: number) {\r\n    this.emitNodeLifeCycleEvent('clearNodeChanges');\r\n\r\n    this.game.pushPosition(this.game.position.clone());\r\n    this.currentNode = this.currentNode.children[i];\r\n\r\n    this.executeNode();\r\n  }\r\n\r\n  /**\r\n   * Change current node to previous/parent next node and executes its properties.\r\n   */\r\n  protected executePrevious() {\r\n    this.emitNodeLifeCycleEvent('clearNodeChanges');\r\n    this.emitNodeLifeCycleEvent('clearGameChanges');\r\n\r\n    this.game.popPosition();\r\n    this.currentNode = this.currentNode.parent;\r\n\r\n    this.emitNodeLifeCycleEvent('applyNodeChanges');\r\n  }\r\n\r\n  /**\r\n   * Emits node life cycle method (for every property)\r\n   */\r\n  protected emitNodeLifeCycleEvent(name: keyof PropertyHandler<any, any>) {\r\n    this.emit(name, {\r\n      name,\r\n      target: this,\r\n    });\r\n\r\n    this.currentNode.forEachProperty((propIdent, value) => {\r\n      this.emit(`${name}.${propIdent}`, {\r\n        name,\r\n        target: this,\r\n        propIdent,\r\n        value,\r\n      });\r\n    });\r\n  }\r\n\r\n  protected getPropertyHandler(propIdent: string) {\r\n    return (this.constructor as any).propertyHandlers[propIdent] as PropertyHandler<any, any>;\r\n  }\r\n\r\n  /**\r\n   * Gets property of current node.\r\n   */\r\n  getProperty(propIdent: PropIdent) {\r\n    return this.currentNode.getProperty(propIdent);\r\n  }\r\n\r\n  /**\r\n   * Sets property of current node and execute changes.\r\n   */\r\n  setProperty(propIdent: PropIdent, value?: any) {\r\n    this.emitNodeLifeCycleEvent('clearNodeChanges');\r\n    this.emitNodeLifeCycleEvent('clearGameChanges');\r\n    this.currentNode.setProperty(propIdent, value);\r\n    this.executeNode();\r\n  }\r\n\r\n  /**\r\n   * Gets property of root node.\r\n   */\r\n  getRootProperty(propIdent: PropIdent) {\r\n    return this.rootNode.getProperty(propIdent);\r\n  }\r\n\r\n  /**\r\n   * Returns array of next nodes (children).\r\n   */\r\n  getNextNodes() {\r\n    return this.currentNode.children;\r\n  }\r\n\r\n  /**\r\n   * Go to (specified) next node and execute it.\r\n   */\r\n  next(node: number | KifuNode = 0) {\r\n    if (this.currentNode.children.length) {\r\n      let i: number;\r\n\r\n      if (typeof node === 'number') {\r\n        i = node;\r\n      } else {\r\n        i = this.currentNode.children.indexOf(node);\r\n      }\r\n\r\n      if (this.currentNode.children[i]) {\r\n        this.executeNext(i);\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Go to the previous node.\r\n   */\r\n  previous() {\r\n    if (this.currentNode.parent) {\r\n      this.executePrevious();\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Go to the first position - root node.\r\n   */\r\n  first() {\r\n    // not sure if effective - TODO: check if there is a better way to do this\r\n    while (this.previous()) {}\r\n  }\r\n\r\n  /**\r\n   * Go to the last position.\r\n   */\r\n  last() {\r\n    while (this.next()) {}\r\n  }\r\n\r\n  /**\r\n   * Go to a node specified by path or move number.\r\n   */\r\n  goTo(pathOrMoveNumber: Path | number) {\r\n    // TODO: check if there is a better way to do this\r\n    const path = typeof pathOrMoveNumber === 'number' ? { depth: pathOrMoveNumber, forks: [] } : pathOrMoveNumber;\r\n    this.first();\r\n\r\n    for (let i = 0, j = 0; i < path.depth; i++) {\r\n      if (this.currentNode.children.length > 1) {\r\n        this.next(path.forks[j++]);\r\n      } else {\r\n        this.next();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get path to current node\r\n   */\r\n  getCurrentPath() {\r\n    const path: Path = { depth: 0, forks: [] };\r\n\r\n    if (this.currentNode) {\r\n      let node = this.currentNode;\r\n\r\n      while (node.parent) {\r\n        path.depth++;\r\n\r\n        if (node.parent.children.length > 1) {\r\n          path.forks.push(node.parent.children.indexOf(node));\r\n        }\r\n\r\n        node = node.parent;\r\n      }\r\n    }\r\n\r\n    return path;\r\n  }\r\n\r\n  /**\r\n\t * Go to previous fork (a node with more than one child).\r\n\t */\r\n  previousFork() {\r\n    while (this.previous()) {\r\n      if (this.currentNode.children.length > 1) {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Play a move. New kifu node will be created and move to it\r\n   */\r\n  play(x: number, y: number) {\r\n    const node = new KifuNode();\r\n\r\n    if (this.game.turn === Color.W) {\r\n      node.setProperty(PropIdent.WHITE_MOVE, { x, y });\r\n    } else {\r\n      node.setProperty(PropIdent.BLACK_MOVE, { x, y });\r\n    }\r\n\r\n    const i = this.currentNode.appendChild(node);\r\n    this.next(i);\r\n  }\r\n\r\n  /**\r\n   * Register player's plugin.\r\n   *\r\n   * @param plugin\r\n   */\r\n  use(plugin: PlayerPlugin) {\r\n    if (!plugin || typeof plugin.apply !== 'function') {\r\n      throw new TypeError('Plugin must implement an `apply` method.');\r\n    }\r\n    plugin.apply(this);\r\n    this.plugins.push(plugin);\r\n  }\r\n}\r\n","import { PlayerBase } from '../PlayerBase';\r\nimport makeConfig, { PartialRecursive } from '../utils/makeConfig';\r\nimport PlayerDOMComponent from './components/PlayerDOMComponent';\r\n\r\nexport interface PlayerDOMConfig {\r\n  enableMouseWheel: boolean;\r\n  enableKeys: boolean;\r\n  fastReplay: number;\r\n}\r\n\r\nexport const playerDOMDefaultConfig = {\r\n  enableMouseWheel: true,\r\n  enableKeys: true,\r\n  fastReplay: 2000,\r\n};\r\n\r\n/**\r\n * Player with support to render visual elements into the DOM.\r\n */\r\nexport default class PlayerDOM extends PlayerBase {\r\n  config: PlayerDOMConfig;\r\n  components: Map<HTMLElement, PlayerDOMComponent> = new Map();\r\n  fastReplayTimeout: number;\r\n  fastReplayEnabled = false;\r\n\r\n  constructor(config: PartialRecursive<PlayerDOMConfig> = {}) {\r\n    super();\r\n    this.config = makeConfig(playerDOMDefaultConfig, config);\r\n\r\n    window.addEventListener('resize', this.handleResize);\r\n    document.addEventListener('keydown', this.handleKeydown);\r\n    document.addEventListener('keyup', this.handleKeyup);\r\n  }\r\n\r\n  /**\r\n   * Renders PlayerDOM component into specified HTML element. If there is content inside that element\r\n   * it will be removed. Render method can be called multiple times - this allows to have player's component\r\n   * anywhere you want.\r\n   *\r\n   * @param component\r\n   * @param container\r\n   */\r\n  render(component: PlayerDOMComponent, container: HTMLElement) {\r\n    // clear content of the container\r\n    container.innerHTML = '';\r\n\r\n    // creates wrapper\r\n    const wrapper = this.createWrapper();\r\n    container.appendChild(wrapper);\r\n\r\n    // creates the component HTML element\r\n    wrapper.appendChild(component.element);\r\n    component.create(this);\r\n\r\n    this.components.set(container, component);\r\n  }\r\n\r\n  /**\r\n   * Removes component rendered via `render` method. Call this to clean event listeners of the component.\r\n   *\r\n   * @param container\r\n   */\r\n  clear(container: HTMLElement) {\r\n    const component = this.components.get(container);\r\n\r\n    if (component && typeof component.destroy === 'function') {\r\n      component.destroy();\r\n    }\r\n\r\n    const wrapper = container.firstChild as HTMLDivElement;\r\n    wrapper.removeEventListener('wheel', this.handleMouseWheel);\r\n    container.removeChild(wrapper);\r\n\r\n    this.components.delete(container);\r\n  }\r\n\r\n  private createWrapper() {\r\n    const element = document.createElement('div');\r\n    element.className = 'wgo-player';\r\n    element.tabIndex = 1;\r\n\r\n    element.addEventListener('wheel', this.handleMouseWheel);\r\n\r\n    return element;\r\n  }\r\n\r\n  private handleResize = () => {\r\n    this.emit('resize');\r\n  }\r\n\r\n  private handleMouseWheel = (e: WheelEvent) => {\r\n    if (this.config.enableMouseWheel) {\r\n      if (e.deltaY > 0) {\r\n        this.next();\r\n      } else if (e.deltaY < 0) {\r\n        this.previous();\r\n      }\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  private handleKeydown = (e: KeyboardEvent) => {\r\n    if (this.config.enableKeys && this.hasFocus()) {\r\n      if (this.config.fastReplay >= 0 && !this.fastReplayTimeout) {\r\n        this.fastReplayTimeout = window.setTimeout(() => {\r\n          this.fastReplayEnabled = true;\r\n        }, this.config.fastReplay);\r\n      }\r\n\r\n      if (e.key === 'ArrowRight') {\r\n        this.next();\r\n        if (this.fastReplayEnabled) {\r\n          this.next();\r\n          this.next();\r\n        }\r\n      } else if (e.key === 'ArrowLeft') {\r\n        this.previous();\r\n        if (this.fastReplayEnabled) {\r\n          this.previous();\r\n          this.previous();\r\n        }\r\n      }\r\n\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private handleKeyup = () => {\r\n    window.clearTimeout(this.fastReplayTimeout);\r\n    this.fastReplayTimeout = null;\r\n    this.fastReplayEnabled = false;\r\n  }\r\n\r\n  private hasFocus() {\r\n    for (const elem of this.components.keys()) {\r\n      if (elem.firstChild === document.activeElement) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n","import { BoardBaseConfig, BoardBaseTheme } from '../BoardBase/types';\r\nimport { BoardObject } from '../BoardBase';\r\n\r\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\r\nexport const SVG_OBJECTS = 'objects';\r\nexport const SVG_GRID_MASK = 'gridMask';\r\nexport const SVG_SHADOWS = 'shadows';\r\n\r\nexport interface BoardObjectSVGElements {\r\n  [key: string]: SVGElement;\r\n}\r\n\r\nexport interface SVGDrawHandler {\r\n  /** Should return SVG element representing the board object, can be <g> for multiple elements. */\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void): SVGElement | BoardObjectSVGElements;\r\n\r\n  /** This will be called any time, board object changes. */\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: BoardObject, config: SVGBoardConfig): void;\r\n}\r\n\r\nexport interface SVGBoardTheme extends BoardBaseTheme {\r\n  markupGridMask: number;\r\n\r\n  coordinates: BoardBaseTheme['coordinates'] & {\r\n    fontSize: number,\r\n  };\r\n\r\n  coordinatesTop: boolean;\r\n  coordinatesRight: boolean;\r\n  coordinatesBottom: boolean;\r\n  coordinatesLeft: boolean;\r\n\r\n  drawHandlers: {\r\n    [key: string]: SVGDrawHandler;\r\n  };\r\n}\r\n\r\nexport interface SVGBoardConfig extends BoardBaseConfig {\r\n  theme: SVGBoardTheme;\r\n}\r\n\r\nexport interface SVGCustomObject extends BoardObject {\r\n  handler: SVGDrawHandler;\r\n}\r\n\r\nexport type SVGBoardObject = BoardObject | SVGCustomObject;\r\n","import { SVGBoardConfig, SVG_NS, SVGDrawHandler, SVG_OBJECTS, BoardObjectSVGElements, SVG_GRID_MASK } from '../types';\r\nimport { BoardLineObject } from '../../BoardBase';\r\n\r\ninterface LineParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n}\r\n\r\nexport default class Arrow implements SVGDrawHandler {\r\n  params: LineParams;\r\n\r\n  constructor(params: LineParams = {}) {\r\n    this.params = params;\r\n  }\r\n\r\n  createElement() {\r\n    return {\r\n      [SVG_OBJECTS]: this.createSVGElements(),\r\n      [SVG_GRID_MASK]: this.createSVGElements(),\r\n    };\r\n  }\r\n\r\n  protected createSVGElements() {\r\n    const group = document.createElementNS(SVG_NS, 'g');\r\n    const startCircle = document.createElementNS(SVG_NS, 'circle');\r\n    const line = document.createElementNS(SVG_NS, 'line');\r\n    const endTriangle = document.createElementNS(SVG_NS, 'polygon');\r\n\r\n    group.appendChild(startCircle);\r\n    group.appendChild(line);\r\n    group.appendChild(endTriangle);\r\n    return group;\r\n  }\r\n\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: BoardLineObject, config: SVGBoardConfig) {\r\n    // basic UI definitions\r\n    elem[SVG_OBJECTS].setAttribute('stroke', this.params.color || config.theme.markupNoneColor);\r\n    elem[SVG_OBJECTS].setAttribute('fill', this.params.color || config.theme.markupNoneColor);\r\n    elem[SVG_OBJECTS].setAttribute('stroke-width', this.params.lineWidth || config.theme.markupLineWidth as any);\r\n    this.updateSVGElements(elem[SVG_OBJECTS], boardObject);\r\n\r\n    elem[SVG_GRID_MASK].setAttribute('stroke', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n    elem[SVG_GRID_MASK].setAttribute('fill', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n    elem[SVG_GRID_MASK].setAttribute('stroke-width', (this.params.lineWidth || config.theme.markupLineWidth) * 3 as any);\r\n    this.updateSVGElements(elem[SVG_GRID_MASK], boardObject);\r\n  }\r\n\r\n  protected updateSVGElements(elem: SVGElement, boardObject: BoardLineObject) {\r\n    // SVG elements of arrow\r\n    const startCircle = elem.children[0];\r\n    const line = elem.children[1];\r\n    const endTriangle = elem.children[2];\r\n\r\n    const x1 = boardObject.start.x;\r\n    const y1 = boardObject.start.y;\r\n    const x2 = boardObject.end.x;\r\n    const y2 = boardObject.end.y;\r\n\r\n    // length of the main line\r\n    const length = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\r\n\r\n    // line parametric functions\r\n    const getLineX = (t: number) => x1 + t * (x2 - x1);\r\n    const getLineY = (t: number) => y1 + t * (y2 - y1);\r\n\r\n    // triangle base line position on the main line\r\n    const triangleLen = 1 / length / 2.5;\r\n    const tx = getLineX(1 - triangleLen);\r\n    const ty = getLineY(1 - triangleLen);\r\n\r\n    // triangle base line parametric functions\r\n    const getBaseLineX = (t: number) => tx + t * (y2 - y1);\r\n    const getBaseLineY = (t: number) => ty + t * (x1 - x2);\r\n\r\n    // initial circle length\r\n    const circleLen = 0.1;\r\n\r\n    // draw initial circle\r\n    startCircle.setAttribute('cx', x1 as any);\r\n    startCircle.setAttribute('cy', y1 as any);\r\n    startCircle.setAttribute('r', circleLen as any);\r\n\r\n    // draw line\r\n    line.setAttribute('x1', getLineX(1 / length * circleLen) as any);\r\n    line.setAttribute('y1', getLineY(1 / length * circleLen) as any);\r\n    line.setAttribute('x2', tx as any);\r\n    line.setAttribute('y2', ty as any);\r\n\r\n    // draw triangle at the end to make arrow\r\n    endTriangle.setAttribute('points', `\r\n      ${getBaseLineX(- triangleLen / 1.75)},${getBaseLineY(- triangleLen / 1.75)}\r\n      ${getBaseLineX(triangleLen / 1.75)},${getBaseLineY(triangleLen / 1.75)}\r\n      ${x2},${y2}\r\n    `);\r\n  }\r\n}\r\n","\r\nimport { SVGDrawHandler, SVGBoardConfig, BoardObjectSVGElements, SVG_OBJECTS } from '../types';\r\nimport { FieldObject } from '../../BoardBase';\r\n\r\nexport default abstract class SVGFieldDrawHandler implements SVGDrawHandler {\r\n  // tslint:disable-next-line:max-line-length\r\n  abstract createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void): SVGElement | BoardObjectSVGElements;\r\n\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: FieldObject, config: SVGBoardConfig) {\r\n    const transform = `translate(${boardObject.x}, ${boardObject.y})`;\r\n    const scale = `scale(${boardObject.scaleX}, ${boardObject.scaleY})`;\r\n    const rotate = `rotate(${boardObject.rotate})`;\r\n\r\n    Object.keys(elem).forEach((ctx) => {\r\n      elem[ctx].setAttribute('transform', `${transform} ${scale} ${rotate}`);\r\n      elem[ctx].setAttribute('opacity', boardObject.opacity as any);\r\n    });\r\n  }\r\n}\r\n","import { SVGDrawHandler, SVGBoardConfig, BoardObjectSVGElements, SVG_OBJECTS } from '../types';\r\nimport { BoardMarkupObject } from '../../BoardBase';\r\nimport { Color } from '../../types';\r\nimport SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\n\r\nexport interface SVGMarkupDrawHandlerParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n  fillColor?: string;\r\n}\r\n\r\nexport default abstract class SVGMarkupDrawHandler extends SVGFieldDrawHandler {\r\n  params: SVGMarkupDrawHandlerParams;\r\n\r\n  constructor(params: SVGMarkupDrawHandlerParams = {}) {\r\n    super();\r\n    this.params = params;\r\n  }\r\n\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: BoardMarkupObject, config: SVGBoardConfig) {\r\n    super.updateElement(elem, boardObject, config);\r\n\r\n    if (boardObject.variation === Color.B) {\r\n      elem[SVG_OBJECTS].setAttribute('stroke', config.theme.markupBlackColor);\r\n      elem[SVG_OBJECTS].setAttribute('fill', this.params.fillColor || 'rgba(0,0,0,0)');\r\n    } else if (boardObject.variation === Color.W) {\r\n      elem[SVG_OBJECTS].setAttribute('stroke', config.theme.markupWhiteColor);\r\n      elem[SVG_OBJECTS].setAttribute('fill', this.params.fillColor || 'rgba(0,0,0,0)');\r\n    } else {\r\n      elem[SVG_OBJECTS].setAttribute('stroke', this.params.color || config.theme.markupNoneColor);\r\n      elem[SVG_OBJECTS].setAttribute('fill', this.params.fillColor || 'rgba(0,0,0,0)');\r\n    }\r\n\r\n    elem[SVG_OBJECTS].setAttribute('stroke-width', this.params.lineWidth || config.theme.markupLineWidth as any);\r\n  }\r\n}\r\n","import { SVG_NS, SVG_OBJECTS, SVG_GRID_MASK, SVGBoardConfig } from '../types';\r\nimport SVGMarkupDrawHandler from './SVGMarkupDrawHandler';\r\n\r\nexport default class Circle extends SVGMarkupDrawHandler {\r\n  createElement(config: SVGBoardConfig) {\r\n    const circle = document.createElementNS(SVG_NS, 'circle');\r\n    circle.setAttribute('cx', '0');\r\n    circle.setAttribute('cy', '0');\r\n    circle.setAttribute('r', '0.25');\r\n\r\n    const mask = document.createElementNS(SVG_NS, 'circle');\r\n    mask.setAttribute('cx', '0');\r\n    mask.setAttribute('cy', '0');\r\n    mask.setAttribute('r', '0.35');\r\n    mask.setAttribute('fill', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: circle,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n}\r\n","import { SVG_NS } from '../types';\r\nimport SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\n\r\nexport default class Dim extends SVGFieldDrawHandler {\r\n  params: { color: string };\r\n\r\n  constructor(params: { color: string }) {\r\n    super();\r\n    this.params = params;\r\n  }\r\n\r\n  createElement() {\r\n    const rect = document.createElementNS(SVG_NS, 'rect');\r\n    rect.setAttribute('x', '-0.5');\r\n    rect.setAttribute('y', '-0.5');\r\n    rect.setAttribute('width', '1');\r\n    rect.setAttribute('height', '1');\r\n    rect.setAttribute('fill', this.params.color);\r\n\r\n    return rect;\r\n  }\r\n}\r\n","import { SVG_NS } from '../types';\r\nimport SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\n\r\nexport default class Dot extends SVGFieldDrawHandler {\r\n  params: { color: string };\r\n\r\n  constructor(params: { color: string }) {\r\n    super();\r\n    this.params = params;\r\n  }\r\n\r\n  createElement() {\r\n    const circle = document.createElementNS(SVG_NS, 'circle');\r\n    circle.setAttribute('cx', '0');\r\n    circle.setAttribute('cy', '0');\r\n    circle.setAttribute('r', '0.15');\r\n    circle.setAttribute('fill', this.params.color);\r\n\r\n    return circle;\r\n  }\r\n}\r\n","export default function generateId(prefix: string) {\r\n  return `${prefix}-${Math.floor(Math.random() * 1000000000).toString(36)}`;\r\n}\r\n","import SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\nimport { SVGBoardConfig, SVG_NS, BoardObjectSVGElements } from '../types';\r\nimport generateId from '../generateId';\r\n\r\nexport default abstract class SVGStoneDrawHandler extends SVGFieldDrawHandler {\r\n  shadowFilterElement: SVGElement;\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void): SVGElement | BoardObjectSVGElements {\r\n    /*if (!this.shadowFilterElement) {\r\n      this.shadowFilterElement = document.createElementNS(NS, 'filter');\r\n      this.shadowFilterElement.setAttribute('id', generateId('filter'));\r\n      this.shadowFilterElement.innerHTML = `\r\n        <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"0.05\" />\r\n        <feOffset dx=\"0.03\" dy=\"0.03\" result=\"offsetblur\" />\r\n        <feComponentTransfer>\r\n          <feFuncA type=\"linear\" slope=\"0.5\" />\r\n        </feComponentTransfer>\r\n        <feMerge>\r\n          <feMergeNode />\r\n          <feMergeNode in=\"SourceGraphic\" />\r\n        </feMerge>\r\n      `;\r\n\r\n      addDef(this.shadowFilterElement);\r\n    }*/\r\n\r\n    return null;\r\n  }\r\n\r\n  createShadow(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    const stoneRadius = config.theme.stoneSize;\r\n\r\n    if (!this.shadowFilterElement) {\r\n      const shadowFilterElement = document.createElementNS(SVG_NS, 'radialGradient');\r\n      const blur = config.theme.shadowBlur;\r\n\r\n      const startRadius = Math.max(stoneRadius - stoneRadius * blur, 0.00001);\r\n      const stopRadius = stoneRadius + (1 / 7 * stoneRadius) * blur;\r\n\r\n      shadowFilterElement.setAttribute('id', generateId('shadowFilter'));\r\n      shadowFilterElement.setAttribute('fr', String(startRadius));\r\n      shadowFilterElement.setAttribute('r', String(stopRadius));\r\n      shadowFilterElement.innerHTML = `\r\n        <stop offset=\"0%\" stop-color=\"${config.theme.shadowColor}\" />\r\n        <stop offset=\"100%\" stop-color=\"${config.theme.shadowTransparentColor}\" />\r\n      `;\r\n\r\n      addDef(shadowFilterElement);\r\n      this.shadowFilterElement = shadowFilterElement;\r\n    }\r\n\r\n    const shadow = document.createElementNS(SVG_NS, 'circle');\r\n\r\n    shadow.setAttribute('cx', String(config.theme.shadowOffsetX));\r\n    shadow.setAttribute('cy', String(config.theme.shadowOffsetY));\r\n    shadow.setAttribute('r', String(stoneRadius));\r\n    shadow.setAttribute('fill', `url(#${this.shadowFilterElement.id})`);\r\n\r\n    return shadow;\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_SHADOWS } from '../types';\r\nimport SVGStoneDrawHandler from './SVGStoneDrawHandler';\r\nimport generateId from '../generateId';\r\n\r\nexport default class GlassStoneBlack extends SVGStoneDrawHandler {\r\n  filterElement: SVGFilterElement;\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    super.createElement(config, addDef);\r\n\r\n    if (!this.filterElement) {\r\n      const filter = document.createElementNS(SVG_NS, 'filter');\r\n\r\n      filter.setAttribute('id', generateId('filter'));\r\n      filter.setAttribute('x', '-300%');\r\n      filter.setAttribute('y', '-300%');\r\n      filter.setAttribute('width', '600%');\r\n      filter.setAttribute('height', '600%');\r\n\r\n      const blur = document.createElementNS(SVG_NS, 'feGaussianBlur');\r\n\r\n      blur.setAttribute('in', 'SourceGraphic');\r\n      blur.setAttribute('stdDeviation', 0.3 * config.theme.stoneSize as any);\r\n      filter.appendChild(blur);\r\n\r\n      this.filterElement = filter;\r\n      addDef(filter);\r\n    }\r\n\r\n    const stoneGroup = document.createElementNS(SVG_NS, 'g');\r\n\r\n    const stone = document.createElementNS(SVG_NS, 'circle');\r\n    stone.setAttribute('cx', '0');\r\n    stone.setAttribute('cy', '0');\r\n    stone.setAttribute('fill', '#000');\r\n    stone.setAttribute('r', config.theme.stoneSize as any);\r\n    stoneGroup.appendChild(stone);\r\n\r\n    const glow1 = document.createElementNS(SVG_NS, 'circle');\r\n    glow1.setAttribute('cx', -0.4 * config.theme.stoneSize as any);\r\n    glow1.setAttribute('cy', -0.4 * config.theme.stoneSize as any);\r\n    glow1.setAttribute('r', 0.25 * config.theme.stoneSize as any);\r\n    glow1.setAttribute('fill', '#fff');\r\n    glow1.setAttribute('filter', `url(#${this.filterElement.id})`);\r\n    stoneGroup.appendChild(glow1);\r\n\r\n    const glow2 = document.createElementNS(SVG_NS, 'circle');\r\n    glow2.setAttribute('cx', 0.4 * config.theme.stoneSize as any);\r\n    glow2.setAttribute('cy', 0.4 * config.theme.stoneSize as any);\r\n    glow2.setAttribute('r', 0.15 * config.theme.stoneSize as any);\r\n    glow2.setAttribute('fill', '#fff');\r\n    glow2.setAttribute('filter', `url(#${this.filterElement.id})`);\r\n    stoneGroup.appendChild(glow2);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: stoneGroup,\r\n      [SVG_SHADOWS]: this.createShadow(config, addDef),\r\n    };\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_SHADOWS } from '../types';\r\nimport SVGStoneDrawHandler from './SVGStoneDrawHandler';\r\nimport generateId from '../generateId';\r\n\r\nexport default class GlassStoneWhite extends SVGStoneDrawHandler {\r\n  filterElement1: SVGElement;\r\n  filterElement2: SVGElement;\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    super.createElement(config, addDef);\r\n\r\n    if (!this.filterElement1) {\r\n      const filter1 = document.createElementNS(SVG_NS, 'radialGradient');\r\n      filter1.setAttribute('id', generateId('filter'));\r\n      filter1.setAttribute('fx', '30%');\r\n      filter1.setAttribute('fy', '30%');\r\n      filter1.innerHTML = `\r\n        <stop offset=\"10%\" stop-color=\"rgba(255,255,255,0.9)\" />\r\n        <stop offset=\"100%\" stop-color=\"rgba(255,255,255,0)\" />\r\n      `;\r\n\r\n      addDef(filter1);\r\n      this.filterElement1 = filter1;\r\n\r\n      const filter2 = document.createElementNS(SVG_NS, 'radialGradient');\r\n      filter2.setAttribute('id', generateId('filter'));\r\n      filter2.setAttribute('fx', '70%');\r\n      filter2.setAttribute('fy', '70%');\r\n      filter2.innerHTML = `\r\n        <stop offset=\"10%\" stop-color=\"rgba(255,255,255,0.7)\" />\r\n        <stop offset=\"100%\" stop-color=\"rgba(255,255,255,0)\" />\r\n      `;\r\n\r\n      addDef(filter2);\r\n      this.filterElement2 = filter2;\r\n    }\r\n\r\n    const stoneGroup = document.createElementNS(SVG_NS, 'g');\r\n\r\n    const stone = document.createElementNS(SVG_NS, 'circle');\r\n    stone.setAttribute('cx', '0');\r\n    stone.setAttribute('cy', '0');\r\n    stone.setAttribute('fill', '#ccc');\r\n    stone.setAttribute('r', config.theme.stoneSize as any);\r\n    stoneGroup.appendChild(stone);\r\n\r\n    const glow1 = document.createElementNS(SVG_NS, 'circle');\r\n    glow1.setAttribute('cx', '0');\r\n    glow1.setAttribute('cy', '0');\r\n    glow1.setAttribute('r', config.theme.stoneSize as any);\r\n    glow1.setAttribute('fill', `url(#${this.filterElement1.id})`);\r\n    stoneGroup.appendChild(glow1);\r\n\r\n    const glow2 = document.createElementNS(SVG_NS, 'circle');\r\n    glow2.setAttribute('cx', '0');\r\n    glow2.setAttribute('cy', '0');\r\n    glow2.setAttribute('r', config.theme.stoneSize as any);\r\n    glow2.setAttribute('fill', `url(#${this.filterElement2.id})`);\r\n    stoneGroup.appendChild(glow2);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: stoneGroup,\r\n      [SVG_SHADOWS]: this.createShadow(config, addDef),\r\n    };\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, BoardObjectSVGElements, SVG_GRID_MASK } from '../types';\r\nimport SVGMarkupDrawHandler, { SVGMarkupDrawHandlerParams } from './SVGMarkupDrawHandler';\r\nimport { BoardLabelObject } from '../../BoardBase';\r\nimport { Color } from '../../types';\r\n\r\ninterface LabelParams extends SVGMarkupDrawHandlerParams {\r\n  font?: string;\r\n  maxWidth?: number;\r\n}\r\n\r\nexport default class Label extends SVGMarkupDrawHandler {\r\n  params: LabelParams;\r\n\r\n  constructor(params: LabelParams = {}) {\r\n    super(params);\r\n\r\n    if (!params.maxWidth && params.maxWidth !== 0) {\r\n      params.maxWidth = 0.95;\r\n    }\r\n  }\r\n\r\n  createElement(config: SVGBoardConfig) {\r\n    const text = document.createElementNS(SVG_NS, 'text');\r\n    text.setAttribute('text-anchor', 'middle');\r\n    text.setAttribute('dominant-baseline', 'middle');\r\n    text.setAttribute('lengthAdjust', 'spacingAndGlyphs');\r\n\r\n    const mask = document.createElementNS(SVG_NS, 'text');\r\n    mask.setAttribute('text-anchor', 'middle');\r\n    mask.setAttribute('dominant-baseline', 'middle');\r\n    mask.setAttribute('stroke-width', '0.2');\r\n    mask.setAttribute('stroke', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n    mask.setAttribute('lengthAdjust', 'spacingAndGlyphs');\r\n\r\n    return {\r\n      [SVG_OBJECTS]: text,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: BoardLabelObject, config: SVGBoardConfig) {\r\n    super.updateElement(elem, boardObject, config);\r\n\r\n    let fontSize = 0.5;\r\n    if (boardObject.text.length === 1) {\r\n      fontSize = 0.7;\r\n    } else if (boardObject.text.length === 2) {\r\n      fontSize = 0.6;\r\n    }\r\n\r\n    if (this.params.color) {\r\n      elem[SVG_OBJECTS].setAttribute('fill', this.params.color);\r\n    } else {\r\n      if (boardObject.variation === Color.B) {\r\n        elem[SVG_OBJECTS].setAttribute('fill', config.theme.markupBlackColor);\r\n      } else if (boardObject.variation === Color.W) {\r\n        elem[SVG_OBJECTS].setAttribute('fill', config.theme.markupWhiteColor);\r\n      } else {\r\n        elem[SVG_OBJECTS].setAttribute('fill', config.theme.markupNoneColor);\r\n      }\r\n    }\r\n\r\n    elem[SVG_OBJECTS].removeAttribute('stroke');\r\n    elem[SVG_OBJECTS].setAttribute('font-family', this.params.font || config.theme.font);\r\n    elem[SVG_OBJECTS].setAttribute('stroke-width', '0');\r\n    elem[SVG_OBJECTS].setAttribute('font-size', fontSize as any);\r\n    elem[SVG_OBJECTS].textContent = boardObject.text;\r\n\r\n    elem[SVG_GRID_MASK].setAttribute('font-size', fontSize as any);\r\n    elem[SVG_GRID_MASK].textContent = boardObject.text;\r\n\r\n    if (this.params.maxWidth > 0) {\r\n      if ((elem[SVG_OBJECTS] as SVGTextElement).getComputedTextLength() > this.params.maxWidth) {\r\n        elem[SVG_OBJECTS].setAttribute('textLength', `${this.params.maxWidth}`);\r\n        elem[SVG_GRID_MASK].setAttribute('textLength', `${this.params.maxWidth}`);\r\n      } else {\r\n        elem[SVG_OBJECTS].removeAttribute('textLength');\r\n        elem[SVG_GRID_MASK].removeAttribute('textLength');\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVGDrawHandler, BoardObjectSVGElements, SVG_OBJECTS, SVG_GRID_MASK } from '../types';\r\nimport { BoardLineObject } from '../../BoardBase';\r\n\r\ninterface LineParams {\r\n  color?: string;\r\n  lineWidth?: number;\r\n}\r\n\r\nexport default class Line implements SVGDrawHandler {\r\n  params: LineParams;\r\n\r\n  constructor(params: LineParams = {}) {\r\n    this.params = params;\r\n  }\r\n\r\n  createElement() {\r\n    const line = document.createElementNS(SVG_NS, 'line');\r\n    const mask = document.createElementNS(SVG_NS, 'line');\r\n\r\n    return {\r\n      [SVG_OBJECTS]: line,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n\r\n  updateElement(elem: BoardObjectSVGElements, boardObject: BoardLineObject, config: SVGBoardConfig) {\r\n    elem[SVG_OBJECTS].setAttribute('stroke', this.params.color || config.theme.markupNoneColor);\r\n    elem[SVG_OBJECTS].setAttribute('stroke-width', this.params.lineWidth || config.theme.markupLineWidth as any);\r\n    elem[SVG_OBJECTS].setAttribute('x1', boardObject.start.x as any);\r\n    elem[SVG_OBJECTS].setAttribute('y1', boardObject.start.y as any);\r\n    elem[SVG_OBJECTS].setAttribute('x2', boardObject.end.x as any);\r\n    elem[SVG_OBJECTS].setAttribute('y2', boardObject.end.y as any);\r\n\r\n    elem[SVG_GRID_MASK].setAttribute('stroke', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n    elem[SVG_GRID_MASK].setAttribute('stroke-width', (this.params.lineWidth || config.theme.markupLineWidth) * 2 as any);\r\n    elem[SVG_GRID_MASK].setAttribute('x1', boardObject.start.x as any);\r\n    elem[SVG_GRID_MASK].setAttribute('y1', boardObject.start.y as any);\r\n    elem[SVG_GRID_MASK].setAttribute('x2', boardObject.end.x as any);\r\n    elem[SVG_GRID_MASK].setAttribute('y2', boardObject.end.y as any);\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_SHADOWS } from '../types';\r\nimport SVGStoneDrawHandler from './SVGStoneDrawHandler';\r\nimport generateId from '../generateId';\r\n\r\nexport default class GlassStoneWhite extends SVGStoneDrawHandler {\r\n  filterElement1: SVGElement;\r\n  filterElement2: SVGElement;\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    super.createElement(config, addDef);\r\n\r\n    if (!this.filterElement1) {\r\n      const filter1 = document.createElementNS(SVG_NS, 'radialGradient');\r\n      filter1.setAttribute('id', generateId('filter'));\r\n      filter1.setAttribute('cx', '45%');\r\n      filter1.setAttribute('cy', '45%');\r\n      filter1.setAttribute('fx', '20%');\r\n      filter1.setAttribute('fy', '20%');\r\n      filter1.setAttribute('r', '60%');\r\n      filter1.innerHTML = `\r\n        <stop offset=\"0%\" stop-color=\"rgba(48,48,48,1)\" />\r\n        <stop offset=\"80%\" stop-color=\"rgba(16,16,16,1)\" />\r\n        <stop offset=\"100%\" stop-color=\"rgba(0,0,0,1)\" />\r\n      `;\r\n\r\n      addDef(filter1);\r\n      this.filterElement1 = filter1;\r\n    }\r\n\r\n    const stoneGroup = document.createElementNS(SVG_NS, 'g');\r\n\r\n    const stone = document.createElementNS(SVG_NS, 'circle');\r\n    stone.setAttribute('cx', '0');\r\n    stone.setAttribute('cy', '0');\r\n    stone.setAttribute('fill', `url(#${this.filterElement1.id})`);\r\n    stone.setAttribute('r', config.theme.stoneSize as any);\r\n    stoneGroup.appendChild(stone);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: stoneGroup,\r\n      [SVG_SHADOWS]: this.createShadow(config, addDef),\r\n    };\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_SHADOWS } from '../types';\r\nimport SVGStoneDrawHandler from './SVGStoneDrawHandler';\r\nimport generateId from '../generateId';\r\n\r\nexport default class GlassStoneWhite extends SVGStoneDrawHandler {\r\n  filterElement1: SVGElement;\r\n  filterElement2: SVGElement;\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    super.createElement(config, addDef);\r\n\r\n    if (!this.filterElement1) {\r\n      const filter1 = document.createElementNS(SVG_NS, 'radialGradient');\r\n      filter1.setAttribute('id', generateId('filter'));\r\n      filter1.setAttribute('cx', '45%');\r\n      filter1.setAttribute('cy', '45%');\r\n      filter1.setAttribute('fx', '20%');\r\n      filter1.setAttribute('fy', '20%');\r\n      filter1.setAttribute('r', '60%');\r\n      filter1.innerHTML = `\r\n        <stop offset=\"0%\" stop-color=\"rgba(255,255,255,1)\" />\r\n        <stop offset=\"80%\" stop-color=\"rgba(215,215,215,1)\" />\r\n        <stop offset=\"100%\" stop-color=\"rgba(170,170,170,1)\" />\r\n      `;\r\n\r\n      addDef(filter1);\r\n      this.filterElement1 = filter1;\r\n    }\r\n\r\n    const stoneGroup = document.createElementNS(SVG_NS, 'g');\r\n\r\n    const stone = document.createElementNS(SVG_NS, 'circle');\r\n    stone.setAttribute('cx', '0');\r\n    stone.setAttribute('cy', '0');\r\n    stone.setAttribute('fill', `url(#${this.filterElement1.id})`);\r\n    stone.setAttribute('r', config.theme.stoneSize as any);\r\n    stoneGroup.appendChild(stone);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: stoneGroup,\r\n      [SVG_SHADOWS]: this.createShadow(config, addDef),\r\n    };\r\n  }\r\n}\r\n","import SVGStoneDrawHandler from './SVGStoneDrawHandler';\r\nimport SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\nimport { SVGBoardConfig, SVG_NS, SVG_OBJECTS } from '../types';\r\n\r\nexport default class RealisticStone extends SVGStoneDrawHandler {\r\n  paths: string[];\r\n  fallback: SVGFieldDrawHandler;\r\n  randSeed: number;\r\n  loadedPaths: { [path: string]: boolean };\r\n\r\n  constructor (paths: string[], fallback: SVGFieldDrawHandler) {\r\n    super();\r\n    this.fallback = fallback;\r\n    this.randSeed = Math.ceil(Math.random() * 9999999);\r\n    this.paths = paths;\r\n    this.loadedPaths = {};\r\n  }\r\n\r\n  createElement(config: SVGBoardConfig, addDef: (def: SVGElement) => void) {\r\n    super.createElement(config, addDef);\r\n\r\n    const id = Math.floor(Math.random() * this.paths.length);\r\n    const group = document.createElementNS(SVG_NS, 'g');\r\n    let fallbackElement: any;\r\n\r\n    if (!this.loadedPaths[id]) {\r\n      fallbackElement = this.fallback.createElement(config, addDef);\r\n\r\n      if (!(fallbackElement instanceof SVGElement)) {\r\n        fallbackElement = fallbackElement[SVG_OBJECTS];\r\n      }\r\n\r\n      group.appendChild(fallbackElement);\r\n    }\r\n\r\n    const image = document.createElementNS(SVG_NS, 'image');\r\n    image.setAttribute('href', this.paths[id]);\r\n    image.setAttribute('width', config.theme.stoneSize * 2 as any);\r\n    image.setAttribute('height', config.theme.stoneSize * 2 as any);\r\n    image.setAttribute('x', -config.theme.stoneSize as any);\r\n    image.setAttribute('y', -config.theme.stoneSize as any);\r\n    if (!this.loadedPaths[id]) {\r\n      image.setAttribute('opacity', '0');\r\n    }\r\n    image.addEventListener('load', () => {\r\n      if (fallbackElement) {\r\n        image.setAttribute('opacity', '1');\r\n        group.removeChild(fallbackElement as SVGElement);\r\n        this.loadedPaths[id] = true;\r\n      }\r\n    });\r\n\r\n    group.appendChild(image);\r\n\r\n    return group;\r\n  }\r\n}\r\n","import { SVG_NS, SVGBoardConfig } from '../types';\r\nimport SVGFieldDrawHandler from './SVGFieldDrawHandler';\r\n\r\nexport default class SimpleStone extends SVGFieldDrawHandler {\r\n  color: string;\r\n\r\n  constructor(color: string) {\r\n    super();\r\n    this.color = color;\r\n  }\r\n\r\n  createElement(config: SVGBoardConfig) {\r\n    const stone = document.createElementNS(SVG_NS, 'circle');\r\n\r\n    stone.setAttribute('cx', '0');\r\n    stone.setAttribute('cy', '0');\r\n    stone.setAttribute('r', config.theme.stoneSize as any);\r\n    stone.setAttribute('fill', this.color);\r\n\r\n    return stone;\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_GRID_MASK } from '../types';\r\nimport SVGMarkupDrawHandler from './SVGMarkupDrawHandler';\r\n\r\nexport default class Square extends SVGMarkupDrawHandler {\r\n  createElement(config: SVGBoardConfig) {\r\n    const square = document.createElementNS(SVG_NS, 'rect');\r\n    square.setAttribute('x', '-0.25');\r\n    square.setAttribute('y', '-0.25');\r\n    square.setAttribute('width', '0.50');\r\n    square.setAttribute('height', '0.50');\r\n\r\n    const mask = document.createElementNS(SVG_NS, 'rect');\r\n    mask.setAttribute('x', '-0.35');\r\n    mask.setAttribute('y', '-0.35');\r\n    mask.setAttribute('width', '0.70');\r\n    mask.setAttribute('height', '0.70');\r\n    mask.setAttribute('fill', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: square,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n}\r\n","import { SVGBoardConfig, SVG_NS, SVG_OBJECTS, SVG_GRID_MASK } from '../types';\r\nimport SVGMarkupDrawHandler from './SVGMarkupDrawHandler';\r\n\r\nexport default class Triangle extends SVGMarkupDrawHandler {\r\n  createElement(config: SVGBoardConfig) {\r\n    const triangle = document.createElementNS(SVG_NS, 'polygon');\r\n    triangle.setAttribute('points', '0,-0.25 -0.25,0.166666 0.25,0.166666');\r\n\r\n    const mask = document.createElementNS(SVG_NS, 'polygon');\r\n    mask.setAttribute('points', '0,-0.35 -0.35,0.2333333 0.35,0.2333333');\r\n    mask.setAttribute('fill', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: triangle,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n}\r\n","import { SVG_NS, SVG_OBJECTS, SVG_GRID_MASK, SVGBoardConfig } from '../types';\r\nimport SVGMarkupDrawHandler from './SVGMarkupDrawHandler';\r\n\r\nexport default class XMark extends SVGMarkupDrawHandler {\r\n  createElement(config: SVGBoardConfig) {\r\n    const path = document.createElementNS(SVG_NS, 'path');\r\n    path.setAttribute('d', 'M -0.20,-0.20 L 0.20,0.20 M 0.20,-0.20 L -0.20,0.20');\r\n\r\n    const mask = document.createElementNS(SVG_NS, 'circle');\r\n    mask.setAttribute('cx', '0');\r\n    mask.setAttribute('cy', '0');\r\n    mask.setAttribute('r', '0.15');\r\n    mask.setAttribute('fill', `rgba(0,0,0,${config.theme.markupGridMask})`);\r\n\r\n    return {\r\n      [SVG_OBJECTS]: path,\r\n      [SVG_GRID_MASK]: mask,\r\n    };\r\n  }\r\n}\r\n","import { SVG_NS, SVGBoardConfig } from './types';\r\n\r\nfunction line(fromX: number, fromY: number, toX: number, toY: number) {\r\n  const line = document.createElementNS(SVG_NS, 'line');\r\n  line.setAttribute('x1', fromX as any);\r\n  line.setAttribute('y1', fromY as any);\r\n  line.setAttribute('x2', toX as any);\r\n  line.setAttribute('y2', toY as any);\r\n\r\n  return line;\r\n}\r\n\r\nfunction star(x: number, y: number, starSize: number) {\r\n  const star = document.createElementNS(SVG_NS, 'circle');\r\n  star.setAttribute('cx', x as any);\r\n  star.setAttribute('cy', y as any);\r\n  star.setAttribute('r', starSize as any);\r\n  star.setAttribute('fill', '#553310');\r\n  star.setAttribute('stroke-width', '0');\r\n\r\n  return star;\r\n}\r\n\r\nexport default function createGrid(config: SVGBoardConfig) {\r\n  const { linesWidth } = config.theme.grid;\r\n\r\n  const grid = document.createElementNS(SVG_NS, 'g');\r\n  grid.setAttribute('stroke', config.theme.grid.linesColor);\r\n  grid.setAttribute('stroke-width', linesWidth.toString());\r\n  grid.setAttribute('fill', config.theme.grid.starColor);\r\n\r\n  for (let i = 0; i < config.size; i++) {\r\n    grid.appendChild(line(i, 0 - linesWidth / 2, i, config.size - 1 + linesWidth / 2));\r\n    grid.appendChild(line(0 - linesWidth / 2, i, config.size - 1 + linesWidth / 2, i));\r\n  }\r\n\r\n  const starPoints = config.starPoints[config.size];\r\n\r\n  if (starPoints) {\r\n    starPoints.forEach((starPoint) => {\r\n      grid.appendChild(star(starPoint.x, starPoint.y, config.theme.grid.starSize));\r\n    });\r\n  }\r\n  return grid;\r\n}\r\n","import { SVG_NS, SVGBoardConfig } from './types';\r\n\r\nfunction letter(x: number, y: number, str: string) {\r\n  const text = document.createElementNS(SVG_NS, 'text');\r\n  text.setAttribute('x', x as any);\r\n  text.setAttribute('y', y as any);\r\n  text.textContent = str;\r\n\r\n  return text;\r\n}\r\n\r\nexport default function createCoordinates(config: SVGBoardConfig) {\r\n  const coordinates = document.createElementNS(SVG_NS, 'g');\r\n  coordinates.style.userSelect = 'none';\r\n\r\n  coordinates.setAttribute('font-family', config.theme.font);\r\n  coordinates.setAttribute('font-size', config.theme.coordinates.fontSize as any);\r\n  coordinates.setAttribute('text-anchor', 'middle');\r\n  coordinates.setAttribute('dominant-baseline', 'middle');\r\n\r\n  if (config.theme.coordinates.bold) {\r\n    coordinates.setAttribute('font-weight', 'bold');\r\n  }\r\n\r\n  coordinates.setAttribute('fill', config.theme.coordinates.color);\r\n\r\n  for (let i = 0; i < config.size; i++) {\r\n    if (config.theme.coordinatesTop) {\r\n      coordinates.appendChild(letter(i, -0.75, config.coordinateLabelsX[i] as string));\r\n    }\r\n    if (config.theme.coordinatesBottom) {\r\n      coordinates.appendChild(letter(i, config.size - 0.25, config.coordinateLabelsX[i] as string));\r\n    }\r\n    if (config.theme.coordinatesLeft) {\r\n      coordinates.appendChild(letter(-0.75, config.size - i - 1, config.coordinateLabelsY[i] as string));\r\n    }\r\n    if (config.theme.coordinatesRight) {\r\n      coordinates.appendChild(letter(config.size - 0.25, config.size - i - 1, config.coordinateLabelsY[i] as string));\r\n    }\r\n  }\r\n\r\n  return coordinates;\r\n}\r\n","import { defaultBoardBaseTheme } from '../BoardBase/defaultConfig';\r\nimport { SVGBoardTheme } from './types';\r\nimport * as drawHandlers from './svgDrawHandlers';\r\nimport ModernStoneWhite from './svgDrawHandlers/ModernStoneWhite';\r\nimport ModernStoneBlack from './svgDrawHandlers/ModernStoneBlack';\r\n\r\nconst defaultSVGTheme: SVGBoardTheme = {\r\n  ...defaultBoardBaseTheme,\r\n  // backgroundImage: 'images/wood1.jpg',\r\n  markupGridMask: 0.8,\r\n  stoneSize: 0.48,\r\n\r\n  coordinates: {\r\n    ...defaultBoardBaseTheme.coordinates,\r\n    fontSize: 0.5,\r\n  },\r\n\r\n  coordinatesTop: true,\r\n  coordinatesRight: true,\r\n  coordinatesBottom: true,\r\n  coordinatesLeft: true,\r\n\r\n  grid: {\r\n    ...defaultBoardBaseTheme.grid,\r\n    linesWidth: 0.03,\r\n    starSize: 0.09,\r\n  },\r\n\r\n  drawHandlers: {\r\n    CR: new drawHandlers.Circle(),\r\n    SQ: new drawHandlers.Square(),\r\n    LB: new drawHandlers.Label(),\r\n    TR: new drawHandlers.Triangle(),\r\n    MA: new drawHandlers.XMark({ lineWidth: 0.075 }),\r\n    SL: new drawHandlers.Dot({ color: 'rgba(32, 32, 192, 0.75)' }),\r\n    LN: new drawHandlers.Line(),\r\n    AR: new drawHandlers.Arrow(),\r\n    DD: new drawHandlers.Dim({ color: 'rgba(0, 0, 0, 0.5)' }),\r\n    // B: new drawHandlers.GlassStoneBlack(),\r\n    // W: new drawHandlers.GlassStoneWhite(),\r\n    W: new ModernStoneWhite(),\r\n    B: new ModernStoneBlack(),\r\n    /*B: new drawHandlers.RealisticStone([\r\n      'images/stones/black00_128.png',\r\n      'images/stones/black01_128.png',\r\n      'images/stones/black02_128.png',\r\n      'images/stones/black03_128.png',\r\n    ], new drawHandlers.GlassStoneBlack()),\r\n    W: new drawHandlers.RealisticStone([\r\n      'images/stones/white00_128.png',\r\n      'images/stones/white01_128.png',\r\n      'images/stones/white02_128.png',\r\n      'images/stones/white03_128.png',\r\n      'images/stones/white04_128.png',\r\n      'images/stones/white05_128.png',\r\n      'images/stones/white06_128.png',\r\n      'images/stones/white07_128.png',\r\n      'images/stones/white08_128.png',\r\n      'images/stones/white09_128.png',\r\n      'images/stones/white10_128.png',\r\n    ], new drawHandlers.GlassStoneWhite()),*/\r\n  },\r\n};\r\n\r\nexport default defaultSVGTheme;\r\n","import { BoardBase, BoardViewport } from '../BoardBase';\r\nimport makeConfig, { PartialRecursive } from '../utils/makeConfig';\r\nimport createGrid from './createGrid';\r\nimport createCoordinates from './createCoordinates';\r\nimport {\r\n  SVGDrawHandler,\r\n  SVGBoardConfig,\r\n  SVG_NS,\r\n  SVG_OBJECTS,\r\n  BoardObjectSVGElements,\r\n  SVG_GRID_MASK,\r\n  SVG_SHADOWS,\r\n  SVGBoardObject,\r\n} from './types';\r\nimport { defaultBoardBaseConfig } from '../BoardBase/defaultConfig';\r\nimport defaultSVGTheme from './defaultSVGTheme';\r\nimport generateId from './generateId';\r\nimport { Point } from '../types';\r\n\r\nconst svgBoardDefaultConfig: SVGBoardConfig = {\r\n  ...defaultBoardBaseConfig,\r\n  theme: defaultSVGTheme,\r\n};\r\n\r\nexport default class SVGBoard extends BoardBase {\r\n  config: SVGBoardConfig;\r\n  boardElement: HTMLElement;\r\n  touchArea: HTMLElement;\r\n  svgElement: SVGElement;\r\n  defsElement: SVGElement;\r\n  objects: SVGBoardObject[] = [];\r\n  objectsElementMap: Map<SVGBoardObject, BoardObjectSVGElements>;\r\n  top: number;\r\n  left: number;\r\n  bottom: number;\r\n  right: number;\r\n\r\n  /** Drawing contexts - elements to put additional board objects. Similar to layers. */\r\n  contexts: {\r\n    [key: string]: SVGElement;\r\n  } = {};\r\n\r\n  constructor (elem: HTMLElement, config: PartialRecursive<SVGBoardConfig> = {}) {\r\n    super(elem, makeConfig(svgBoardDefaultConfig, config));\r\n\r\n    this.boardElement = document.createElement('div');\r\n    this.boardElement.style.display = 'inline-block';\r\n    this.boardElement.style.position = 'relative';\r\n    this.boardElement.style.verticalAlign = 'middle';\r\n    this.boardElement.style.userSelect = 'none';\r\n    this.element.appendChild(this.boardElement);\r\n\r\n    this.touchArea = document.createElement('div');\r\n    this.touchArea.style.position = 'absolute';\r\n    this.touchArea.style.top = '0';\r\n    this.touchArea.style.left = '0';\r\n    this.touchArea.style.bottom = '0';\r\n    this.touchArea.style.right = '0';\r\n    this.touchArea.style.zIndex = '1';\r\n    this.touchArea.style.borderTop = '#F0E7A7 solid 1px';\r\n    this.touchArea.style.borderRight = '#D1A974 solid 1px';\r\n    this.touchArea.style.borderLeft = '#CCB467 solid 1px';\r\n    this.touchArea.style.borderBottom = '#665926 solid 1px';\r\n    this.boardElement.appendChild(this.touchArea);\r\n\r\n    this.svgElement = document.createElementNS(SVG_NS, 'svg');\r\n    this.svgElement.style.display = 'block';\r\n    this.boardElement.appendChild(this.svgElement);\r\n\r\n    this.defsElement = document.createElementNS(SVG_NS, 'defs');\r\n    this.svgElement.appendChild(this.defsElement);\r\n\r\n    this.setViewport();\r\n    this.resize();\r\n    this.redraw();\r\n  }\r\n\r\n  resize() {\r\n    if (this.config.width && this.config.height) {\r\n      this.boardElement.style.width = '';\r\n      this.svgElement.style.width = `${this.config.width}px`;\r\n      this.svgElement.style.height = `${this.config.height}px`;\r\n    } else if (this.config.width) {\r\n      this.boardElement.style.width = '';\r\n      this.svgElement.style.width = `${this.config.width}px`;\r\n      this.svgElement.style.height = 'auto';\r\n    } else if (this.config.height) {\r\n      this.boardElement.style.width = '';\r\n      this.svgElement.style.width = 'auto';\r\n      this.svgElement.style.height = `${this.config.height}px`;\r\n    } else {\r\n      this.boardElement.style.width = '100%';\r\n      this.svgElement.style.width = '100%';\r\n      this.svgElement.style.height = 'auto';\r\n    }\r\n  }\r\n\r\n  redraw() {\r\n    this.svgElement.style.backgroundColor = this.config.theme.backgroundColor;\r\n\r\n    if (this.config.theme.backgroundImage) {\r\n      this.svgElement.style.backgroundImage = `url('${this.config.theme.backgroundImage}')`;\r\n    } else {\r\n      this.svgElement.style.backgroundImage = '';\r\n    }\r\n\r\n    this.drawGrid();\r\n    this.drawCoordinates();\r\n    this.drawObjects();\r\n  }\r\n\r\n  drawGrid() {\r\n    if (this.contexts[SVG_GRID_MASK]) {\r\n      this.svgElement.removeChild(this.contexts[SVG_GRID_MASK]);\r\n    }\r\n\r\n    if (this.contexts.gridElement) {\r\n      this.svgElement.removeChild(this.contexts.gridElement);\r\n    }\r\n\r\n    // create grid mask\r\n    const { size } = this.config;\r\n    this.contexts[SVG_GRID_MASK] = document.createElementNS(SVG_NS, 'mask');\r\n    this.contexts[SVG_GRID_MASK].id = generateId('mask');\r\n    this.contexts[SVG_GRID_MASK].innerHTML = `<rect x=\"-0.5\" y=\"-0.5\" width=\"${size}\" height=\"${size}\" fill=\"white\" />`;\r\n    this.svgElement.appendChild(this.contexts[SVG_GRID_MASK]);\r\n\r\n    // create grid\r\n    this.contexts.gridElement = createGrid(this.config);\r\n    this.contexts.gridElement.setAttribute('mask', `url(#${this.contexts[SVG_GRID_MASK].id})`);\r\n    this.svgElement.appendChild(this.contexts.gridElement);\r\n  }\r\n\r\n  drawCoordinates() {\r\n    if (this.contexts.coordinatesElement) {\r\n      this.svgElement.removeChild(this.contexts.coordinatesElement);\r\n    }\r\n\r\n    this.contexts.coordinatesElement = createCoordinates(this.config);\r\n    this.contexts.coordinatesElement.style.opacity = this.config.coordinates ? '' : '0';\r\n    this.svgElement.appendChild(this.contexts.coordinatesElement);\r\n  }\r\n\r\n  drawObjects() {\r\n    // remove old shadows layer\r\n    if (this.contexts[SVG_SHADOWS]) {\r\n      this.svgElement.removeChild(this.contexts[SVG_SHADOWS]);\r\n    }\r\n\r\n    // remove old objects layer\r\n    if (this.contexts[SVG_OBJECTS]) {\r\n      this.svgElement.removeChild(this.contexts[SVG_OBJECTS]);\r\n    }\r\n\r\n    // append new shadows layer\r\n    this.contexts[SVG_SHADOWS] = document.createElementNS(SVG_NS, 'g');\r\n    this.svgElement.appendChild(this.contexts[SVG_SHADOWS]);\r\n\r\n    // append new object layer\r\n    this.contexts[SVG_OBJECTS] = document.createElementNS(SVG_NS, 'g');\r\n    this.svgElement.appendChild(this.contexts[SVG_OBJECTS]);\r\n\r\n    // prepare map for objects and add all objects\r\n    this.objectsElementMap = new Map();\r\n    this.objects.forEach(boardObject => this.createObjectElements(boardObject));\r\n  }\r\n\r\n  addObject(boardObject: SVGBoardObject | SVGBoardObject[]) {\r\n    super.addObject(boardObject);\r\n\r\n    if (!Array.isArray(boardObject)) {\r\n      if (this.objectsElementMap.get(boardObject)) {\r\n        // already added - just redraw it\r\n        this.updateObject(boardObject);\r\n        return;\r\n      }\r\n\r\n      this.createObjectElements(boardObject);\r\n    }\r\n  }\r\n\r\n  protected createObjectElements(boardObject: SVGBoardObject) {\r\n    const handler = this.getObjectHandler(boardObject);\r\n\r\n    // create element or elements and add them to the svg\r\n    const elem = handler.createElement(this.config, (def: SVGElement) => this.defsElement.appendChild(def));\r\n    let elements: BoardObjectSVGElements;\r\n\r\n    if (elem instanceof SVGElement) {\r\n      elements = { [SVG_OBJECTS]: elem };\r\n    } else {\r\n      elements = elem;\r\n    }\r\n    this.objectsElementMap.set(boardObject, elements);\r\n    Object.keys(elements).forEach(key => this.contexts[key].appendChild(elements[key]));\r\n\r\n    handler.updateElement(elements, boardObject, this.config);\r\n  }\r\n\r\n  getObjectHandler(boardObject: SVGBoardObject) {\r\n    return 'handler' in boardObject ? boardObject.handler : this.config.theme.drawHandlers[boardObject.type];\r\n  }\r\n\r\n  removeObject(boardObject: SVGBoardObject | SVGBoardObject[]) {\r\n    super.removeObject(boardObject);\r\n\r\n    if (!Array.isArray(boardObject)) {\r\n      const elements = this.objectsElementMap.get(boardObject);\r\n      if (elements) {\r\n        this.objectsElementMap.delete(boardObject);\r\n        Object.keys(elements).forEach(key => this.contexts[key].removeChild(elements[key]));\r\n      }\r\n    }\r\n  }\r\n\r\n  updateObject(boardObject: SVGBoardObject | SVGBoardObject[]) {\r\n    // handling multiple objects\r\n    if (Array.isArray(boardObject)) {\r\n      for (let i = 0; i < boardObject.length; i++) {\r\n        this.updateObject(boardObject[i]);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const elements = this.objectsElementMap.get(boardObject);\r\n\r\n    if (!elements) {\r\n      // updated object isn't on board - ignore, add or warning?\r\n      return;\r\n    }\r\n\r\n    const handler = this.getObjectHandler(boardObject);\r\n    handler.updateElement(elements, boardObject, this.config);\r\n  }\r\n\r\n  setViewport(viewport: BoardViewport = this.config.viewport) {\r\n    super.setViewport(viewport);\r\n\r\n    const { coordinates, theme, size } = this.config;\r\n    const { marginSize, coordinatesTop, coordinatesLeft, coordinatesBottom, coordinatesRight } = theme;\r\n    const { fontSize } = theme.coordinates;\r\n\r\n    this.top = viewport.top - 0.5 - (coordinates && coordinatesTop && !viewport.top ? fontSize : 0) - marginSize;\r\n    this.left = viewport.left - 0.5 - (coordinates && coordinatesLeft && !viewport.left ? fontSize : 0) - marginSize;\r\n    // tslint:disable-next-line:max-line-length\r\n    this.bottom = size - 0.5 - this.top - viewport.bottom + (coordinates && coordinatesBottom && !viewport.bottom ? fontSize : 0) + marginSize;\r\n    // tslint:disable-next-line:max-line-length\r\n    this.right = size - 0.5 - this.left - viewport.right + (coordinates && coordinatesRight && !viewport.right ? fontSize : 0) + marginSize;\r\n    this.svgElement.setAttribute('viewBox', `${this.left} ${this.top} ${this.right} ${this.bottom}`);\r\n  }\r\n\r\n  setSize(size: number = 19) {\r\n    super.setSize(size);\r\n    this.drawGrid();\r\n    this.drawCoordinates();\r\n    this.setViewport();\r\n  }\r\n\r\n  setCoordinates(coordinates: boolean) {\r\n    super.setCoordinates(coordinates);\r\n    this.contexts.coordinatesElement.style.opacity = this.config.coordinates ? '' : '0';\r\n    this.setViewport();\r\n  }\r\n\r\n  on(type: string, callback: (event: UIEvent, point: Point) => void) {\r\n    super.on(type, callback);\r\n    this.registerBoardListener(type);\r\n  }\r\n\r\n  registerBoardListener(type: string) {\r\n    this.touchArea.addEventListener(type, (evt) => {\r\n      if ((evt as any).layerX != null) {\r\n        const pos = this.getRelativeCoordinates((evt as any).layerX, (evt as any).layerY);\r\n        this.emit(type, evt, pos);\r\n      } else {\r\n        this.emit(type, evt);\r\n      }\r\n    });\r\n  }\r\n\r\n  getRelativeCoordinates(absoluteX: number, absoluteY: number) {\r\n    // new hopefully better translation of coordinates\r\n\r\n    const fieldWidth = this.touchArea.offsetWidth / (this.right);\r\n    const fieldHeight = this.touchArea.offsetHeight / (this.bottom);\r\n\r\n    const x = Math.round((absoluteX / fieldWidth + this.left));\r\n    const y = Math.round((absoluteY / fieldHeight + this.top));\r\n\r\n    if (x < 0 || x >= this.config.size || y < 0 || y >= this.config.size) {\r\n      return null;\r\n    }\r\n\r\n    return { x, y };\r\n  }\r\n}\r\n","import { FieldObject } from '../BoardBase';\r\nimport { SVGDrawHandler, SVGCustomObject } from './types';\r\n\r\nexport default class SVGCustomFieldObject extends FieldObject implements SVGCustomObject {\r\n  handler: SVGDrawHandler;\r\n\r\n  constructor(handler: SVGDrawHandler, x = 0, y = 0) {\r\n    super('custom', x, y);\r\n    this.handler = handler;\r\n  }\r\n}\r\n","import { BoardLabelObject } from '../BoardBase';\r\nimport { SVGDrawHandler, SVGCustomObject } from './types';\r\n\r\nexport default class SVGCustomLabelObject extends BoardLabelObject implements SVGCustomObject {\r\n  handler: SVGDrawHandler;\r\n}\r\n","import { SVGBoard } from '../../SVGBoard';\r\nimport {\r\n  FieldObject,\r\n  BoardLabelObject,\r\n  BoardMarkupObject,\r\n  BoardObject,\r\n  BoardLineObject,\r\n  BoardViewport,\r\n} from '../../BoardBase';\r\nimport { Color, Point, Label, Vector } from '../../types';\r\nimport { LifeCycleEvent } from '../../PlayerBase/types';\r\nimport { SVGBoardObject, SVGDrawHandler, SVGBoardTheme } from '../../SVGBoard/types';\r\nimport SVGCustomFieldObject from '../../SVGBoard/SVGCustomFieldObject';\r\nimport SVGCustomLabelObject from '../../SVGBoard/SVGCustomLabelObject';\r\nimport makeConfig, { PartialRecursive } from '../../utils/makeConfig';\r\nimport { Circle, Label as SVGLabel } from '../../SVGBoard/svgDrawHandlers';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\nimport PlayerDOM from '../PlayerDOM';\r\nimport { PropIdent } from '../../SGFParser/sgfTypes';\r\n\r\nconst colorsMap: { [key: string]: Color } = {\r\n  B: Color.BLACK,\r\n  W: Color.WHITE,\r\n};\r\n\r\nexport interface SVGBoardComponentConfig {\r\n  coordinates: boolean;\r\n  currentMoveBlackMark: SVGDrawHandler;\r\n  currentMoveWhiteMark: SVGDrawHandler;\r\n  variationDrawHandler: SVGDrawHandler;\r\n  starPoints?: {\r\n    [size: number]: Point[];\r\n  };\r\n  coordinateLabelsX?: string | (string | number)[];\r\n  coordinateLabelsY?: string | (string | number)[];\r\n  highlightCurrentMove: boolean;\r\n  showVariations: boolean;\r\n  showCurrentVariations: boolean;\r\n  theme?: PartialRecursive<SVGBoardTheme>;\r\n}\r\n\r\nexport const defaultSVGBoardComponentConfig: SVGBoardComponentConfig = {\r\n  coordinates: true,\r\n  currentMoveBlackMark: new Circle({ color: 'rgba(255,255,255,0.8)', fillColor:'rgba(0,0,0,0)' }),\r\n  currentMoveWhiteMark: new Circle({ color: 'rgba(0,0,0,0.8)', fillColor:'rgba(0,0,0,0)' }),\r\n  variationDrawHandler: new SVGLabel({ color: '#33f' }),\r\n  highlightCurrentMove: true,\r\n  showVariations: true,\r\n  showCurrentVariations: false,\r\n};\r\n\r\nexport default class SVGBoardComponent implements PlayerDOMComponent {\r\n  // Underlying SVG board object\r\n  board: SVGBoard;\r\n  config: SVGBoardComponentConfig;\r\n  element: HTMLElement;\r\n  player: PlayerDOM;\r\n\r\n  // Current board objects for stones - should match the position object of the game\r\n  stoneBoardsObjects: FieldObject[];\r\n\r\n  // Temporary board object, will be removed after each node update\r\n  temporaryBoardObjects: SVGBoardObject[];\r\n\r\n  // Board viewport stack, for efficient reverting of board viewport\r\n  viewportStack: BoardViewport[];\r\n\r\n  boardMouseX: number;\r\n  boardMouseY: number;\r\n\r\n  constructor(config: PartialRecursive<SVGBoardComponentConfig> = {}) {\r\n    this.config = makeConfig(defaultSVGBoardComponentConfig, config);\r\n    this.viewportStack = [];\r\n\r\n    this.applyNodeChanges = this.applyNodeChanges.bind(this);\r\n    this.clearNodeChanges = this.clearNodeChanges.bind(this);\r\n    this.applyMarkupProperty = this.applyMarkupProperty.bind(this);\r\n    this.applyLabelMarkupProperty = this.applyLabelMarkupProperty.bind(this);\r\n    this.applyLineMarkupProperty = this.applyLineMarkupProperty.bind(this);\r\n    this.applyViewportProperty = this.applyViewportProperty.bind(this);\r\n    this.clearViewportProperty = this.clearViewportProperty.bind(this);\r\n    this.applyMoveProperty = this.applyMoveProperty.bind(this);\r\n    this.addTemporaryBoardObject = this.addTemporaryBoardObject.bind(this);\r\n    this.removeTemporaryBoardObject = this.removeTemporaryBoardObject.bind(this);\r\n    this.updateTemporaryBoardObject = this.updateTemporaryBoardObject.bind(this);\r\n    this.setCoordinates = this.setCoordinates.bind(this);\r\n\r\n    this.createDOM();\r\n  }\r\n\r\n  createDOM() {\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'wgo-player__board';\r\n\r\n    this.stoneBoardsObjects = [];\r\n    this.temporaryBoardObjects = [];\r\n\r\n    this.board = new SVGBoard(this.element, {\r\n      coordinates: this.config.coordinates,\r\n      starPoints: this.config.starPoints,\r\n      coordinateLabelsX: this.config.coordinateLabelsX,\r\n      coordinateLabelsY: this.config.coordinateLabelsY,\r\n      theme: this.config.theme,\r\n    });\r\n\r\n    this.board.on('click', (event, point) => {\r\n      this.handleBoardClick(point);\r\n    });\r\n\r\n    this.board.on('mousemove', (event, point) => {\r\n      if (!point) {\r\n        if (this.boardMouseX != null) {\r\n          this.boardMouseX = null;\r\n          this.boardMouseY = null;\r\n          this.handleBoardMouseOut();\r\n        }\r\n        return;\r\n      }\r\n      if (point.x !== this.boardMouseX || point.y !== this.boardMouseY) {\r\n        this.boardMouseX = point.x;\r\n        this.boardMouseY = point.y;\r\n        this.handleBoardMouseMove(point);\r\n      }\r\n    });\r\n\r\n    this.board.on('mouseout', (event, point) => {\r\n      if (!point && this.boardMouseX != null) {\r\n        this.boardMouseX = null;\r\n        this.boardMouseY = null;\r\n        this.handleBoardMouseOut();\r\n        return;\r\n      }\r\n    });\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n\r\n    // add general node listeners - for setting stones on board based on position\r\n    this.player.on('applyNodeChanges', this.applyNodeChanges);\r\n    this.player.on('clearNodeChanges', this.clearNodeChanges);\r\n\r\n    // temporary board markup listeners - add\r\n    this.player.on('applyNodeChanges.CR', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.TR', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.SQ', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.SL', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.MA', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.DD', this.applyMarkupProperty);\r\n    this.player.on('applyNodeChanges.LB', this.applyLabelMarkupProperty);\r\n    this.player.on('applyNodeChanges.LN', this.applyLineMarkupProperty);\r\n    this.player.on('applyNodeChanges.AR', this.applyLineMarkupProperty);\r\n\r\n    // viewport SGF property listeners\r\n    this.player.on('applyGameChanges.VW', this.applyViewportProperty);\r\n    this.player.on('clearGameChanges.VW', this.clearViewportProperty);\r\n\r\n    // add current move marker\r\n    this.player.on('applyNodeChanges.B', this.applyMoveProperty);\r\n    this.player.on('applyNodeChanges.W', this.applyMoveProperty);\r\n\r\n    this.player.on('board.addTemporaryObject', this.addTemporaryBoardObject);\r\n    this.player.on('board.removeTemporaryObject', this.removeTemporaryBoardObject);\r\n    this.player.on('board.updateTemporaryObject', this.updateTemporaryBoardObject);\r\n    this.player.on('board.setCoordinates', this.setCoordinates);\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off('applyNodeChanges', this.applyNodeChanges);\r\n    this.player.off('clearNodeChanges', this.clearNodeChanges);\r\n\r\n    this.player.off('applyNodeChanges', this.applyNodeChanges);\r\n    this.player.off('clearNodeChanges', this.clearNodeChanges);\r\n\r\n    this.player.off('applyNodeChanges.CR', this.applyMarkupProperty);\r\n    this.player.off('applyNodeChanges.TR', this.applyMarkupProperty);\r\n    this.player.off('applyNodeChanges.SQ', this.applyMarkupProperty);\r\n    this.player.off('applyNodeChanges.SL', this.applyMarkupProperty);\r\n    this.player.off('applyNodeChanges.MA', this.applyMarkupProperty);\r\n    this.player.off('applyNodeChanges.DD', this.applyMarkupProperty);\r\n\r\n    this.player.off('applyNodeChanges.LB', this.applyLabelMarkupProperty);\r\n    this.player.off('applyNodeChanges.LN', this.applyLineMarkupProperty);\r\n    this.player.off('applyNodeChanges.AR', this.applyLineMarkupProperty);\r\n\r\n    this.player.off('applyGameChanges.VW', this.applyViewportProperty);\r\n    this.player.off('clearGameChanges.VW', this.clearViewportProperty);\r\n\r\n    this.player.off('applyNodeChanges.B', this.applyMoveProperty);\r\n    this.player.off('applyNodeChanges.W', this.applyMoveProperty);\r\n\r\n    this.player.off('board.addTemporaryObject', this.addTemporaryBoardObject);\r\n    this.player.off('board.removeTemporaryObject', this.removeTemporaryBoardObject);\r\n    this.player.off('board.updateTemporaryObject', this.updateTemporaryBoardObject);\r\n    this.player.off('board.setCoordinates', this.setCoordinates);\r\n\r\n    this.player = null;\r\n  }\r\n\r\n  protected updateStones() {\r\n    // Remove missing stones in current position\r\n    this.stoneBoardsObjects = this.stoneBoardsObjects.filter((boardObject) => {\r\n      if (this.player.game.getStone(boardObject.x, boardObject.y) !== colorsMap[boardObject.type as string]) {\r\n        this.board.removeObject(boardObject);\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n\r\n    // Add new stones from current position\r\n    const position = this.player.game.position;\r\n\r\n    for (let x = 0; x < position.size; x++) {\r\n      for (let y = 0; y < position.size; y++) {\r\n        const c = position.get(x, y);\r\n        if (c && !this.stoneBoardsObjects.some(\r\n          boardObject => boardObject.x === x && boardObject.y === y && c === colorsMap[boardObject.type as string],\r\n        )) {\r\n          const boardObject = new FieldObject(c === Color.B ? 'B' : 'W', x, y);\r\n          this.board.addObject(boardObject);\r\n          this.stoneBoardsObjects.push(boardObject);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  protected addVariationMarkup() {\r\n    const moves = this.getVariations();\r\n\r\n    if (moves.length > 1) {\r\n      moves.forEach((move, i) => {\r\n        if (move) {\r\n          const obj = new SVGCustomLabelObject(String.fromCodePoint(65 + i), move.x, move.y);\r\n          obj.handler = this.config.variationDrawHandler;\r\n          this.addTemporaryBoardObject(obj);\r\n        }\r\n      });\r\n      if (this.boardMouseX != null) {\r\n        this.handleVariationCursor(this.boardMouseX, this.boardMouseY, moves);\r\n      }\r\n    }\r\n  }\r\n\r\n  protected clearTemporaryBoardObjects() {\r\n    if (this.temporaryBoardObjects.length) {\r\n      this.board.removeObject(this.temporaryBoardObjects);\r\n      this.temporaryBoardObjects = [];\r\n    }\r\n  }\r\n\r\n  protected handleBoardClick(point: Point) {\r\n    this.player.emit('board.click', point);\r\n\r\n    const moves = this.getVariations();\r\n    if (moves.length > 1) {\r\n      const ind = moves.findIndex(move => move && move.x === point.x && move.y === point.y);\r\n\r\n      if (ind >= 0) {\r\n        if (this.shouldShowCurrentVariations()) {\r\n          this.player.previous();\r\n          this.player.next(ind);\r\n        } else {\r\n          this.player.next(ind);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  protected handleBoardMouseMove(point: Point) {\r\n    this.player.emit('board.mouseMove', point);\r\n    this.handleVariationCursor(point.x, point.y, this.getVariations());\r\n  }\r\n\r\n  protected handleBoardMouseOut() {\r\n    this.player.emit('board.mouseOut');\r\n    this.removeVariationCursor();\r\n  }\r\n\r\n  private handleVariationCursor(x: number, y: number, moves: Point[]) {\r\n    if (moves.length > 1) {\r\n      const ind = moves.findIndex(move => move && move.x === x && move.y === y);\r\n\r\n      if (ind >= 0) {\r\n        this.element.style.cursor = 'pointer';\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.removeVariationCursor();\r\n  }\r\n\r\n  private removeVariationCursor() {\r\n    if (this.element.style.cursor) {\r\n      this.element.style.cursor = '';\r\n    }\r\n  }\r\n\r\n  private applyNodeChanges() {\r\n    this.updateStones();\r\n    this.addVariationMarkup();\r\n  }\r\n\r\n  private clearNodeChanges() {\r\n    this.clearTemporaryBoardObjects();\r\n    this.removeVariationCursor();\r\n  }\r\n\r\n  private applyMarkupProperty(event: LifeCycleEvent<Point[]>) {\r\n    event.value.forEach((value) => {\r\n      // add markup\r\n      const boardMarkup = new BoardMarkupObject(\r\n        event.propIdent,\r\n        value.x,\r\n        value.y,\r\n        this.player.game.getStone(value.x, value.y),\r\n      );\r\n      boardMarkup.zIndex = 10;\r\n      this.addTemporaryBoardObject(boardMarkup);\r\n    });\r\n  }\r\n\r\n  private applyLabelMarkupProperty(event: LifeCycleEvent<Label[]>) {\r\n    event.value.forEach((value) => {\r\n      // add markup\r\n      const boardMarkup = new BoardLabelObject(\r\n        value.text,\r\n        value.x,\r\n        value.y,\r\n        this.player.game.getStone(value.x, value.y),\r\n      );\r\n      boardMarkup.zIndex = 10;\r\n      this.addTemporaryBoardObject(boardMarkup);\r\n    });\r\n  }\r\n\r\n  private applyLineMarkupProperty(event: LifeCycleEvent<Vector[]>) {\r\n    event.value.forEach((value) => {\r\n      // add markup\r\n      const boardMarkup = new BoardLineObject(event.propIdent, value[0], value[1]);\r\n      boardMarkup.zIndex = 10;\r\n      this.addTemporaryBoardObject(boardMarkup);\r\n    });\r\n  }\r\n\r\n  private applyViewportProperty(event: LifeCycleEvent<Vector>) {\r\n    const currentViewport = this.board.getViewport();\r\n    this.viewportStack.push(currentViewport);\r\n\r\n    if (event.value) {\r\n      const minX = Math.min(event.value[0].x, event.value[1].x);\r\n      const minY = Math.min(event.value[0].y, event.value[1].y);\r\n      const maxX = Math.max(event.value[0].x, event.value[1].x);\r\n      const maxY = Math.max(event.value[0].y, event.value[1].y);\r\n\r\n      this.board.setViewport({\r\n        left: minX,\r\n        top: minY,\r\n        right: this.board.getSize() - maxX - 1,\r\n        bottom: this.board.getSize() - maxY - 1,\r\n      });\r\n    } else {\r\n      this.board.setViewport({\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        left: 0,\r\n      });\r\n    }\r\n  }\r\n\r\n  private clearViewportProperty() {\r\n    const previousViewport = this.viewportStack.pop();\r\n    if (previousViewport) {\r\n      this.board.setViewport(previousViewport);\r\n    }\r\n  }\r\n\r\n  private applyMoveProperty(event: LifeCycleEvent<Point>) {\r\n    if (this.config.highlightCurrentMove) {\r\n      if (!event.value) {\r\n        // no markup when pass\r\n        return;\r\n      }\r\n      if (isThereMarkup(event.value, this.player.currentNode.properties)) {\r\n        // don't show current move markup, when there is markup in kifu node\r\n        return;\r\n      }\r\n\r\n      if (this.getVariations().length > 1 && this.shouldShowCurrentVariations()) {\r\n        // don't show current move markup, if there is multiple variations and \"show current variations\" style set\r\n        return;\r\n      }\r\n\r\n      // add current move mark\r\n      const boardMarkup = new SVGCustomFieldObject(\r\n        event.propIdent === 'B' ? this.config.currentMoveBlackMark : this.config.currentMoveWhiteMark,\r\n        event.value.x,\r\n        event.value.y,\r\n      );\r\n      boardMarkup.zIndex = 10;\r\n      this.addTemporaryBoardObject(boardMarkup);\r\n    }\r\n  }\r\n\r\n  addTemporaryBoardObject(obj: BoardObject) {\r\n    this.temporaryBoardObjects.push(obj);\r\n    this.board.addObject(obj);\r\n  }\r\n\r\n  removeTemporaryBoardObject(obj: FieldObject) {\r\n    this.temporaryBoardObjects = this.temporaryBoardObjects.filter(o => o !== obj);\r\n    this.board.removeObject(obj);\r\n  }\r\n\r\n  updateTemporaryBoardObject(obj: FieldObject) {\r\n    this.board.updateObject(obj);\r\n  }\r\n\r\n  setCoordinates(b: boolean) {\r\n    this.config.coordinates = b;\r\n    this.board.setCoordinates(b);\r\n  }\r\n\r\n  getVariations(): Point[] {\r\n    if (this.shouldShowVariations()) {\r\n      if (this.shouldShowCurrentVariations()) {\r\n        if (this.player.currentNode.parent) {\r\n          return this.player.currentNode.parent.children.map(node => node.getProperty('B') || node.getProperty('W'));\r\n        }\r\n      } else {\r\n        return this.player.currentNode.children.map(node => node.getProperty('B') || node.getProperty('W'));\r\n      }\r\n    }\r\n    return [];\r\n  }\r\n\r\n  shouldShowVariations() {\r\n    // look in kifu, whether to show variation markup\r\n    const st = this.player.rootNode.getProperty(PropIdent.VARIATIONS_STYLE);\r\n    if (st != null) {\r\n      return !(st & 2);\r\n    }\r\n\r\n    // otherwise use configuration value\r\n    return this.config.showVariations;\r\n  }\r\n\r\n  shouldShowCurrentVariations() {\r\n    // in edit mode not possible\r\n    // if (this.editMode) {\r\n    //   return false;\r\n    // }\r\n\r\n    // look at variation style in kifu\r\n    const st = this.player.rootNode.getProperty(PropIdent.VARIATIONS_STYLE);\r\n    if (st != null) {\r\n      return !!(st & 1);\r\n    }\r\n\r\n    // or use variation style from configuration\r\n    return this.config.showCurrentVariations;\r\n  }\r\n}\r\n\r\nfunction samePoint(p1: Point, p2: any) {\r\n  return p2 && p1.x === p2.x && p1.y === p2.y;\r\n}\r\n\r\nfunction isThereMarkup(field: Point, properties: { [key: string]: any }) {\r\n  const propIdents = Object.keys(properties);\r\n\r\n  for (let i = 0; i < propIdents.length; i++) {\r\n    if (propIdents[i] === 'B' || propIdents[i] === 'W') {\r\n      continue;\r\n    }\r\n\r\n    const value = properties[propIdents[i]];\r\n    if (Array.isArray(value)) {\r\n      for (let j = 0; j < value.length; j++) {\r\n        if (samePoint(field, value[j])) {\r\n          return true;\r\n        }\r\n      }\r\n    } else if (samePoint(field, value)) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n","import { BoardMarkupObject } from '../../BoardBase';\r\nimport makeConfig, { PartialRecursive } from '../../utils/makeConfig';\r\nimport PlayerDOM from '../PlayerDOM';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\n\r\nexport interface CommentBoxConfig {\r\n  formatMoves: boolean;\r\n  formatNicks: boolean;\r\n}\r\n\r\nexport const commentBoxDefaultConfig = {\r\n  formatMoves: true,\r\n  formatNicks: true,\r\n};\r\n\r\nexport default class CommentsBox implements PlayerDOMComponent {\r\n  element: HTMLElement;\r\n  commentsElement: HTMLElement;\r\n  player: PlayerDOM;\r\n  config: CommentBoxConfig;\r\n\r\n  constructor(config: PartialRecursive<CommentBoxConfig> = {}) {\r\n    this.config = makeConfig(commentBoxDefaultConfig, config);\r\n    this.setComments = this.setComments.bind(this);\r\n    this.clearComments = this.clearComments.bind(this);\r\n\r\n    // create HTML\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'wgo-player__box wgo-player__box--content wgo-player__box--stretch';\r\n\r\n    const title = document.createElement('div');\r\n    title.innerHTML = 'Comments';\r\n    title.className = 'wgo-player__box__title';\r\n    this.element.appendChild(title);\r\n\r\n    this.commentsElement = document.createElement('div');\r\n    this.commentsElement.className = 'wgo-player__box__content';\r\n    this.element.appendChild(this.commentsElement);\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n\r\n    this.player.on('applyNodeChanges.C', this.setComments);\r\n    this.player.on('clearNodeChanges.C', this.clearComments);\r\n\r\n    if (this.player.currentNode) {\r\n      const comment = this.player.currentNode.getProperty('C');\r\n      if (comment) {\r\n        this.setComments({ value: comment });\r\n      }\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off('applyNodeChanges.C', this.setComments);\r\n    this.player.off('clearNodeChanges.C', this.clearComments);\r\n    this.player = null;\r\n  }\r\n\r\n  setComments(event: { value: string }) {\r\n    this.commentsElement.innerHTML = this.formatComment(event.value);\r\n\r\n    if (this.config.formatMoves) {\r\n      [].forEach.call(this.commentsElement.querySelectorAll('.wgo-player__move-link'), (link: HTMLElement) => {\r\n        const point = coordinatesToPoint(link.textContent, this.player.game.size);\r\n        const boardObject = new BoardMarkupObject('MA', point.x, point.y, this.player.game.getStone(point.x, point.y));\r\n        boardObject.zIndex = 20;\r\n\r\n        link.addEventListener('mouseenter', () => {\r\n          this.player.emit('board.addTemporaryObject', boardObject);\r\n        });\r\n\r\n        link.addEventListener('mouseleave', () => {\r\n          this.player.emit('board.removeTemporaryObject', boardObject);\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  clearComments() {\r\n    this.commentsElement.textContent = '';\r\n  }\r\n\r\n  formatComment(text: string) {\r\n    // remove HTML tags from text\r\n    let formattedText = text.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n\r\n    // divide text into paragraphs\r\n    formattedText = `<p>${formattedText.replace(/\\n/g, '</p><p>')}</p>`;\r\n\r\n    if (this.config.formatNicks) {\r\n      formattedText = formattedText.replace(/(<p>)([^:]{3,}:)\\s/g, '<p><span class=\"wgo-player__nick\">$2</span> ');\r\n    }\r\n\r\n    if (this.config.formatMoves) {\r\n      // tslint:disable-next-line:max-line-length\r\n      formattedText = formattedText.replace(/\\b[a-zA-Z]1?\\d\\b/g, '<a href=\"javascript:void(0)\" class=\"wgo-player__move-link\">$&</a>');\r\n    }\r\n\r\n    return formattedText;\r\n  }\r\n}\r\n\r\nfunction coordinatesToPoint(coordinates: string, boardSize: number) {\r\n  const x = coordinates.toLowerCase().charCodeAt(0) - 97; // char code of \"a\"\r\n  const y = parseInt(coordinates.substr(1), 10) - 1;\r\n  return { x, y: boardSize - 1 - y };\r\n}\r\n","import makeConfig, { PartialRecursive } from '../../utils/makeConfig';\r\nimport PlayerDOM from '../PlayerDOM';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\n\r\nexport interface GameInfoBoxConfig {\r\n  gameInfoProperties: { [key: string]: string };\r\n  stretch: boolean;\r\n}\r\n\r\nexport const gameInfoBoxDefaultConfig = {\r\n  gameInfoProperties: {\r\n    DT: 'Date',\r\n    KM: 'Komi',\r\n    HA: 'Handicap',\r\n    AN: 'Annotations',\r\n    CP: 'Copyright',\r\n    GC: 'Game comments',\r\n    GN: 'Game name',\r\n    ON: 'Fuseki',\r\n    OT: 'Overtime',\r\n    TM: 'Basic time',\r\n    RE: 'Result',\r\n    RO: 'Round',\r\n    RU: 'Rules',\r\n    US: 'Recorder',\r\n    PC: 'Place',\r\n    EV: 'Event',\r\n    SO: 'Source',\r\n  },\r\n  stretch: false,\r\n};\r\n\r\nexport default class GameInfoBox implements PlayerDOMComponent {\r\n  element: HTMLElement;\r\n  infoTable: HTMLElement;\r\n  player: PlayerDOM;\r\n  config: GameInfoBoxConfig;\r\n\r\n  constructor(config: PartialRecursive<GameInfoBoxConfig> = {}) {\r\n    this.config = makeConfig(gameInfoBoxDefaultConfig, config);\r\n    this.printInfo = this.printInfo.bind(this);\r\n\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'wgo-player__box wgo-player__box--content';\r\n\r\n    if (this.config.stretch) {\r\n      this.element.className = `${this.element.className} wgo-player__box--stretch`;\r\n    }\r\n\r\n    const title = document.createElement('div');\r\n    title.innerHTML = 'Game information';\r\n    title.className = 'wgo-player__box__title';\r\n    this.element.appendChild(title);\r\n\r\n    this.infoTable = document.createElement('table');\r\n    this.infoTable.className = 'wgo-player__box__game-info';\r\n    this.element.appendChild(this.infoTable);\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n    this.player.on('beforeInit', this.printInfo);\r\n    this.printInfo();\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off('beforeInit', this.printInfo);\r\n    this.player = null;\r\n  }\r\n\r\n  addInfo(propIdent: string, value: string) {\r\n    const row = document.createElement('tr');\r\n    row.dataset.propIdent = propIdent;\r\n    this.infoTable.appendChild(row);\r\n\r\n    const label = document.createElement('th');\r\n    label.textContent = this.config.gameInfoProperties[propIdent];\r\n    row.appendChild(label);\r\n\r\n    const valueElement = document.createElement('td');\r\n    valueElement.textContent = value;\r\n    row.appendChild(valueElement);\r\n  }\r\n\r\n  removeInfo(propIdent: string) {\r\n    const elem = this.infoTable.querySelector(`[data-id='${propIdent}']`);\r\n    this.infoTable.removeChild(elem);\r\n  }\r\n\r\n  printInfo() {\r\n    this.infoTable.innerHTML = '';\r\n    if (this.player.rootNode) {\r\n      this.player.rootNode.forEachProperty((propIdent, value) => {\r\n        if (this.config.gameInfoProperties[propIdent]) {\r\n          this.addInfo(propIdent, value);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { FieldObject } from '../../BoardBase';\r\nimport KifuNode, { Path } from '../../kifu/KifuNode';\r\nimport { PropIdent } from '../../SGFParser/sgfTypes';\r\nimport { Color, Point } from '../../types';\r\nimport makeConfig, { PartialRecursive } from '../../utils/makeConfig';\r\nimport PlayerBase from '../PlayerBase';\r\nimport PlayerPlugin from '../PlayerPlugin';\r\n\r\ninterface EditModeConfig {\r\n  /**\r\n   * Set true, if edit mode should be enabled during player initialization.\r\n   * Default value: `false`\r\n   */\r\n  enabled: boolean;\r\n\r\n  /**\r\n   * Set true, to show variation markup during edit mode. This overrides SGF and player config.\r\n   * Default value: `true`\r\n   */\r\n  showVariations: boolean;\r\n}\r\n\r\ninterface GameState {\r\n  rootNode: KifuNode;\r\n  path: Path;\r\n}\r\n\r\nconst defaultEditModeConfig = {\r\n  enabled: false,\r\n  showVariations: true,\r\n};\r\n\r\n/**\r\n * Edit mode plugin. It allows to edit game kifu without changing it - when edit mode is disabled\r\n * all changes are reverted. It provides event `editMode.change` to enable/disable edit mode.\r\n * It contains integration with board via these events:\r\n * - board.updateTemporaryObject\r\n * - board.addTemporaryObject\r\n * - board.removeTemporaryObject\r\n * - board.mouseMove\r\n * - board.mouseOut\r\n * - board.click\r\n */\r\nexport default class EditMode implements PlayerPlugin {\r\n  config: EditModeConfig;\r\n  player: PlayerBase;\r\n\r\n  private gameStateStack: GameState[] = [];\r\n\r\n  private _boardMouseMoveEvent: Function;\r\n  private _boardMouseOutEvent: Function;\r\n  private _boardClickEvent: Function;\r\n  private _nodeChange: Function;\r\n\r\n  constructor(config: PartialRecursive<EditModeConfig> = {}) {\r\n    this.config = makeConfig(defaultEditModeConfig, config);\r\n  }\r\n\r\n  apply(player: PlayerBase) {\r\n    if (this.player) {\r\n      throw new Error('This plugin instance has already been applied to a player object.');\r\n    }\r\n\r\n    this.player = player;\r\n    this.player.on('editMode.change', this.handleChange);\r\n\r\n    if (this.config.enabled) {\r\n      this.enable();\r\n    }\r\n  }\r\n\r\n  /*public destroy() {\r\n    this.player.off('editMode.change', this.handleChange);\r\n  }*/\r\n\r\n  /**\r\n   * Enable/disable edit mode. Event `editMode.change` is triggered.\r\n   *\r\n   * @param value\r\n   */\r\n  setEnabled(value: boolean) {\r\n    if (value !== this.config.enabled) {\r\n      this.player.emit('editMode.change', value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Play move if edit mode is enabled. This move will be discarded, when edit mode is disabled.\r\n   *\r\n   * @param point\r\n   */\r\n  play(point: Point) {\r\n    if (!this.config.enabled) {\r\n      return;\r\n    }\r\n\r\n    // check, whether some of the next node contains this move\r\n    for (let i = 0; i < this.player.currentNode.children.length; i++) {\r\n      const childNode = this.player.currentNode.children[i];\r\n      const move = childNode.getProperty('B') || childNode.getProperty('W');\r\n      if (move.x === point.x && move.y === point.y) {\r\n        this.player.next(i);\r\n        return;\r\n      }\r\n    }\r\n\r\n    // otherwise play if valid\r\n    if (this.player.game.isValid(point.x, point.y)) {\r\n      this.player.play(point.x, point.y);\r\n    }\r\n  }\r\n\r\n  private handleChange = (value: boolean) => {\r\n    if (value && !this.config.enabled) {\r\n      this.enable();\r\n    } else if (!value && this.config.enabled) {\r\n      this.disable();\r\n    }\r\n  }\r\n\r\n  private enable() {\r\n    this.saveGameState();\r\n    if (this.config.showVariations) {\r\n      this.player.rootNode.setProperty(PropIdent.VARIATIONS_STYLE, 0);\r\n    } else {\r\n      this.player.rootNode.setProperty(PropIdent.VARIATIONS_STYLE, 2);\r\n    }\r\n    this.config.enabled = true;\r\n\r\n    let lastX = -1;\r\n    let lastY = -1;\r\n\r\n    const blackStone = new FieldObject('B');\r\n    blackStone.opacity = 0.35;\r\n\r\n    const whiteStone = new FieldObject('W');\r\n    whiteStone.opacity = 0.35;\r\n\r\n    let addedStone: FieldObject = null;\r\n\r\n    this._boardMouseMoveEvent = (p: Point) => {\r\n      if (lastX !== p.x || lastY !== p.y) {\r\n        if (this.player.game.isValid(p.x, p.y)) {\r\n          const boardObject = this.player.game.turn === Color.BLACK ? blackStone : whiteStone;\r\n          boardObject.setPosition(p.x, p.y);\r\n\r\n          if (addedStone) {\r\n            this.player.emit('board.updateTemporaryObject', boardObject);\r\n          } else {\r\n            this.player.emit('board.addTemporaryObject', boardObject);\r\n            addedStone = boardObject;\r\n          }\r\n\r\n        } else {\r\n          this._boardMouseOutEvent();\r\n        }\r\n        lastX = p.x;\r\n        lastY = p.y;\r\n      }\r\n    };\r\n\r\n    this._boardMouseOutEvent = () => {\r\n      if (addedStone) {\r\n        this.player.emit('board.removeTemporaryObject', addedStone);\r\n        addedStone = null;\r\n      }\r\n      lastX = -1;\r\n      lastY = -1;\r\n    };\r\n\r\n    this._boardClickEvent = (p: Point) => {\r\n      this._boardMouseOutEvent();\r\n\r\n      if (p == null) {\r\n        return;\r\n      }\r\n\r\n      this.play(p);\r\n    };\r\n\r\n    this._nodeChange = () => {\r\n      const current = { x: lastX, y: lastY };\r\n      this._boardMouseOutEvent();\r\n      this._boardMouseMoveEvent(current);\r\n    };\r\n\r\n    this.player.on('board.mouseMove', this._boardMouseMoveEvent);\r\n    this.player.on('board.mouseOut', this._boardMouseOutEvent);\r\n    this.player.on('board.click', this._boardClickEvent);\r\n\r\n    this.player.on('applyNodeChanges', this._nodeChange);\r\n  }\r\n\r\n  private disable() {\r\n    this.player.off('board.mouseMove', this._boardMouseMoveEvent);\r\n    this.player.off('board.mouseOut', this._boardMouseOutEvent);\r\n    this.player.off('board.click', this._boardClickEvent);\r\n\r\n    this.player.off('applyNodeChanges', this._nodeChange);\r\n\r\n    this.config.enabled = false;\r\n    this.restoreGameState();\r\n  }\r\n\r\n  /**\r\n   * Saves current player game state - Kifu and path object.\r\n   */\r\n  private saveGameState() {\r\n    this.gameStateStack.push({\r\n      rootNode: this.player.rootNode.cloneNode(),\r\n      path: this.player.getCurrentPath(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Restores player from previously saved state.\r\n   */\r\n  private restoreGameState() {\r\n    const lastState = this.gameStateStack.pop();\r\n    if (lastState) {\r\n      // revert all node changes\r\n      this.player.first();\r\n\r\n      // load stored kifu\r\n      this.player.loadKifu(lastState.rootNode);\r\n\r\n      // go to stored path\r\n      this.player.goTo(lastState.path);\r\n    }\r\n  }\r\n}\r\n","import PlayerDOM from '../PlayerDOM';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\n\r\nexport default class Container implements PlayerDOMComponent {\r\n  element: HTMLElement;\r\n  children: PlayerDOMComponent[];\r\n  direction: string;\r\n\r\n  constructor(direction: string, children: PlayerDOMComponent[] = []) {\r\n    this.direction = direction;\r\n    this.children = children;\r\n\r\n    // create HTML\r\n    this.element = document.createElement('div');\r\n    this.element.className = `wgo-player__container wgo-player__container--${this.direction}`;\r\n    this.children.forEach(child => this.element.appendChild(child.element));\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.children.forEach(child => child.create(player));\r\n  }\r\n\r\n  destroy() {\r\n    this.children.forEach(child => typeof child.destroy === 'function' && child.destroy());\r\n  }\r\n}\r\n","import { SVGBoardComponent } from '.';\r\nimport { PlayerBase } from '../../PlayerBase';\r\nimport { EditMode } from '../../PlayerBase/plugins';\r\nimport { PropIdent } from '../../SGFParser/sgfTypes';\r\nimport makeConfig, { PartialRecursive } from '../../utils/makeConfig';\r\nimport PlayerDOM from '../PlayerDOM';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\n\r\ninterface MenuItem {\r\n  /** Title of the menu item. */\r\n  name: string;\r\n\r\n  /** If true, there can be check state of the menu item. */\r\n  checkable?: boolean;\r\n\r\n  /** Function executed upon click. If checkable, should return new check state. */\r\n  handleClick(): boolean | void;\r\n\r\n  /** If checkable, function which return initial check state. */\r\n  defaultChecked?(): boolean;\r\n}\r\n\r\ninterface ControlPanelConfig {\r\n  menuItems: MenuItem[];\r\n}\r\n\r\nconst defaultConfig: ControlPanelConfig = {\r\n  menuItems: [],\r\n};\r\n\r\nexport default class ControlPanel implements PlayerDOMComponent {\r\n  element: HTMLElement;\r\n  player: PlayerDOM;\r\n  moveNumber: HTMLInputElement;\r\n  first: HTMLButtonElement;\r\n  previous: HTMLButtonElement;\r\n  next: HTMLButtonElement;\r\n  last: HTMLButtonElement;\r\n  config: ControlPanelConfig;\r\n\r\n  constructor(config: PartialRecursive<ControlPanelConfig> = {}) {\r\n    this.config = makeConfig(defaultConfig, config);\r\n    this.update = this.update.bind(this);\r\n\r\n    this.createDOM();\r\n  }\r\n\r\n  createDOM() {\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'wgo-player__control-panel';\r\n\r\n    const buttonGroup = document.createElement('form');\r\n    buttonGroup.className = 'wgo-player__button-group';\r\n    this.element.appendChild(buttonGroup);\r\n    buttonGroup.addEventListener('submit', (e) => {\r\n      e.preventDefault();\r\n      this.player.goTo(parseInt(this.moveNumber.value, 10));\r\n    });\r\n\r\n    this.first = document.createElement('button');\r\n    this.first.type = 'button';\r\n    this.first.className = 'wgo-player__button';\r\n    this.first.innerHTML = '<span class=\"wgo-player__icon-to-end wgo-player__icon--reverse\"></span>';\r\n    this.first.addEventListener('click', () => this.player.first());\r\n    buttonGroup.appendChild(this.first);\r\n\r\n    this.previous = document.createElement('button');\r\n    this.previous.type = 'button';\r\n    this.previous.className = 'wgo-player__button';\r\n    this.previous.innerHTML = '<span class=\"wgo-player__icon-play wgo-player__icon--reverse\"></span>';\r\n    this.previous.addEventListener('click', () => this.player.previous());\r\n    buttonGroup.appendChild(this.previous);\r\n\r\n    this.moveNumber = document.createElement('input');\r\n    this.moveNumber.className = 'wgo-player__button wgo-player__move-number';\r\n    this.moveNumber.value = '0';\r\n    this.moveNumber.addEventListener('blur', (e) => {\r\n      this.player.goTo(parseInt(this.moveNumber.value, 10));\r\n    });\r\n    buttonGroup.appendChild(this.moveNumber);\r\n\r\n    this.next = document.createElement('button');\r\n    this.next.type = 'button';\r\n    this.next.className = 'wgo-player__button';\r\n    this.next.innerHTML = '<span class=\"wgo-player__icon-play\"></span>';\r\n    this.next.addEventListener('click', () => this.player.next());\r\n    buttonGroup.appendChild(this.next);\r\n\r\n    this.last = document.createElement('button');\r\n    this.last.type = 'button';\r\n    this.last.className = 'wgo-player__button';\r\n    this.last.innerHTML = '<span class=\"wgo-player__icon-to-end\"></span>';\r\n    this.last.addEventListener('click', () => this.player.last());\r\n    buttonGroup.appendChild(this.last);\r\n\r\n    if (this.config.menuItems.length) {\r\n      const menuWrapper = document.createElement('div');\r\n      menuWrapper.className = 'wgo-player__menu-wrapper';\r\n      this.element.appendChild(menuWrapper);\r\n\r\n      const menuButton = document.createElement('button');\r\n      menuButton.type = 'button';\r\n      menuButton.className = 'wgo-player__button wgo-player__button--menu';\r\n      menuButton.innerHTML = '<span class=\"wgo-player__icon-menu\"></span>';\r\n      menuWrapper.appendChild(menuButton);\r\n\r\n      const menu = document.createElement('div');\r\n      menu.className = 'wgo-player__menu';\r\n      this.createMenuItems(menu);\r\n      menuWrapper.appendChild(menu);\r\n    }\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n    this.player.on('applyNodeChanges', this.update);\r\n\r\n    if (this.player.currentNode) {\r\n      this.update();\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off('applyNodeChanges', this.update);\r\n    this.player = null;\r\n  }\r\n\r\n  update() {\r\n    this.moveNumber.value = String(this.player.getCurrentPath().depth);\r\n\r\n    if (!this.player.currentNode.parent) {\r\n      this.first.disabled = true;\r\n      this.previous.disabled = true;\r\n    } else {\r\n      this.first.disabled = false;\r\n      this.previous.disabled = false;\r\n    }\r\n\r\n    if (this.player.currentNode.children.length === 0) {\r\n      this.next.disabled = true;\r\n      this.last.disabled = true;\r\n    } else {\r\n      this.next.disabled = false;\r\n      this.last.disabled = false;\r\n    }\r\n  }\r\n\r\n  createMenuItems(menu: HTMLElement) {\r\n    this.config.menuItems.forEach((menuItem) => {\r\n      const menuItemElement = document.createElement('a');\r\n      menuItemElement.className = 'wgo-player__menu-item';\r\n      menuItemElement.tabIndex = 0;\r\n      menuItemElement.textContent = menuItem.name;\r\n      menuItemElement.href = 'javascript: void(0)';\r\n\r\n      if (menuItem.defaultChecked && menuItem.defaultChecked()) {\r\n        menuItemElement.classList.add('wgo-player__menu-item--checked');\r\n      }\r\n\r\n      menuItemElement.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n\r\n        const res = menuItem.handleClick();\r\n\r\n        if (menuItem.checkable) {\r\n          if (!res) {\r\n            menuItemElement.classList.remove('wgo-player__menu-item--checked');\r\n          } else {\r\n            menuItemElement.classList.add('wgo-player__menu-item--checked');\r\n          }\r\n        }\r\n\r\n        menuItemElement.blur();\r\n      });\r\n\r\n      menu.appendChild(menuItemElement);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Some common menu items, probably just temporary.\r\n   */\r\n  static menuItems = {\r\n    /** Renders menu item with SGF download link */\r\n    download: (player: PlayerBase) => ({\r\n      name: 'Download SGF',\r\n      handleClick() {\r\n        const name = player.rootNode.getProperty(PropIdent.GAME_NAME) || 'game';\r\n        const sgf = player.rootNode.toSGF();\r\n\r\n        const element = document.createElement('a');\r\n        element.setAttribute('href', `data:application/x-go-sgf;charset=utf-8,${encodeURIComponent(sgf)}`);\r\n        element.setAttribute('download', `${name}.sgf`);\r\n\r\n        element.style.display = 'none';\r\n        document.body.appendChild(element);\r\n\r\n        element.click();\r\n\r\n        document.body.removeChild(element);\r\n      },\r\n    }),\r\n\r\n    /** Renders menu item to toggle coordinates of SVGBoardComponent */\r\n    displayCoordinates: (boardComponent: SVGBoardComponent) => ({\r\n      name: 'Display coordinates',\r\n      checkable: true,\r\n      handleClick() {\r\n        boardComponent.setCoordinates(!boardComponent.config.coordinates);\r\n        return boardComponent.config.coordinates;\r\n      },\r\n      defaultChecked: () => boardComponent.config.coordinates,\r\n    }),\r\n\r\n    /** Renders menu item to toggle edit mode (using EditMode plugin) */\r\n    editMode: (editMode: EditMode) => ({\r\n      name: 'Edit mode',\r\n      checkable: true,\r\n      handleClick() {\r\n        editMode.setEnabled(!editMode.config.enabled);\r\n        return editMode.config.enabled;\r\n      },\r\n      defaultChecked: () => editMode.config.enabled,\r\n    }),\r\n  };\r\n}\r\n","import PlayerDOM from '../PlayerDOM';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\n\r\ninterface ResponsiveComponentParams {\r\n  minWidth?: number;\r\n  maxWidth?: number;\r\n  minHeight?: number;\r\n  maxHeight?: number;\r\n  orientation?: 'portrait' | 'landscape';\r\n}\r\n\r\nexport default class ResponsiveComponent implements PlayerDOMComponent {\r\n  element: Node;\r\n  player: PlayerDOM;\r\n  visible: boolean;\r\n\r\n  constructor(private params: ResponsiveComponentParams, private component: PlayerDOMComponent) {\r\n    this.resize = this.resize.bind(this);\r\n    this.visible = true;\r\n    this.element = this.component.element;\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n    this.player.on('resize', this.resize);\r\n    this.component.create(this.player);\r\n\r\n    this.resize();\r\n  }\r\n\r\n  resize() {\r\n    const shouldRenderComponent = this.shouldRenderComponent();\r\n\r\n    if (this.visible && !shouldRenderComponent) {\r\n      // replace component element by placeholder\r\n      const placeholder = this.createPlaceholder();\r\n      this.element.parentElement.replaceChild(placeholder, this.element);\r\n      this.element = placeholder;\r\n      this.visible = false;\r\n    } else if (!this.visible && shouldRenderComponent) {\r\n      // replaces placeholder by component element\r\n      const componentElement = this.component.element;\r\n      this.element.parentElement.replaceChild(componentElement, this.element);\r\n      this.element = componentElement;\r\n      this.visible = true;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off('resize', this.resize);\r\n    this.player = null;\r\n\r\n    if (typeof this.component.destroy === 'function') {\r\n      this.component.destroy();\r\n    }\r\n  }\r\n\r\n  private shouldRenderComponent() {\r\n    const width = this.element.parentElement.offsetWidth;\r\n    const height = this.element.parentElement.offsetHeight;\r\n\r\n    if (this.params.minWidth != null && this.params.minWidth > width) {\r\n      return false;\r\n    }\r\n\r\n    if (this.params.minHeight != null && this.params.minHeight > height) {\r\n      return false;\r\n    }\r\n\r\n    if (this.params.maxWidth != null && this.params.maxWidth < width) {\r\n      return false;\r\n    }\r\n\r\n    if (this.params.maxHeight != null && this.params.maxHeight < height) {\r\n      return false;\r\n    }\r\n\r\n    if (this.params.orientation === 'portrait' && width < height) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  private createPlaceholder() {\r\n    // tslint:disable-next-line:max-line-length\r\n    return document.createComment(` WGo component placeholder for ${this.component.constructor ? this.component.constructor.name : 'unknown'} ${JSON.stringify(this.params)} `);\r\n  }\r\n}\r\n","import { Color } from '../../types';\r\nimport { LifeCycleEvent } from '../../PlayerBase/types';\r\nimport PlayerDOMComponent from './PlayerDOMComponent';\r\nimport { PlayerDOM } from '../..';\r\n\r\nexport default class PlayerTag implements PlayerDOMComponent {\r\n  element: HTMLElement;\r\n  player: PlayerDOM;\r\n  color: Color;\r\n  colorChar: 'B' | 'W';\r\n  colorName: 'black' | 'white';\r\n  playerNameElement: HTMLElement;\r\n  playerRankElement: HTMLElement;\r\n  playerTeamElement: HTMLElement;\r\n  playerCapsElement: HTMLElement;\r\n\r\n  constructor(color: Color.B | Color.W) {\r\n    this.color = color;\r\n    this.colorChar = color === Color.B ? 'B' : 'W';\r\n    this.colorName = color === Color.B ? 'black' : 'white';\r\n\r\n    this.setName = this.setName.bind(this);\r\n    this.setRank = this.setRank.bind(this);\r\n    this.setTeam = this.setTeam.bind(this);\r\n    this.setCaps = this.setCaps.bind(this);\r\n\r\n    // create HTML\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'wgo-player__box wgo-player__player-tag';\r\n\r\n    const playerElement = document.createElement('div');\r\n    playerElement.className = 'wgo-player__player-tag__name';\r\n    this.element.appendChild(playerElement);\r\n\r\n    this.playerNameElement = document.createElement('span');\r\n    playerElement.appendChild(this.playerNameElement);\r\n\r\n    this.playerRankElement = document.createElement('small');\r\n    this.playerRankElement.className = 'wgo-player__player-tag__name__rank';\r\n    playerElement.appendChild(this.playerRankElement);\r\n\r\n    this.playerCapsElement = document.createElement('div');\r\n    this.playerCapsElement.className = `wgo-player__player-tag__color wgo-player__player-tag__color--${this.colorName}`;\r\n    this.playerCapsElement.textContent = '0';\r\n    this.element.appendChild(this.playerCapsElement);\r\n\r\n    // todo team\r\n    this.playerTeamElement = document.createElement('div');\r\n  }\r\n\r\n  create(player: PlayerDOM) {\r\n    this.player = player;\r\n\r\n    // attach Kifu listeners\r\n    this.player.on(`beforeInit.P${this.colorChar}`, this.setName); // property PB or PW\r\n    this.player.on(`beforeInit.${this.colorChar}R`, this.setRank); // property BR or WR\r\n    this.player.on(`beforeInit.${this.colorChar}T`, this.setTeam); // property BT or WT\r\n    this.player.on('applyNodeChanges', this.setCaps);\r\n\r\n    // set current (probably initial) values\r\n    this.initialSet();\r\n  }\r\n\r\n  destroy() {\r\n    this.player.off(`beforeInit.P${this.colorChar}`, this.setName);\r\n    this.player.off(`beforeInit.${this.colorChar}R`, this.setRank);\r\n    this.player.off(`beforeInit.${this.colorChar}T`, this.setTeam);\r\n    this.player.off('applyNodeChanges', this.setCaps);\r\n\r\n    this.player = null;\r\n  }\r\n\r\n  setName(event: LifeCycleEvent<string>) {\r\n    this.playerNameElement.textContent = event.value || this.colorName;\r\n  }\r\n\r\n  setRank(event: LifeCycleEvent<string>) {\r\n    this.playerRankElement.textContent = event.value;\r\n  }\r\n\r\n  setTeam(event: LifeCycleEvent<string>) {\r\n    this.playerTeamElement.textContent = event.value;\r\n  }\r\n\r\n  setCaps() {\r\n    this.playerCapsElement.textContent = this.player.game.position.capCount[this.colorName].toString();\r\n  }\r\n\r\n  private initialSet() {\r\n    if (this.player.rootNode) {\r\n      this.playerNameElement.textContent = this.player.rootNode.getProperty(`P${this.colorChar}`) || this.colorName;\r\n      this.playerRankElement.textContent = this.player.rootNode.getProperty(`${this.colorChar}R`) || '';\r\n      this.playerTeamElement.textContent = this.player.rootNode.getProperty(`${this.colorChar}T`) || '';\r\n    }\r\n    if (this.player.game) {\r\n      this.setCaps();\r\n    }\r\n  }\r\n}\r\n","import makeConfig, { PartialRecursive } from '../utils/makeConfig';\r\nimport { Color } from '../types';\r\nimport PlayerDOM, { PlayerDOMConfig, playerDOMDefaultConfig } from '../PlayerDOM/PlayerDOM';\r\nimport SVGBoardComponent, {\r\n  defaultSVGBoardComponentConfig,\r\n  SVGBoardComponentConfig,\r\n} from '../PlayerDOM/components/SVGBoardComponent';\r\nimport CommentsBox, { CommentBoxConfig, commentBoxDefaultConfig } from '../PlayerDOM/components/CommentsBox';\r\nimport GameInfoBox, { GameInfoBoxConfig, gameInfoBoxDefaultConfig } from '../PlayerDOM/components/GameInfoBox';\r\nimport { EditMode } from '../PlayerBase/plugins';\r\nimport { Container, ControlPanel, PlayerTag, ResponsiveComponent } from '../PlayerDOM/components';\r\nimport KifuNode from '../kifu/KifuNode';\r\n\r\ninterface SimplePlayerConfig extends PlayerDOMConfig {\r\n  board: SVGBoardComponentConfig;\r\n  comments: CommentBoxConfig & {\r\n    enabled: boolean;\r\n  };\r\n  gameInfo: GameInfoBoxConfig & {\r\n    enabled: boolean;\r\n  };\r\n  sgfFile: string | null;\r\n  sgf: string | null;\r\n}\r\n\r\nconst defaultConfig: SimplePlayerConfig = {\r\n  ...playerDOMDefaultConfig,\r\n  board: defaultSVGBoardComponentConfig,\r\n  comments: {\r\n    enabled: true,\r\n    ...commentBoxDefaultConfig,\r\n  },\r\n  gameInfo: {\r\n    enabled: true,\r\n    ...gameInfoBoxDefaultConfig,\r\n  },\r\n  sgfFile: null,\r\n  sgf: null,\r\n};\r\n\r\nexport default class SimplePlayer extends PlayerDOM {\r\n  element: HTMLElement;\r\n  config: SimplePlayerConfig;\r\n\r\n  constructor(elem: HTMLElement, config: PartialRecursive<SimplePlayerConfig> = {}) {\r\n    super();\r\n\r\n    // TODO - already partially done in PlayerDOM\r\n    this.config = makeConfig(defaultConfig, config);\r\n\r\n    this.element = elem;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    const editMode = new EditMode();\r\n    this.use(editMode);\r\n\r\n    const svgBoardComponent = new SVGBoardComponent(this.config.board);\r\n\r\n    const controlPanelConfig = {\r\n      menuItems: [\r\n        ControlPanel.menuItems.editMode(editMode),\r\n        ControlPanel.menuItems.displayCoordinates(svgBoardComponent),\r\n        ControlPanel.menuItems.download(this),\r\n      ],\r\n    };\r\n\r\n    const component = new Container('column', [\r\n      new ResponsiveComponent({ maxWidth: 749 }, new Container('row', [\r\n        new PlayerTag(Color.B),\r\n        new PlayerTag(Color.W),\r\n      ])),\r\n      new Container('row', [\r\n        svgBoardComponent,\r\n        new ResponsiveComponent({ minWidth: 650 }, new Container('column', [\r\n          new ResponsiveComponent({ minWidth: 250 }, new PlayerTag(Color.B)),\r\n          new ResponsiveComponent({ minWidth: 250 }, new PlayerTag(Color.W)),\r\n          new ResponsiveComponent({ minWidth: 250 }, new ControlPanel(controlPanelConfig)),\r\n          new GameInfoBox(this.config.gameInfo),\r\n          new CommentsBox(this.config.comments),\r\n        ])),\r\n      ]),\r\n      new ResponsiveComponent({ maxWidth: 749 }, new ControlPanel(controlPanelConfig)),\r\n      new ResponsiveComponent({ maxWidth: 649 }, new CommentsBox(this.config.comments)),\r\n    ]);\r\n\r\n    this.render(component, this.element);\r\n\r\n    if (this.config.sgf) {\r\n      this.loadKifu(KifuNode.fromSGF(this.config.sgf));\r\n    } else if (this.config.sgfFile) {\r\n      // TODO add some loading overlay and error state\r\n      fetch(this.config.sgfFile).then(\r\n        response => response.text(),\r\n      ).then(\r\n        value => this.loadKifu(KifuNode.fromSGF(value)),\r\n      );\r\n    }\r\n  }\r\n}\r\n"],"names":["Color","drawHandlers.SimpleStone","drawHandlers.Circle","drawHandlers.Square","drawHandlers.Label","drawHandlers.Triangle","drawHandlers.XMark","drawHandlers.Dot","drawHandlers.Line","drawHandlers.Arrow","drawHandlers.Dim","drawHandlers.RealisticStone","drawHandlers.GlassStoneBlack","drawHandlers.GlassStoneWhite","drawHandlers.ShellStoneBlack","drawHandlers.ShellStoneWhite","Repeating","basePropertyListeners.beforeInitSZ","basePropertyListeners.beforeInitRU","basePropertyListeners.applyGameChangesHA","basePropertyListeners.applyGameChangesMove","basePropertyListeners.applyGameChangesPL","basePropertyListeners.applyGameChangesSetup","createGrid","ModernStoneWhite","ModernStoneBlack","Circle","SVGLabel","defaultConfig"],"mappings":"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AAC,EAAE,CAAC,EAAE,CAAC;YACnB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACnB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACnE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACnF,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACpE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACpF,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACpE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACpF,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACxE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACxF,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACxE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;gBACpF,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACpE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACxE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;gBACpF,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACpE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAA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C,IAAI,EAAE,CAAC,EAAE,EAAE;gBAClC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;gBACZ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE;oBAClC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;iBAC1C;aACF;YAED,OAAO,GAAG,CAAC;SACZ;QACH,eAAC;IAAD,CAAC,IAAA;IAED;IAEA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IAEA;IACA;IACA;IAEA;IAEA;IACA;IACA;IAEA;IACA;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;;;;;;;;;;;;;;;;;;;;;;QCzmBE,cAAY,IAAiB,EAAE,KAA+B;YAAlD,qBAAA,EAAA,SAAiB;YAAE,sBAAA,EAAA,sBAA+B;YAC5D,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;YACvB,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;SAC3C;QAED,sBAAI,0BAAQ;iBAAZ;gBACE,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aAC1D;iBAED,UAAa,GAAG;gBACd,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;aACzD;;;WAJA;QAMD,sBAAI,sBAAI;iBAAR;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;aAC3B;iBAED,UAAS,KAAgC;gBACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,KAAK,CAAC;aAC5B;;;WAJA;QAMD,sBAAI,0BAAQ;iBAAZ;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;aAC/B;;;WAAA;;;;QAKD,mBAAI,GAAJ,UAAK,CAAS,EAAE,CAAS;YACvB,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAE1C,IAAI,YAAY,EAAE;gBAChB,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;aACjC;YAED,OAAO,YAAY,CAAC;SACrB;;;;QAKS,wBAAS,GAAnB,UAAoB,CAAS,EAAE,CAAS;YACtC,IAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;YAC3C,IAAM,OAAO,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;YAElH,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,EAAE;gBACtD,OAAO,YAAY,CAAC;aACrB;YAED,OAAO,KAAK,CAAC;SACd;;;;;QAMD,kCAAmB,GAAnB,UAAoB,QAAkB;YACpC,IAAI,KAAa,CAAC;YAElB,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,KAAKgB,iBAAS,CAAC,EAAE,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,EAAE;gBAC/E,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;aACvC;iBAAM,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,KAAKA,iBAAS,CAAC,IAAI,EAAE;gBAClD,KAAK,GAAG,CAAC,CAAC;aACX;iBAAM;gBACL,OAAO,KAAK,CAAC;aACd;YAED,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,EAAE,EAAE;gBAC3D,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;oBACxD,OAAO,IAAI,CAAC;iBACb;aACF;YAED,OAAO,KAAK,CAAC;SACd;;;;;;QAQD,mBAAI,GAAJ,UAAK,CAAwC;YAAxC,kBAAA,EAAA,IAA+B,IAAI,CAAC,IAAI;YAC3C,IAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;YAC3C,YAAY,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC;YACtC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;SACjC;;;;;;;;QAUD,sBAAO,GAAP,UAAQ,CAAS,EAAE,CAAS;YAC1B,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAC/B;;;;;;;;QAUD,wBAAS,GAAT,UAAU,CAAS,EAAE,CAAS;YAC5B,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SACzC;;;;;;;;;QAWD,uBAAQ,GAAR,UAAS,CAAS,EAAE,CAAS,EAAE,CAA4B;YACzD,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,KAAKhB,aAAK,CAAC,KAAK,EAAE;gBACnE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC3B,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd;;;;;;;;QAUD,0BAAW,GAAX,UAAY,CAAS,EAAE,CAAS;YAC9B,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,KAAKA,aAAK,CAAC,KAAK,EAAE;gBACnE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAEA,aAAK,CAAC,KAAK,CAAC,CAAC;gBACrC,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd;;;;;;;;;QAWD,uBAAQ,GAAR,UAAS,CAAS,EAAE,CAAS,EAAE,CAAQ;YACrC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;gBACxB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC3B,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd;;;;;;;;QAUD,uBAAQ,GAAR,UAAS,CAAM,EAAE,CAAM;YACrB,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAChC;;;;;;;QASD,2BAAY,GAAZ,UAAa,GAAa;YACxB,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACrC;;;;QAMD,0BAAW,GAAX;YACE,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjC,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;aACjC;YAED,OAAO,IAAI,CAAC;SACb;;;;QAMD,oBAAK,GAAL;YACE,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;SAC9C;QACH,WAAC;IAAD,CAAC;;IC5OD,IAAY,SAuFX;IAvFD,WAAY,SAAS;;QAEnB,6BAAgB,CAAA;QAChB,mCAAsB,CAAA;QACtB,+BAAkB,CAAA;QAClB,6BAAgB,CAAA;;QAGhB,6BAAgB,CAAA;QAChB,+BAAkB,CAAA;QAClB,6BAAgB,CAAA;QAChB,4BAAe,CAAA;;QAGf,0BAAa,CAAA;QACb,iCAAoB,CAAA;QACpB,kCAAqB,CAAA;QACrB,kCAAqB,CAAA;QACrB,2BAAc,CAAA;QACd,4BAAe,CAAA;QACf,oCAAuB,CAAA;QACvB,6BAAgB,CAAA;;QAGhB,4BAAe,CAAA;QACf,iCAAoB,CAAA;QACpB,oCAAuB,CAAA;QACvB,6BAAgB,CAAA;;QAGhB,yBAAY,CAAA;QACZ,0BAAa,CAAA;QACb,uBAAU,CAAA;QACV,yBAAY,CAAA;QACZ,wBAAW,CAAA;QACX,0BAAa,CAAA;QACb,4BAAe,CAAA;QACf,0BAAa,CAAA;QACb,4BAAe,CAAA;;QAGf,+BAAkB,CAAA;QAClB,2BAAc,CAAA;QACd,+BAAkB,CAAA;QAClB,6BAAgB,CAAA;QAChB,oCAAuB,CAAA;QACvB,8BAAiB,CAAA;;QAGjB,6BAAgB,CAAA;QAChB,8BAAiB,CAAA;QACjB,8BAAiB,CAAA;QACjB,6BAAgB,CAAA;QAChB,wBAAW,CAAA;QACX,yBAAY,CAAA;QACZ,6BAAgB,CAAA;QAChB,gCAAmB,CAAA;QACnB,gCAAmB,CAAA;QACnB,6BAAgB,CAAA;QAChB,8BAAiB,CAAA;QACjB,yBAAY,CAAA;QACZ,8BAAiB,CAAA;QACjB,0BAAa,CAAA;QACb,yBAAY,CAAA;QACZ,yBAAY,CAAA;QACZ,0BAAa,CAAA;QACb,+BAAkB,CAAA;QAClB,0BAAa,CAAA;QACb,8BAAiB,CAAA;QACjB,8BAAiB,CAAA;;QAGjB,mCAAsB,CAAA;QACtB,qCAAwB,CAAA;QACxB,qCAAwB,CAAA;QACxB,mCAAsB,CAAA;;QAGtB,0BAAa,CAAA;QACb,sCAAyB,CAAA;QACzB,iCAAoB,CAAA;QACpB,4BAAe,CAAA;;QAGf,wBAAW,CAAA;QACX,mCAAsB,CAAA;QACtB,mCAAsB,CAAA;IACxB,CAAC,EAvFW,SAAS,KAAT,SAAS;;aCKL,YAAY,CAAC,KAA6B;QACxD,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC;IACzC,CAAC;aAEe,YAAY,CAAC,KAA6B;QACxD,IAAK,OAAe,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;YACjC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,GAAI,OAAe,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SAC3D;IACH,CAAC;aAEe,kBAAkB,CAAC,KAA6B;QAC9D,IACE,KAAK,CAAC,KAAK,GAAG,CAAC;YACf,KAAK,CAAC,MAAM,CAAC,WAAW,KAAK,KAAK,CAAC,MAAM,CAAC,QAAQ;YAClD,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,EAC7C;YACA,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAGA,aAAK,CAAC,KAAK,CAAC;SAC/C;IACH,CAAC;aAEe,oBAAoB,CAAC,KAA4B;QAC/D,IAAM,KAAK,GAAG,KAAK,CAAC,SAAS,KAAK,GAAG,GAAGA,aAAK,CAAC,CAAC,GAAGA,aAAK,CAAC,CAAC,CAAC;;QAG1D,IAAI,KAAK,CAAC,KAAK,EAAE;YACf,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACvF;QAED,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,KAAK,CAAC;IAC3C,CAAC;aAEe,kBAAkB,CAAC,KAAgD;QACjF,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC;IACvC,CAAC;aAEe,qBAAqB,CAAC,KAA8B;QAClE,IAAI,KAAY,CAAC;QACjB,QAAQ,KAAK,CAAC,SAAS;YACrB,KAAK,IAAI;gBAAE,KAAK,GAAGA,aAAK,CAAC,CAAC,CAAC;gBAAC,MAAM;YAClC,KAAK,IAAI;gBAAE,KAAK,GAAGA,aAAK,CAAC,CAAC,CAAC;gBAAC,MAAM;YAClC,KAAK,IAAI;gBAAE,KAAK,GAAGA,aAAK,CAAC,CAAC,CAAC;gBAAC,MAAM;SACnC;QAED,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,KAAK;;YAExB,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;SACrD,CAAC,CAAC;IACL;;;QC1CwC,8BAAY;QAOlD;YAAA,YACE,iBAAO,SAcR;YAZC,KAAI,CAAC,QAAQ,CAAC,IAAI,QAAQ,EAAE,CAAC,CAAC;YAC9B,KAAI,CAAC,OAAO,GAAG,EAAE,CAAC;YAElB,KAAI,CAAC,EAAE,CAAC,eAAe,EAAEiB,YAAkC,CAAC,CAAC;YAC7D,KAAI,CAAC,EAAE,CAAC,eAAe,EAAEC,YAAkC,CAAC,CAAC;YAC7D,KAAI,CAAC,EAAE,CAAC,qBAAqB,EAAEC,kBAAwC,CAAC,CAAC;YACzE,KAAI,CAAC,EAAE,CAAC,oBAAoB,EAAEC,oBAA0C,CAAC,CAAC;YAC1E,KAAI,CAAC,EAAE,CAAC,oBAAoB,EAAEA,oBAA0C,CAAC,CAAC;YAC1E,KAAI,CAAC,EAAE,CAAC,qBAAqB,EAAEC,kBAAwC,CAAC,CAAC;YACzE,KAAI,CAAC,EAAE,CAAC,qBAAqB,EAAEC,qBAA2C,CAAC,CAAC;YAC5E,KAAI,CAAC,EAAE,CAAC,qBAAqB,EAAEA,qBAA2C,CAAC,CAAC;YAC5E,KAAI,CAAC,EAAE,CAAC,qBAAqB,EAAEA,qBAA2C,CAAC,CAAC;;SAC7E;;;;QAKD,6BAAQ,GAAR,UAAS,QAAkB;YACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;YAE5B,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBACpB,IAAI,EAAE,UAAU;gBAChB,QAAQ,EAAE,QAAQ;gBAClB,MAAM,EAAE,IAAI;aACb,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;;;;QAKD,4BAAO,GAAP,UAAQ,IAAa,EAAE,KAAe;YACpC,IAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;YAEhC,IAAI,IAAI,EAAE;gBACR,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;aAClC;YAED,IAAI,KAAK,EAAE;;gBAET,IAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAC,OAAe,CAAC,IAAI,CAAC,KAAK,KAAK,GAAA,CAAC,CAAC;gBACtF,IAAI,SAAS,EAAE;oBACb,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;iBACvC;aACF;YAED,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SACzB;;;;QAKS,gCAAW,GAArB;YACE,IAAI,CAAC,MAAM,GAAG;gBACZ,IAAI,EAAE,EAAE;gBACR,KAAK,EAAE,cAAc;aACtB,CAAC;YAEF,IAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,CAAC;YAC1C,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAE1D,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;QAES,gCAAW,GAArB;YACE,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAChD,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;SACjD;;;;QAKS,gCAAW,GAArB,UAAsB,CAAS;YAC7B,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAEhD,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;YACnD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAEhD,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;;;;QAKS,oCAAe,GAAzB;YACE,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAChD,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAEhD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACxB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YAE3C,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;SACjD;;;;QAKS,2CAAsB,GAAhC,UAAiC,IAAqC;YAAtE,iBAcC;YAbC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;gBACd,IAAI,MAAA;gBACJ,MAAM,EAAE,IAAI;aACb,CAAC,CAAC;YAEH,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,UAAC,SAAS,EAAE,KAAK;gBAChD,KAAI,CAAC,IAAI,CAAI,IAAI,SAAI,SAAW,EAAE;oBAChC,IAAI,MAAA;oBACJ,MAAM,EAAE,KAAI;oBACZ,SAAS,WAAA;oBACT,KAAK,OAAA;iBACN,CAAC,CAAC;aACJ,CAAC,CAAC;SACJ;QAES,uCAAkB,GAA5B,UAA6B,SAAiB;YAC5C,OAAQ,IAAI,CAAC,WAAmB,CAAC,gBAAgB,CAAC,SAAS,CAA8B,CAAC;SAC3F;;;;QAKD,gCAAW,GAAX,UAAY,SAAoB;YAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAChD;;;;QAKD,gCAAW,GAAX,UAAY,SAAoB,EAAE,KAAW;YAC3C,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAChD,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YAChD,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YAC/C,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;;;;QAKD,oCAAe,GAAf,UAAgB,SAAoB;YAClC,OAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAC7C;;;;QAKD,iCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;SAClC;;;;QAKD,yBAAI,GAAJ,UAAK,IAA2B;YAA3B,qBAAA,EAAA,QAA2B;YAC9B,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE;gBACpC,IAAI,CAAC,SAAQ,CAAC;gBAEd,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;oBAC5B,CAAC,GAAG,IAAI,CAAC;iBACV;qBAAM;oBACL,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;iBAC7C;gBAED,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;oBAChC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBACpB,OAAO,IAAI,CAAC;iBACb;aACF;YAED,OAAO,KAAK,CAAC;SACd;;;;QAKD,6BAAQ,GAAR;YACE,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;gBAC3B,IAAI,CAAC,eAAe,EAAE,CAAC;gBACvB,OAAO,IAAI,CAAC;aACb;YAED,OAAO,KAAK,CAAC;SACd;;;;QAKD,0BAAK,GAAL;;YAEE,OAAO,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAE;SAC3B;;;;QAKD,yBAAI,GAAJ;YACE,OAAO,IAAI,CAAC,IAAI,EAAE,EAAE,GAAE;SACvB;;;;QAKD,yBAAI,GAAJ,UAAK,gBAA+B;;YAElC,IAAM,IAAI,GAAG,OAAO,gBAAgB,KAAK,QAAQ,GAAG,EAAE,KAAK,EAAE,gBAAgB,EAAE,KAAK,EAAE,EAAE,EAAE,GAAG,gBAAgB,CAAC;YAC9G,IAAI,CAAC,KAAK,EAAE,CAAC;YAEb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;gBAC1C,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;oBACxC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,IAAI,EAAE,CAAC;iBACb;aACF;SACF;;;;QAKD,mCAAc,GAAd;YACE,IAAM,IAAI,GAAS,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;YAE3C,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;gBAE5B,OAAO,IAAI,CAAC,MAAM,EAAE;oBAClB,IAAI,CAAC,KAAK,EAAE,CAAC;oBAEb,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;wBACnC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;qBACrD;oBAED,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;iBACpB;aACF;YAED,OAAO,IAAI,CAAC;SACb;;;;QAKD,iCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,QAAQ,EAAE,EAAE;gBACtB,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;oBACxC,OAAO;iBACR;aACF;SACF;;;;QAKD,yBAAI,GAAJ,UAAK,CAAS,EAAE,CAAS;YACvB,IAAM,IAAI,GAAG,IAAI,QAAQ,EAAE,CAAC;YAE5B,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAKtB,aAAK,CAAC,CAAC,EAAE;gBAC9B,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC,GAAA,EAAE,CAAC,GAAA,EAAE,CAAC,CAAC;aAClD;iBAAM;gBACL,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC,GAAA,EAAE,CAAC,GAAA,EAAE,CAAC,CAAC;aAClD;YAED,IAAM,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SACd;;;;;;QAOD,wBAAG,GAAH,UAAI,MAAoB;YACtB,IAAI,CAAC,MAAM,IAAI,OAAO,MAAM,CAAC,KAAK,KAAK,UAAU,EAAE;gBACjD,MAAM,IAAI,SAAS,CAAC,0CAA0C,CAAC,CAAC;aACjE;YACD,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACnB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3B;QACH,iBAAC;IAAD,CA/RA,CAAwC,YAAY;;ICA7C,IAAM,sBAAsB,GAAG;QACpC,gBAAgB,EAAE,IAAI;QACtB,UAAU,EAAE,IAAI;QAChB,UAAU,EAAE,IAAI;KACjB,CAAC;IAEF;;;;QAGuC,6BAAU;QAM/C,mBAAY,MAA8C;YAA9C,uBAAA,EAAA,WAA8C;YAA1D,YACE,iBAAO,SAMR;YAXD,gBAAU,GAAyC,IAAI,GAAG,EAAE,CAAC;YAE7D,uBAAiB,GAAG,KAAK,CAAC;YA+DlB,kBAAY,GAAG;gBACrB,KAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aACrB,CAAA;YAEO,sBAAgB,GAAG,UAAC,CAAa;gBACvC,IAAI,KAAI,CAAC,MAAM,CAAC,gBAAgB,EAAE;oBAChC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;wBAChB,KAAI,CAAC,IAAI,EAAE,CAAC;qBACb;yBAAM,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;wBACvB,KAAI,CAAC,QAAQ,EAAE,CAAC;qBACjB;oBACD,CAAC,CAAC,cAAc,EAAE,CAAC;iBACpB;aACF,CAAA;YAEO,mBAAa,GAAG,UAAC,CAAgB;gBACvC,IAAI,KAAI,CAAC,MAAM,CAAC,UAAU,IAAI,KAAI,CAAC,QAAQ,EAAE,EAAE;oBAC7C,IAAI,KAAI,CAAC,MAAM,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,KAAI,CAAC,iBAAiB,EAAE;wBAC1D,KAAI,CAAC,iBAAiB,GAAG,MAAM,CAAC,UAAU,CAAC;4BACzC,KAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;yBAC/B,EAAE,KAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;qBAC5B;oBAED,IAAI,CAAC,CAAC,GAAG,KAAK,YAAY,EAAE;wBAC1B,KAAI,CAAC,IAAI,EAAE,CAAC;wBACZ,IAAI,KAAI,CAAC,iBAAiB,EAAE;4BAC1B,KAAI,CAAC,IAAI,EAAE,CAAC;4BACZ,KAAI,CAAC,IAAI,EAAE,CAAC;yBACb;qBACF;yBAAM,IAAI,CAAC,CAAC,GAAG,KAAK,WAAW,EAAE;wBAChC,KAAI,CAAC,QAAQ,EAAE,CAAC;wBAChB,IAAI,KAAI,CAAC,iBAAiB,EAAE;4BAC1B,KAAI,CAAC,QAAQ,EAAE,CAAC;4BAChB,KAAI,CAAC,QAAQ,EAAE,CAAC;yBACjB;qBACF;oBAED,OAAO,KAAK,CAAC;iBACd;aACF,CAAA;YAEO,iBAAW,GAAG;gBACpB,MAAM,CAAC,YAAY,CAAC,KAAI,CAAC,iBAAiB,CAAC,CAAC;gBAC5C,KAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;gBAC9B,KAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;aAChC,CAAA;YAxGC,KAAI,CAAC,MAAM,GAAG,UAAU,CAAC,sBAAsB,EAAE,MAAM,CAAC,CAAC;YAEzD,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAI,CAAC,YAAY,CAAC,CAAC;YACrD,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAI,CAAC,aAAa,CAAC,CAAC;YACzD,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAI,CAAC,WAAW,CAAC,CAAC;;SACtD;;;;;;;;;QAUD,0BAAM,GAAN,UAAO,SAA6B,EAAE,SAAsB;;YAE1D,SAAS,CAAC,SAAS,GAAG,EAAE,CAAC;;YAGzB,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;YACrC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;;YAG/B,OAAO,CAAC,WAAW,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YACvC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAEvB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;SAC3C;;;;;;QAOD,yBAAK,GAAL,UAAM,SAAsB;YAC1B,IAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAEjD,IAAI,SAAS,IAAI,OAAO,SAAS,CAAC,OAAO,KAAK,UAAU,EAAE;gBACxD,SAAS,CAAC,OAAO,EAAE,CAAC;aACrB;YAED,IAAM,OAAO,GAAG,SAAS,CAAC,UAA4B,CAAC;YACvD,OAAO,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC5D,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YAE/B,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SACnC;QAEO,iCAAa,GAArB;YACE,IAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC9C,OAAO,CAAC,SAAS,GAAG,YAAY,CAAC;YACjC,OAAO,CAAC,QAAQ,GAAG,CAAC,CAAC;YAErB,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAEzD,OAAO,OAAO,CAAC;SAChB;QAiDO,4BAAQ,GAAhB;;;gBACE,KAAmB,IAAA,KAAA,SAAA,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAA,gBAAA,4BAAE;oBAAtC,IAAM,IAAI,WAAA;oBACb,IAAI,IAAI,CAAC,UAAU,KAAK,QAAQ,CAAC,aAAa,EAAE;wBAC9C,OAAO,IAAI,CAAC;qBACb;iBACF;;;;;;;;;YAED,OAAO,KAAK,CAAC;SACd;QACH,gBAAC;IAAD,CA3HA,CAAuC,UAAU;;QChBpC,MAAM,GAAG,6BAA6B;QACtC,WAAW,GAAG,UAAU;QACxB,aAAa,GAAG,WAAW;QAC3B,WAAW,GAAG;;ICE3B;QAGE,eAAY,MAAuB;YAAvB,uBAAA,EAAA,WAAuB;YACjC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;SACtB;QAED,6BAAa,GAAb;;YACE;gBACE,GAAC,WAAW,IAAG,IAAI,CAAC,iBAAiB,EAAE;gBACvC,GAAC,aAAa,IAAG,IAAI,CAAC,iBAAiB,EAAE;mBACzC;SACH;QAES,iCAAiB,GAA3B;YACE,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACpD,IAAM,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YAC/D,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAM,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;YAEhE,KAAK,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;YAC/B,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACxB,KAAK,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;YAC/B,OAAO,KAAK,CAAC;SACd;QAED,6BAAa,GAAb,UAAc,IAA4B,EAAE,WAA4B,EAAE,MAAsB;;YAE9F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC5F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC1F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,eAAsB,CAAC,CAAC;YAC7G,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,WAAW,CAAC,CAAC;YAEvD,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YACzF,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YACvF,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,IAAI,CAAQ,CAAC,CAAC;YACrH,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,WAAW,CAAC,CAAC;SAC1D;QAES,iCAAiB,GAA3B,UAA4B,IAAgB,EAAE,WAA4B;;YAExE,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACrC,IAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAErC,IAAM,EAAE,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;YAC/B,IAAM,EAAE,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;YAC/B,IAAM,EAAE,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;YAC7B,IAAM,EAAE,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;;YAG7B,IAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;;YAGxE,IAAM,QAAQ,GAAG,UAAC,CAAS,IAAK,OAAA,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,GAAA,CAAC;YACnD,IAAM,QAAQ,GAAG,UAAC,CAAS,IAAK,OAAA,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,GAAA,CAAC;;YAGnD,IAAM,WAAW,GAAG,CAAC,GAAG,MAAM,GAAG,GAAG,CAAC;YACrC,IAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC;YACrC,IAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC;;YAGrC,IAAM,YAAY,GAAG,UAAC,CAAS,IAAK,OAAA,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,GAAA,CAAC;YACvD,IAAM,YAAY,GAAG,UAAC,CAAS,IAAK,OAAA,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,GAAA,CAAC;;YAGvD,IAAM,SAAS,GAAG,GAAG,CAAC;;YAGtB,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,EAAS,CAAC,CAAC;YAC1C,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,EAAS,CAAC,CAAC;YAC1C,WAAW,CAAC,YAAY,CAAC,GAAG,EAAE,SAAgB,CAAC,CAAC;;YAGhD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,GAAG,MAAM,GAAG,SAAS,CAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,GAAG,MAAM,GAAG,SAAS,CAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,EAAS,CAAC,CAAC;YACnC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,EAAS,CAAC,CAAC;;YAGnC,WAAW,CAAC,YAAY,CAAC,QAAQ,EAAE,aAC/B,YAAY,CAAC,CAAE,WAAW,GAAG,IAAI,CAAC,SAAI,YAAY,CAAC,CAAE,WAAW,GAAG,IAAI,CAAC,gBACxE,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,SAAI,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,gBACpE,EAAE,SAAI,EAAE,WACX,CAAC,CAAC;SACJ;QACH,YAAC;IAAD,CAAC;;;QC3FD;SAcC;QAVC,2CAAa,GAAb,UAAc,IAA4B,EAAE,WAAwB,EAAE,MAAsB;YAC1F,IAAM,SAAS,GAAG,eAAa,WAAW,CAAC,CAAC,UAAK,WAAW,CAAC,CAAC,MAAG,CAAC;YAClE,IAAM,KAAK,GAAG,WAAS,WAAW,CAAC,MAAM,UAAK,WAAW,CAAC,MAAM,MAAG,CAAC;YACpE,IAAM,MAAM,GAAG,YAAU,WAAW,CAAC,MAAM,MAAG,CAAC;YAE/C,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAC,GAAG;gBAC5B,IAAI,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,WAAW,EAAK,SAAS,SAAI,KAAK,SAAI,MAAQ,CAAC,CAAC;gBACvE,IAAI,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,SAAS,EAAE,WAAW,CAAC,OAAc,CAAC,CAAC;aAC/D,CAAC,CAAC;SACJ;QACH,0BAAC;IAAD,CAAC;;;QCP0D,wCAAmB;QAG5E,8BAAY,MAAuC;YAAvC,uBAAA,EAAA,WAAuC;YAAnD,YACE,iBAAO,SAER;YADC,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;SACtB;QAED,4CAAa,GAAb,UAAc,IAA4B,EAAE,WAA8B,EAAE,MAAsB;YAChG,iBAAM,aAAa,YAAC,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;YAE/C,IAAI,WAAW,CAAC,SAAS,KAAKA,aAAK,CAAC,CAAC,EAAE;gBACrC,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;gBACxE,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,eAAe,CAAC,CAAC;aAClF;iBAAM,IAAI,WAAW,CAAC,SAAS,KAAKA,aAAK,CAAC,CAAC,EAAE;gBAC5C,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;gBACxE,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,eAAe,CAAC,CAAC;aAClF;iBAAM;gBACL,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;gBAC5F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,eAAe,CAAC,CAAC;aAClF;YAED,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,eAAsB,CAAC,CAAC;SAC9G;QACH,2BAAC;IAAD,CAxBA,CAA2D,mBAAmB;;ICR9E;QAAoC,0BAAoB;QAAxD;;SAkBC;QAjBC,8BAAa,GAAb,UAAc,MAAsB;;YAClC,IAAM,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YAC1D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC/B,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC/B,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAEjC,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACxD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC7B,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC7B,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YAExE;gBACE,GAAC,WAAW,IAAG,MAAM;gBACrB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QACH,aAAC;IAAD,CAlBA,CAAoC,oBAAoB;;ICAxD;QAAiC,uBAAmB;QAGlD,aAAY,MAAyB;YAArC,YACE,iBAAO,SAER;YADC,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;SACtB;QAED,2BAAa,GAAb;YACE,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;YAChC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;YACjC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAE7C,OAAO,IAAI,CAAC;SACb;QACH,UAAC;IAAD,CAlBA,CAAiC,mBAAmB;;ICApD;QAAiC,uBAAmB;QAGlD,aAAY,MAAyB;YAArC,YACE,iBAAO,SAER;YADC,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;SACtB;QAED,2BAAa,GAAb;YACE,IAAM,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YAC1D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC/B,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC/B,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YACjC,MAAM,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAE/C,OAAO,MAAM,CAAC;SACf;QACH,UAAC;IAAD,CAjBA,CAAiC,mBAAmB;;aCH5B,UAAU,CAAC,MAAc;QAC/C,OAAU,MAAM,SAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,UAAU,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAG,CAAC;IAC5E;;;QCE0D,uCAAmB;QAA7E;;SAwDC;QArDC,2CAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;;;;;;;;;;;;;;;;;;YAmBrE,OAAO,IAAI,CAAC;SACb;QAED,0CAAY,GAAZ,UAAa,MAAsB,EAAE,MAAiC;YACpE,IAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC;YAE3C,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC7B,IAAM,mBAAmB,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBAC/E,IAAM,MAAI,GAAG,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC;gBAErC,IAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,WAAW,GAAG,MAAI,EAAE,OAAO,CAAC,CAAC;gBACxE,IAAM,UAAU,GAAG,WAAW,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,WAAW,IAAI,MAAI,CAAC;gBAE9D,mBAAmB,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC;gBACnE,mBAAmB,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;gBAC5D,mBAAmB,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;gBAC1D,mBAAmB,CAAC,SAAS,GAAG,gDACE,MAAM,CAAC,KAAK,CAAC,WAAW,0DACtB,MAAM,CAAC,KAAK,CAAC,sBAAsB,kBACtE,CAAC;gBAEF,MAAM,CAAC,mBAAmB,CAAC,CAAC;gBAC5B,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;aAChD;YAED,IAAM,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YAE1D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC;YAC9D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC;YAC9D,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;YAC9C,MAAM,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,mBAAmB,CAAC,EAAE,MAAG,CAAC,CAAC;YAEpE,OAAO,MAAM,CAAC;SACf;QACH,0BAAC;IAAD,CAxDA,CAA0D,mBAAmB;;ICA7E;QAA6C,mCAAmB;QAAhE;;SAuDC;QApDC,uCAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;;YACrE,iBAAM,aAAa,YAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEpC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,IAAM,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;gBAE1D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChD,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;gBAClC,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;gBAClC,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;gBACrC,MAAM,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;gBAEtC,IAAM,MAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBAEhE,MAAI,CAAC,YAAY,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;gBACzC,MAAI,CAAC,YAAY,CAAC,cAAc,EAAE,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;gBACvE,MAAM,CAAC,WAAW,CAAC,MAAI,CAAC,CAAC;gBAEzB,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;gBAC5B,MAAM,CAAC,MAAM,CAAC,CAAC;aAChB;YAED,IAAM,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YAEzD,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACnC,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC/D,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC/D,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACnC,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,UAAQ,IAAI,CAAC,aAAa,CAAC,EAAE,MAAG,CAAC,CAAC;YAC/D,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACnC,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,UAAQ,IAAI,CAAC,aAAa,CAAC,EAAE,MAAG,CAAC,CAAC;YAC/D,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B;gBACE,GAAC,WAAW,IAAG,UAAU;gBACzB,GAAC,WAAW,IAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;mBAChD;SACH;QACH,sBAAC;IAAD,CAvDA,CAA6C,mBAAmB;;ICAhE;QAA6C,mCAAmB;QAAhE;;SA6DC;QAzDC,uCAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;;YACrE,iBAAM,aAAa,YAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEpC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBACxB,IAAM,OAAO,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBACnE,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACjD,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,SAAS,GAAG,qJAGnB,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC;gBAChB,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;gBAE9B,IAAM,OAAO,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBACnE,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACjD,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,SAAS,GAAG,qJAGnB,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC;gBAChB,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;aAC/B;YAED,IAAM,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YAEzD,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACnC,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,MAAG,CAAC,CAAC;YAC9D,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,MAAG,CAAC,CAAC;YAC9D,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B;gBACE,GAAC,WAAW,IAAG,UAAU;gBACzB,GAAC,WAAW,IAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;mBAChD;SACH;QACH,sBAAC;IAAD,CA7DA,CAA6C,mBAAmB;;ICMhE;QAAmC,yBAAoB;QAGrD,eAAY,MAAwB;YAAxB,uBAAA,EAAA,WAAwB;YAApC,YACE,kBAAM,MAAM,CAAC,SAKd;YAHC,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,KAAK,CAAC,EAAE;gBAC7C,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC;aACxB;;SACF;QAED,6BAAa,GAAb,UAAc,MAAsB;;YAClC,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;YAC3C,IAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;YACjD,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAC;YAEtD,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;YAC3C,IAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;YACjD,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;YACzC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YAC1E,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAC;YAEtD;gBACE,GAAC,WAAW,IAAG,IAAI;gBACnB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QAED,6BAAa,GAAb,UAAc,IAA4B,EAAE,WAA6B,EAAE,MAAsB;YAC/F,iBAAM,aAAa,YAAC,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;YAE/C,IAAI,QAAQ,GAAG,GAAG,CAAC;YACnB,IAAI,WAAW,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACjC,QAAQ,GAAG,GAAG,CAAC;aAChB;iBAAM,IAAI,WAAW,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,QAAQ,GAAG,GAAG,CAAC;aAChB;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;gBACrB,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;aAC3D;iBAAM;gBACL,IAAI,WAAW,CAAC,SAAS,KAAKA,aAAK,CAAC,CAAC,EAAE;oBACrC,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;iBACvE;qBAAM,IAAI,WAAW,CAAC,SAAS,KAAKA,aAAK,CAAC,CAAC,EAAE;oBAC5C,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;iBACvE;qBAAM;oBACL,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;iBACtE;aACF;YAED,IAAI,CAAC,WAAW,CAAC,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,aAAa,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACrF,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;YACpD,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,WAAW,EAAE,QAAe,CAAC,CAAC;YAC7D,IAAI,CAAC,WAAW,CAAC,CAAC,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC;YAEjD,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,WAAW,EAAE,QAAe,CAAC,CAAC;YAC/D,IAAI,CAAC,aAAa,CAAC,CAAC,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC;YAEnD,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,CAAC,EAAE;gBAC5B,IAAK,IAAI,CAAC,WAAW,CAAoB,CAAC,qBAAqB,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;oBACxF,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,YAAY,EAAE,KAAG,IAAI,CAAC,MAAM,CAAC,QAAU,CAAC,CAAC;oBACxE,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,YAAY,EAAE,KAAG,IAAI,CAAC,MAAM,CAAC,QAAU,CAAC,CAAC;iBAC3E;qBAAM;oBACL,IAAI,CAAC,WAAW,CAAC,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;oBAChD,IAAI,CAAC,aAAa,CAAC,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;iBACnD;aACF;SACF;QACH,YAAC;IAAD,CAvEA,CAAmC,oBAAoB;;ICFvD;QAGE,cAAY,MAAuB;YAAvB,uBAAA,EAAA,WAAuB;YACjC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;SACtB;QAED,4BAAa,GAAb;;YACE,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEtD;gBACE,GAAC,WAAW,IAAG,IAAI;gBACnB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QAED,4BAAa,GAAb,UAAc,IAA4B,EAAE,WAA4B,EAAE,MAAsB;YAC9F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC5F,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,eAAsB,CAAC,CAAC;YAC7G,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,KAAK,CAAC,CAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,KAAK,CAAC,CAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,CAAC,CAAQ,CAAC,CAAC;YAC/D,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,CAAC,CAAQ,CAAC,CAAC;YAE/D,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YACzF,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,IAAI,CAAQ,CAAC,CAAC;YACrH,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,KAAK,CAAC,CAAQ,CAAC,CAAC;YACnE,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,KAAK,CAAC,CAAQ,CAAC,CAAC;YACnE,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,CAAC,CAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,CAAC,CAAQ,CAAC,CAAC;SAClE;QACH,WAAC;IAAD,CAAC;;ICpCD;QAA6C,mCAAmB;QAAhE;;SAuCC;QAnCC,uCAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;;YACrE,iBAAM,aAAa,YAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEpC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBACxB,IAAM,OAAO,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBACnE,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACjD,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;gBACjC,OAAO,CAAC,SAAS,GAAG,0MAInB,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC;gBAChB,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;aAC/B;YAED,IAAM,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YAEzD,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,MAAG,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B;gBACE,GAAC,WAAW,IAAG,UAAU;gBACzB,GAAC,WAAW,IAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;mBAChD;SACH;QACH,sBAAC;IAAD,CAvCA,CAA6C,mBAAmB;;ICAhE;QAA6C,mCAAmB;QAAhE;;SAuCC;QAnCC,uCAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;;YACrE,iBAAM,aAAa,YAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEpC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBACxB,IAAM,OAAO,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;gBACnE,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACjD,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;gBAClC,OAAO,CAAC,YAAY,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;gBACjC,OAAO,CAAC,SAAS,GAAG,sNAInB,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC;gBAChB,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;aAC/B;YAED,IAAM,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YAEzD,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,MAAG,CAAC,CAAC;YAC9D,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAE9B;gBACE,GAAC,WAAW,IAAG,UAAU;gBACzB,GAAC,WAAW,IAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;mBAChD;SACH;QACH,sBAAC;IAAD,CAvCA,CAA6C,mBAAmB;;ICAhE;QAA4C,kCAAmB;QAM7D,wBAAa,KAAe,EAAE,QAA6B;YAA3D,YACE,iBAAO,SAKR;YAJC,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,CAAC;YACnD,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,KAAI,CAAC,WAAW,GAAG,EAAE,CAAC;;SACvB;QAED,sCAAa,GAAb,UAAc,MAAsB,EAAE,MAAiC;YAAvE,iBAqCC;YApCC,iBAAM,aAAa,YAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAEpC,IAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACzD,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACpD,IAAI,eAAoB,CAAC;YAEzB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE;gBACzB,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;gBAE9D,IAAI,EAAE,eAAe,YAAY,UAAU,CAAC,EAAE;oBAC5C,eAAe,GAAG,eAAe,CAAC,WAAW,CAAC,CAAC;iBAChD;gBAED,KAAK,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;aACpC;YAED,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;YACxD,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3C,KAAK,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,CAAQ,CAAC,CAAC;YAC/D,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,CAAQ,CAAC,CAAC;YAChE,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACxD,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACxD,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE;gBACzB,KAAK,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;aACpC;YACD,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAC7B,IAAI,eAAe,EAAE;oBACnB,KAAK,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;oBACnC,KAAK,CAAC,WAAW,CAAC,eAA6B,CAAC,CAAC;oBACjD,KAAI,CAAC,WAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;iBAC7B;aACF,CAAC,CAAC;YAEH,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAEzB,OAAO,KAAK,CAAC;SACd;QACH,qBAAC;IAAD,CApDA,CAA4C,mBAAmB;;ICD/D;QAAyC,+BAAmB;QAG1D,qBAAY,KAAa;YAAzB,YACE,iBAAO,SAER;YADC,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;;SACpB;QAED,mCAAa,GAAb,UAAc,MAAsB;YAClC,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YAEzD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,SAAgB,CAAC,CAAC;YACvD,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAEvC,OAAO,KAAK,CAAC;SACd;QACH,kBAAC;IAAD,CAlBA,CAAyC,mBAAmB;;ICA5D;QAAoC,0BAAoB;QAAxD;;SAoBC;QAnBC,8BAAa,GAAb,UAAc,MAAsB;;YAClC,IAAM,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACxD,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAClC,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAClC,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YACrC,MAAM,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAEtC,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAChC,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAChC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YACnC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACpC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YAExE;gBACE,GAAC,WAAW,IAAG,MAAM;gBACrB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QACH,aAAC;IAAD,CApBA,CAAoC,oBAAoB;;ICAxD;QAAsC,4BAAoB;QAA1D;;SAcC;QAbC,gCAAa,GAAb,UAAc,MAAsB;;YAClC,IAAM,QAAQ,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;YAC7D,QAAQ,CAAC,YAAY,CAAC,QAAQ,EAAE,sCAAsC,CAAC,CAAC;YAExE,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;YACzD,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,wCAAwC,CAAC,CAAC;YACtE,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YAExE;gBACE,GAAC,WAAW,IAAG,QAAQ;gBACvB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QACH,eAAC;IAAD,CAdA,CAAsC,oBAAoB;;ICA1D;QAAmC,yBAAoB;QAAvD;;SAgBC;QAfC,6BAAa,GAAb,UAAc,MAAsB;;YAClC,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,qDAAqD,CAAC,CAAC;YAE9E,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACxD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC7B,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC7B,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,gBAAc,MAAM,CAAC,KAAK,CAAC,cAAc,MAAG,CAAC,CAAC;YAExE;gBACE,GAAC,WAAW,IAAG,IAAI;gBACnB,GAAC,aAAa,IAAG,IAAI;mBACrB;SACH;QACH,YAAC;IAAD,CAhBA,CAAmC,oBAAoB;;;;;;;;;;;;;;;;;;;;;ICDvD,SAAS,IAAI,CAAC,KAAa,EAAE,KAAa,EAAE,GAAW,EAAE,GAAW;QAClE,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QACtD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,KAAY,CAAC,CAAC;QACtC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,KAAY,CAAC,CAAC;QACtC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAU,CAAC,CAAC;QACpC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAU,CAAC,CAAC;QAEpC,OAAO,IAAI,CAAC;IACd,CAAC;IAED,SAAS,IAAI,CAAC,CAAS,EAAE,CAAS,EAAE,QAAgB;QAClD,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QACxD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAQ,CAAC,CAAC;QAClC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAQ,CAAC,CAAC;QAClC,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,QAAe,CAAC,CAAC;QACxC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;QAEvC,OAAO,IAAI,CAAC;IACd,CAAC;aAEuBuB,YAAU,CAAC,MAAsB;QAC/C,IAAA,UAAU,GAAK,MAAM,CAAC,KAAK,CAAC,IAAI,WAAtB,CAAuB;QAEzC,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QACnD,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC1D,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,UAAU,CAAC,QAAQ,EAAE,CAAC,CAAC;QACzD,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAEvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE;YACpC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,GAAG,UAAU,GAAG,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,IAAI,GAAG,CAAC,GAAG,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC;YACnF,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,UAAU,GAAG,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,IAAI,GAAG,CAAC,GAAG,UAAU,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;SACpF;QAED,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAElD,IAAI,UAAU,EAAE;YACd,UAAU,CAAC,OAAO,CAAC,UAAC,SAAS;gBAC3B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;aAC9E,CAAC,CAAC;SACJ;QACD,OAAO,IAAI,CAAC;IACd;;IC1CA,SAAS,MAAM,CAAC,CAAS,EAAE,CAAS,EAAE,GAAW;QAC/C,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QACtD,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,CAAQ,CAAC,CAAC;QACjC,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,CAAQ,CAAC,CAAC;QACjC,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;QAEvB,OAAO,IAAI,CAAC;IACd,CAAC;aAEuB,iBAAiB,CAAC,MAAsB;QAC9D,IAAM,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QAC1D,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;QAEtC,WAAW,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC3D,WAAW,CAAC,YAAY,CAAC,WAAW,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,QAAe,CAAC,CAAC;QAChF,WAAW,CAAC,YAAY,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;QAClD,WAAW,CAAC,YAAY,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;QAExD,IAAI,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE;YACjC,WAAW,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;SACjD;QAED,WAAW,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAEjE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE;YACpC,IAAI,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE;gBAC/B,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAW,CAAC,CAAC,CAAC;aAClF;YACD,IAAI,MAAM,CAAC,KAAK,CAAC,iBAAiB,EAAE;gBAClC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,IAAI,GAAG,IAAI,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAW,CAAC,CAAC,CAAC;aAC/F;YACD,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE;gBAChC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAW,CAAC,CAAC,CAAC;aACpG;YACD,IAAI,MAAM,CAAC,KAAK,CAAC,gBAAgB,EAAE;gBACjC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,EAAE,MAAM,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAW,CAAC,CAAC,CAAC;aACjH;SACF;QAED,OAAO,WAAW,CAAC;IACrB;;ICpCA,IAAM,eAAe,yBAChB,qBAAqB;;QAExB,cAAc,EAAE,GAAG,EACnB,SAAS,EAAE,IAAI,EAEf,WAAW,wBACN,qBAAqB,CAAC,WAAW,KACpC,QAAQ,EAAE,GAAG,KAGf,cAAc,EAAE,IAAI,EACpB,gBAAgB,EAAE,IAAI,EACtB,iBAAiB,EAAE,IAAI,EACvB,eAAe,EAAE,IAAI,EAErB,IAAI,wBACC,qBAAqB,CAAC,IAAI,KAC7B,UAAU,EAAE,IAAI,EAChB,QAAQ,EAAE,IAAI,KAGhB,YAAY,EAAE;YACZ,EAAE,EAAE,IAAIrB,QAAmB,EAAE;YAC7B,EAAE,EAAE,IAAIC,QAAmB,EAAE;YAC7B,EAAE,EAAE,IAAIC,OAAkB,EAAE;YAC5B,EAAE,EAAE,IAAIC,UAAqB,EAAE;YAC/B,EAAE,EAAE,IAAIC,OAAkB,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAChD,EAAE,EAAE,IAAIC,KAAgB,CAAC,EAAE,KAAK,EAAE,yBAAyB,EAAE,CAAC;YAC9D,EAAE,EAAE,IAAIC,MAAiB,EAAE;YAC3B,EAAE,EAAE,IAAIC,OAAkB,EAAE;YAC5B,EAAE,EAAE,IAAIC,KAAgB,CAAC,EAAE,KAAK,EAAE,oBAAoB,EAAE,CAAC;;;YAGzD,CAAC,EAAE,IAAIc,iBAAgB,EAAE;YACzB,CAAC,EAAE,IAAIC,iBAAgB,EAAE;SAoB1B,GACF;;IC3CD,IAAM,qBAAqB,yBACtB,sBAAsB,KACzB,KAAK,EAAE,eAAe,GACvB,CAAC;;QAEoC,4BAAS;QAkB7C,kBAAa,IAAiB,EAAE,MAA6C;YAA7C,uBAAA,EAAA,WAA6C;YAA7E,YACE,kBAAM,IAAI,EAAE,UAAU,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC,SAgCvD;YA7CD,aAAO,GAAqB,EAAE,CAAC;;YAQ/B,cAAQ,GAEJ,EAAE,CAAC;YAKL,KAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAClD,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,GAAG,cAAc,CAAC;YACjD,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;YAC9C,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAC;YACjD,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;YAC5C,KAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;YAE5C,KAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC/C,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;YAC3C,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;YAC/B,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;YAChC,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;YAClC,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC;YACjC,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;YAClC,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,GAAG,mBAAmB,CAAC;YACrD,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,GAAG,mBAAmB,CAAC;YACvD,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,GAAG,mBAAmB,CAAC;YACtD,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,GAAG,mBAAmB,CAAC;YACxD,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC;YAE9C,KAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YAC1D,KAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;YACxC,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;YAE/C,KAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,KAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAI,CAAC,WAAW,CAAC,CAAC;YAE9C,KAAI,CAAC,WAAW,EAAE,CAAC;YACnB,KAAI,CAAC,MAAM,EAAE,CAAC;YACd,KAAI,CAAC,MAAM,EAAE,CAAC;;SACf;QAED,yBAAM,GAAN;YACE,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;gBAC3C,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;gBACnC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,GAAM,IAAI,CAAC,MAAM,CAAC,KAAK,OAAI,CAAC;gBACvD,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAM,IAAI,CAAC,MAAM,CAAC,MAAM,OAAI,CAAC;aAC1D;iBAAM,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;gBAC5B,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;gBACnC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,GAAM,IAAI,CAAC,MAAM,CAAC,KAAK,OAAI,CAAC;gBACvD,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;aACvC;iBAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;gBAC7B,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;gBACnC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;gBACrC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAM,IAAI,CAAC,MAAM,CAAC,MAAM,OAAI,CAAC;aAC1D;iBAAM;gBACL,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;gBACvC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;gBACrC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;aACvC;SACF;QAED,yBAAM,GAAN;YACE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC;YAE1E,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE;gBACrC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,GAAG,UAAQ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,OAAI,CAAC;aACvF;iBAAM;gBACL,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,GAAG,EAAE,CAAC;aAC5C;YAED,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;QAED,2BAAQ,GAAR;YACE,IAAI,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;gBAChC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;aAC3D;YAED,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;gBAC7B,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;aACxD;;YAGO,IAAA,IAAI,GAAK,IAAI,CAAC,MAAM,KAAhB,CAAiB;YAC7B,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACxE,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,EAAE,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC;YACrD,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,SAAS,GAAG,yCAAkC,IAAI,oBAAa,IAAI,yBAAmB,CAAC;YACpH,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;;YAG1D,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAGF,YAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,YAAY,CAAC,MAAM,EAAE,UAAQ,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,EAAE,MAAG,CAAC,CAAC;YAC3F,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;SACxD;QAED,kCAAe,GAAf;YACE,IAAI,IAAI,CAAC,QAAQ,CAAC,kBAAkB,EAAE;gBACpC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;aAC/D;YAED,IAAI,CAAC,QAAQ,CAAC,kBAAkB,GAAG,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAClE,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,EAAE,GAAG,GAAG,CAAC;YACpF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;SAC/D;QAED,8BAAW,GAAX;YAAA,iBAsBC;;YApBC,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC9B,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;aACzD;;YAGD,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC9B,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;aACzD;;YAGD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACnE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;;YAGxD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACnE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;;YAGxD,IAAI,CAAC,iBAAiB,GAAG,IAAI,GAAG,EAAE,CAAC;YACnC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,WAAW,IAAI,OAAA,KAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,GAAA,CAAC,CAAC;SAC7E;QAED,4BAAS,GAAT,UAAU,WAA8C;YACtD,iBAAM,SAAS,YAAC,WAAW,CAAC,CAAC;YAE7B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;gBAC/B,IAAI,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;;oBAE3C,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;oBAC/B,OAAO;iBACR;gBAED,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC;aACxC;SACF;QAES,uCAAoB,GAA9B,UAA+B,WAA2B;;YAA1D,iBAgBC;YAfC,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;;YAGnD,IAAM,IAAI,GAAG,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,EAAE,UAAC,GAAe,IAAK,OAAA,KAAI,CAAC,WAAW,CAAC,WAAW,CAAC,GAAG,CAAC,GAAA,CAAC,CAAC;YACxG,IAAI,QAAgC,CAAC;YAErC,IAAI,IAAI,YAAY,UAAU,EAAE;gBAC9B,QAAQ,aAAK,GAAC,WAAW,IAAG,IAAI,KAAE,CAAC;aACpC;iBAAM;gBACL,QAAQ,GAAG,IAAI,CAAC;aACjB;YACD,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;YAClD,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAA,CAAC,CAAC;YAEpF,OAAO,CAAC,aAAa,CAAC,QAAQ,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3D;QAED,mCAAgB,GAAhB,UAAiB,WAA2B;YAC1C,OAAO,SAAS,IAAI,WAAW,GAAG,WAAW,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAC1G;QAED,+BAAY,GAAZ,UAAa,WAA8C;YAA3D,iBAUC;YATC,iBAAM,YAAY,YAAC,WAAW,CAAC,CAAC;YAEhC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;gBAC/B,IAAM,UAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;gBACzD,IAAI,UAAQ,EAAE;oBACZ,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;oBAC3C,MAAM,CAAC,IAAI,CAAC,UAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,UAAQ,CAAC,GAAG,CAAC,CAAC,GAAA,CAAC,CAAC;iBACrF;aACF;SACF;QAED,+BAAY,GAAZ,UAAa,WAA8C;;YAEzD,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;gBAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBAC3C,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;iBACnC;gBACD,OAAO;aACR;YAED,IAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAEzD,IAAI,CAAC,QAAQ,EAAE;;gBAEb,OAAO;aACR;YAED,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;YACnD,OAAO,CAAC,aAAa,CAAC,QAAQ,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3D;QAED,8BAAW,GAAX,UAAY,QAA8C;YAA9C,yBAAA,EAAA,WAA0B,IAAI,CAAC,MAAM,CAAC,QAAQ;YACxD,iBAAM,WAAW,YAAC,QAAQ,CAAC,CAAC;YAEtB,IAAA,KAA+B,IAAI,CAAC,MAAM,EAAxC,WAAW,iBAAA,EAAE,KAAK,WAAA,EAAE,IAAI,UAAgB,CAAC;YACzC,IAAA,UAAU,GAA2E,KAAK,WAAhF,EAAE,cAAc,GAA2D,KAAK,eAAhE,EAAE,eAAe,GAA0C,KAAK,gBAA/C,EAAE,iBAAiB,GAAuB,KAAK,kBAA5B,EAAE,gBAAgB,GAAK,KAAK,iBAAV,CAAW;YAC3F,IAAA,QAAQ,GAAK,KAAK,CAAC,WAAW,SAAtB,CAAuB;YAEvC,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,GAAG,GAAG,IAAI,WAAW,IAAI,cAAc,IAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,QAAQ,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC;YAC7G,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,IAAI,GAAG,GAAG,IAAI,WAAW,IAAI,eAAe,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,QAAQ,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC;;YAEjH,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,MAAM,IAAI,WAAW,IAAI,iBAAiB,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,QAAQ,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC;;YAE3I,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,KAAK,IAAI,WAAW,IAAI,gBAAgB,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,QAAQ,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC;YACxI,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,SAAS,EAAK,IAAI,CAAC,IAAI,SAAI,IAAI,CAAC,GAAG,SAAI,IAAI,CAAC,KAAK,SAAI,IAAI,CAAC,MAAQ,CAAC,CAAC;SAClG;QAED,0BAAO,GAAP,UAAQ,IAAiB;YAAjB,qBAAA,EAAA,SAAiB;YACvB,iBAAM,OAAO,YAAC,IAAI,CAAC,CAAC;YACpB,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;QAED,iCAAc,GAAd,UAAe,WAAoB;YACjC,iBAAM,cAAc,YAAC,WAAW,CAAC,CAAC;YAClC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,EAAE,GAAG,GAAG,CAAC;YACpF,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;QAED,qBAAE,GAAF,UAAG,IAAY,EAAE,QAAgD;YAC/D,iBAAM,EAAE,YAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACzB,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;SAClC;QAED,wCAAqB,GAArB,UAAsB,IAAY;YAAlC,iBASC;YARC,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,EAAE,UAAC,GAAG;gBACxC,IAAK,GAAW,CAAC,MAAM,IAAI,IAAI,EAAE;oBAC/B,IAAM,GAAG,GAAG,KAAI,CAAC,sBAAsB,CAAE,GAAW,CAAC,MAAM,EAAG,GAAW,CAAC,MAAM,CAAC,CAAC;oBAClF,KAAI,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;iBAC3B;qBAAM;oBACL,KAAI,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;iBACtB;aACF,CAAC,CAAC;SACJ;QAED,yCAAsB,GAAtB,UAAuB,SAAiB,EAAE,SAAiB;;YAGzD,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC;YAC7D,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC;YAEhE,IAAM,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,SAAS,GAAG,UAAU,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAC3D,IAAM,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,SAAS,GAAG,WAAW,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAE3D,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;gBACpE,OAAO,IAAI,CAAC;aACb;YAED,OAAO,EAAE,CAAC,GAAA,EAAE,CAAC,GAAA,EAAE,CAAC;SACjB;QACH,eAAC;IAAD,CA/QA,CAAsC,SAAS;;ICrB/C;QAAkD,wCAAW;QAG3D,8BAAY,OAAuB,EAAE,CAAK,EAAE,CAAK;YAAZ,kBAAA,EAAA,KAAK;YAAE,kBAAA,EAAA,KAAK;YAAjD,YACE,kBAAM,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,SAEtB;YADC,KAAI,CAAC,OAAO,GAAG,OAAO,CAAC;;SACxB;QACH,2BAAC;IAAD,CAPA,CAAkD,WAAW;;ICA7D;QAAkD,wCAAgB;QAAlE;;SAEC;QAAD,2BAAC;IAAD,CAFA,CAAkD,gBAAgB;;ICiBlE,IAAM,SAAS,GAA6B;QAC1C,CAAC,EAAEvB,aAAK,CAAC,KAAK;QACd,CAAC,EAAEA,aAAK,CAAC,KAAK;KACf,CAAC;IAkBK,IAAM,8BAA8B,GAA4B;QACrE,WAAW,EAAE,IAAI;QACjB,oBAAoB,EAAE,IAAI0B,QAAM,CAAC,EAAE,KAAK,EAAE,uBAAuB,EAAE,SAAS,EAAC,eAAe,EAAE,CAAC;QAC/F,oBAAoB,EAAE,IAAIA,QAAM,CAAC,EAAE,KAAK,EAAE,iBAAiB,EAAE,SAAS,EAAC,eAAe,EAAE,CAAC;QACzF,oBAAoB,EAAE,IAAIC,OAAQ,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;QACrD,oBAAoB,EAAE,IAAI;QAC1B,cAAc,EAAE,IAAI;QACpB,qBAAqB,EAAE,KAAK;KAC7B,CAAC;;QAqBA,2BAAY,MAAsD;YAAtD,uBAAA,EAAA,WAAsD;YAChE,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,8BAA8B,EAAE,MAAM,CAAC,CAAC;YACjE,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;YAExB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/D,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzE,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACvE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnE,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3D,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACvE,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC7E,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC7E,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAErD,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,qCAAS,GAAT;YAAA,iBA2CC;YA1CC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,mBAAmB,CAAC;YAE7C,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;YAC7B,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;YAEhC,IAAI,CAAC,KAAK,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE;gBACtC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW;gBACpC,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU;gBAClC,iBAAiB,EAAE,IAAI,CAAC,MAAM,CAAC,iBAAiB;gBAChD,iBAAiB,EAAE,IAAI,CAAC,MAAM,CAAC,iBAAiB;gBAChD,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK;aACzB,CAAC,CAAC;YAEH,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,UAAC,KAAK,EAAE,KAAK;gBAClC,KAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;aAC9B,CAAC,CAAC;YAEH,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,WAAW,EAAE,UAAC,KAAK,EAAE,KAAK;gBACtC,IAAI,CAAC,KAAK,EAAE;oBACV,IAAI,KAAI,CAAC,WAAW,IAAI,IAAI,EAAE;wBAC5B,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;wBACxB,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;wBACxB,KAAI,CAAC,mBAAmB,EAAE,CAAC;qBAC5B;oBACD,OAAO;iBACR;gBACD,IAAI,KAAK,CAAC,CAAC,KAAK,KAAI,CAAC,WAAW,IAAI,KAAK,CAAC,CAAC,KAAK,KAAI,CAAC,WAAW,EAAE;oBAChE,KAAI,CAAC,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC;oBAC3B,KAAI,CAAC,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC;oBAC3B,KAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;iBAClC;aACF,CAAC,CAAC;YAEH,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,UAAU,EAAE,UAAC,KAAK,EAAE,KAAK;gBACrC,IAAI,CAAC,KAAK,IAAI,KAAI,CAAC,WAAW,IAAI,IAAI,EAAE;oBACtC,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;oBACxB,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;oBACxB,KAAI,CAAC,mBAAmB,EAAE,CAAC;oBAC3B,OAAO;iBACR;aACF,CAAC,CAAC;SACJ;QAED,kCAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;YAGrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC1D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;;YAG1D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;YACrE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;YACpE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;;YAGpE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;YAClE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;;YAGlE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC7D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAE7D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,0BAA0B,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;YACzE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,6BAA6B,EAAE,IAAI,CAAC,0BAA0B,CAAC,CAAC;YAC/E,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,6BAA6B,EAAE,IAAI,CAAC,0BAA0B,CAAC,CAAC;YAC/E,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,sBAAsB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;SAC7D;QAED,mCAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAE3D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAE3D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAEjE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;YACtE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;YACrE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;YAErE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;YACnE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;YAEnE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAE9D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;YAC1E,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,6BAA6B,EAAE,IAAI,CAAC,0BAA0B,CAAC,CAAC;YAChF,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,6BAA6B,EAAE,IAAI,CAAC,0BAA0B,CAAC,CAAC;YAChF,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;YAE7D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;QAES,wCAAY,GAAtB;YAAA,iBAyBC;;YAvBC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAC,WAAW;gBACnE,IAAI,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC,CAAC,KAAK,SAAS,CAAC,WAAW,CAAC,IAAc,CAAC,EAAE;oBACrG,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;oBACrC,OAAO,KAAK,CAAC;iBACd;gBACD,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;;YAGH,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;oCAElC,CAAC;wCACC,CAAC;oBACR,IAAM,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAC7B,IAAI,CAAC,IAAI,CAAC,OAAK,kBAAkB,CAAC,IAAI,CACpC,UAAA,WAAW,IAAI,OAAA,WAAW,CAAC,CAAC,KAAK,CAAC,IAAI,WAAW,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC,WAAW,CAAC,IAAc,CAAC,GAAA,CACzG,EAAE;wBACD,IAAM,WAAW,GAAG,IAAI,WAAW,CAAC,CAAC,KAAK3B,aAAK,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;wBACrE,OAAK,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;wBAClC,OAAK,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;qBAC3C;;gBARH,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,EAAE;4BAA7B,CAAC;iBAST;;;YAVH,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,EAAE;wBAA7B,CAAC;aAWT;SACF;QAES,8CAAkB,GAA5B;YAAA,iBAeC;YAdC,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;YAEnC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpB,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;oBACpB,IAAI,IAAI,EAAE;wBACR,IAAM,GAAG,GAAG,IAAI,oBAAoB,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;wBACnF,GAAG,CAAC,OAAO,GAAG,KAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC;wBAC/C,KAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,CAAC;qBACnC;iBACF,CAAC,CAAC;gBACH,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,EAAE;oBAC5B,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;iBACvE;aACF;SACF;QAES,sDAA0B,GAApC;YACE,IAAI,IAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE;gBACrC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;gBACpD,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;aACjC;SACF;QAES,4CAAgB,GAA1B,UAA2B,KAAY;YACrC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;YAEvC,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;YACnC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpB,IAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,GAAA,CAAC,CAAC;gBAEtF,IAAI,GAAG,IAAI,CAAC,EAAE;oBACZ,IAAI,IAAI,CAAC,2BAA2B,EAAE,EAAE;wBACtC,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;wBACvB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;qBACvB;yBAAM;wBACL,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;qBACvB;iBACF;aACF;SACF;QAES,gDAAoB,GAA9B,UAA+B,KAAY;YACzC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;YAC3C,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC;SACpE;QAES,+CAAmB,GAA7B;YACE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YACnC,IAAI,CAAC,qBAAqB,EAAE,CAAC;SAC9B;QAEO,iDAAqB,GAA7B,UAA8B,CAAS,EAAE,CAAS,EAAE,KAAc;YAChE,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpB,IAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;gBAE1E,IAAI,GAAG,IAAI,CAAC,EAAE;oBACZ,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,SAAS,CAAC;oBACtC,OAAO;iBACR;aACF;YAED,IAAI,CAAC,qBAAqB,EAAE,CAAC;SAC9B;QAEO,iDAAqB,GAA7B;YACE,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE;gBAC7B,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;aAChC;SACF;QAEO,4CAAgB,GAAxB;YACE,IAAI,CAAC,YAAY,EAAE,CAAC;YACpB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAEO,4CAAgB,GAAxB;YACE,IAAI,CAAC,0BAA0B,EAAE,CAAC;YAClC,IAAI,CAAC,qBAAqB,EAAE,CAAC;SAC9B;QAEO,+CAAmB,GAA3B,UAA4B,KAA8B;YAA1D,iBAYC;YAXC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,KAAK;;gBAExB,IAAM,WAAW,GAAG,IAAI,iBAAiB,CACvC,KAAK,CAAC,SAAS,EACf,KAAK,CAAC,CAAC,EACP,KAAK,CAAC,CAAC,EACP,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAC5C,CAAC;gBACF,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;gBACxB,KAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;aAC3C,CAAC,CAAC;SACJ;QAEO,oDAAwB,GAAhC,UAAiC,KAA8B;YAA/D,iBAYC;YAXC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,KAAK;;gBAExB,IAAM,WAAW,GAAG,IAAI,gBAAgB,CACtC,KAAK,CAAC,IAAI,EACV,KAAK,CAAC,CAAC,EACP,KAAK,CAAC,CAAC,EACP,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAC5C,CAAC;gBACF,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;gBACxB,KAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;aAC3C,CAAC,CAAC;SACJ;QAEO,mDAAuB,GAA/B,UAAgC,KAA+B;YAA/D,iBAOC;YANC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,KAAK;;gBAExB,IAAM,WAAW,GAAG,IAAI,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7E,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;gBACxB,KAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;aAC3C,CAAC,CAAC;SACJ;QAEO,iDAAqB,GAA7B,UAA8B,KAA6B;YACzD,IAAM,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YACjD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAEzC,IAAI,KAAK,CAAC,KAAK,EAAE;gBACf,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1D,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1D,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1D,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAE1D,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;oBACrB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,IAAI;oBACT,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,IAAI,GAAG,CAAC;oBACtC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,IAAI,GAAG,CAAC;iBACxC,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;oBACrB,GAAG,EAAE,CAAC;oBACN,KAAK,EAAE,CAAC;oBACR,MAAM,EAAE,CAAC;oBACT,IAAI,EAAE,CAAC;iBACR,CAAC,CAAC;aACJ;SACF;QAEO,iDAAqB,GAA7B;YACE,IAAM,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;YAClD,IAAI,gBAAgB,EAAE;gBACpB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;aAC1C;SACF;QAEO,6CAAiB,GAAzB,UAA0B,KAA4B;YACpD,IAAI,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE;gBACpC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;;oBAEhB,OAAO;iBACR;gBACD,IAAI,aAAa,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,EAAE;;oBAElE,OAAO;iBACR;gBAED,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,2BAA2B,EAAE,EAAE;;oBAEzE,OAAO;iBACR;;gBAGD,IAAM,WAAW,GAAG,IAAI,oBAAoB,CAC1C,KAAK,CAAC,SAAS,KAAK,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,oBAAoB,GAAG,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAC7F,KAAK,CAAC,KAAK,CAAC,CAAC,EACb,KAAK,CAAC,KAAK,CAAC,CAAC,CACd,CAAC;gBACF,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;gBACxB,IAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;aAC3C;SACF;QAED,mDAAuB,GAAvB,UAAwB,GAAgB;YACtC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACrC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;SAC3B;QAED,sDAA0B,GAA1B,UAA2B,GAAgB;YACzC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,GAAG,GAAA,CAAC,CAAC;YAC/E,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;SAC9B;QAED,sDAA0B,GAA1B,UAA2B,GAAgB;YACzC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;SAC9B;QAED,0CAAc,GAAd,UAAe,CAAU;YACvB,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,CAAC,CAAC;YAC5B,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;SAC9B;QAED,yCAAa,GAAb;YACE,IAAI,IAAI,CAAC,oBAAoB,EAAE,EAAE;gBAC/B,IAAI,IAAI,CAAC,2BAA2B,EAAE,EAAE;oBACtC,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE;wBAClC,OAAO,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAA,CAAC,CAAC;qBAC5G;iBACF;qBAAM;oBACL,OAAO,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAA,CAAC,CAAC;iBACrG;aACF;YACD,OAAO,EAAE,CAAC;SACX;QAED,gDAAoB,GAApB;;YAEE,IAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YACxE,IAAI,EAAE,IAAI,IAAI,EAAE;gBACd,OAAO,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC;aAClB;;YAGD,OAAO,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC;SACnC;QAED,uDAA2B,GAA3B;;;;;;YAOE,IAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YACxE,IAAI,EAAE,IAAI,IAAI,EAAE;gBACd,OAAO,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC;aACnB;;YAGD,OAAO,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC;SAC1C;QACH,wBAAC;IAAD,CAAC,IAAA;IAED,SAAS,SAAS,CAAC,EAAS,EAAE,EAAO;QACnC,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IAC9C,CAAC;IAED,SAAS,aAAa,CAAC,KAAY,EAAE,UAAkC;QACrE,IAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAE3C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC1C,IAAI,UAAU,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;gBAClD,SAAS;aACV;YAED,IAAM,KAAK,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;YACxC,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACxB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACrC,IAAI,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;wBAC9B,OAAO,IAAI,CAAC;qBACb;iBACF;aACF;iBAAM,IAAI,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE;gBAClC,OAAO,IAAI,CAAC;aACb;SACF;QAED,OAAO,KAAK,CAAC;IACf;;IC/dO,IAAM,uBAAuB,GAAG;QACrC,WAAW,EAAE,IAAI;QACjB,WAAW,EAAE,IAAI;KAClB,CAAC;;QAQA,qBAAY,MAA+C;YAA/C,uBAAA,EAAA,WAA+C;YACzD,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;YAC1D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;YAGnD,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,mEAAmE,CAAC;YAE7F,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC5C,KAAK,CAAC,SAAS,GAAG,UAAU,CAAC;YAC7B,KAAK,CAAC,SAAS,GAAG,wBAAwB,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAEhC,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACrD,IAAI,CAAC,eAAe,CAAC,SAAS,GAAG,0BAA0B,CAAC;YAC5D,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SAChD;QAED,4BAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YAErB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACvD,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YAEzD,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;gBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;gBACzD,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;iBACtC;aACF;SACF;QAED,6BAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACxD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YAC1D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;QAED,iCAAW,GAAX,UAAY,KAAwB;YAApC,iBAkBC;YAjBC,IAAI,CAAC,eAAe,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAEjE,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;gBAC3B,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,EAAE,UAAC,IAAiB;oBACjG,IAAM,KAAK,GAAG,kBAAkB,CAAC,IAAI,CAAC,WAAW,EAAE,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBAC1E,IAAM,WAAW,GAAG,IAAI,iBAAiB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC/G,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;oBAExB,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE;wBAClC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,0BAA0B,EAAE,WAAW,CAAC,CAAC;qBAC3D,CAAC,CAAC;oBAEH,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE;wBAClC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6BAA6B,EAAE,WAAW,CAAC,CAAC;qBAC9D,CAAC,CAAC;iBACJ,CAAC,CAAC;aACJ;SACF;QAED,mCAAa,GAAb;YACE,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,EAAE,CAAC;SACvC;QAED,mCAAa,GAAb,UAAc,IAAY;;YAExB,IAAI,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;;YAGrE,aAAa,GAAG,QAAM,aAAa,CAAC,OAAO,CAAC,KAAK,EAAE,SAAS,CAAC,SAAM,CAAC;YAEpE,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;gBAC3B,aAAa,GAAG,aAAa,CAAC,OAAO,CAAC,qBAAqB,EAAE,8CAA8C,CAAC,CAAC;aAC9G;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;;gBAE3B,aAAa,GAAG,aAAa,CAAC,OAAO,CAAC,mBAAmB,EAAE,mEAAmE,CAAC,CAAC;aACjI;YAED,OAAO,aAAa,CAAC;SACtB;QACH,kBAAC;IAAD,CAAC,IAAA;IAED,SAAS,kBAAkB,CAAC,WAAmB,EAAE,SAAiB;QAChE,IAAM,CAAC,GAAG,WAAW,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;QACvD,IAAM,CAAC,GAAG,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;QAClD,OAAO,EAAE,CAAC,GAAA,EAAE,CAAC,EAAE,SAAS,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC;IACrC;;ICnGO,IAAM,wBAAwB,GAAG;QACtC,kBAAkB,EAAE;YAClB,EAAE,EAAE,MAAM;YACV,EAAE,EAAE,MAAM;YACV,EAAE,EAAE,UAAU;YACd,EAAE,EAAE,aAAa;YACjB,EAAE,EAAE,WAAW;YACf,EAAE,EAAE,eAAe;YACnB,EAAE,EAAE,WAAW;YACf,EAAE,EAAE,QAAQ;YACZ,EAAE,EAAE,UAAU;YACd,EAAE,EAAE,YAAY;YAChB,EAAE,EAAE,QAAQ;YACZ,EAAE,EAAE,OAAO;YACX,EAAE,EAAE,OAAO;YACX,EAAE,EAAE,UAAU;YACd,EAAE,EAAE,OAAO;YACX,EAAE,EAAE,OAAO;YACX,EAAE,EAAE,QAAQ;SACb;QACD,OAAO,EAAE,KAAK;KACf,CAAC;;QAQA,qBAAY,MAAgD;YAAhD,uBAAA,EAAA,WAAgD;YAC1D,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,wBAAwB,EAAE,MAAM,CAAC,CAAC;YAC3D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE3C,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,0CAA0C,CAAC;YAEpE,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACvB,IAAI,CAAC,OAAO,CAAC,SAAS,GAAM,IAAI,CAAC,OAAO,CAAC,SAAS,8BAA2B,CAAC;aAC/E;YAED,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC5C,KAAK,CAAC,SAAS,GAAG,kBAAkB,CAAC;YACrC,KAAK,CAAC,SAAS,GAAG,wBAAwB,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAEhC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;YACjD,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,4BAA4B,CAAC;YACxD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC1C;QAED,4BAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC7C,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,6BAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC9C,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;QAED,6BAAO,GAAP,UAAQ,SAAiB,EAAE,KAAa;YACtC,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YACzC,GAAG,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;YAClC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAEhC,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YAC3C,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAC9D,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAEvB,IAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YAClD,YAAY,CAAC,WAAW,GAAG,KAAK,CAAC;YACjC,GAAG,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;SAC/B;QAED,gCAAU,GAAV,UAAW,SAAiB;YAC1B,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,eAAa,SAAS,OAAI,CAAC,CAAC;YACtE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAClC;QAED,+BAAS,GAAT;YAAA,iBASC;YARC,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,EAAE,CAAC;YAC9B,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;gBACxB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,UAAC,SAAS,EAAE,KAAK;oBACpD,IAAI,KAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,SAAS,CAAC,EAAE;wBAC7C,KAAI,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;qBAChC;iBACF,CAAC,CAAC;aACJ;SACF;QACH,kBAAC;IAAD,CAAC;;ICxED,IAAM,qBAAqB,GAAG;QAC5B,OAAO,EAAE,KAAK;QACd,cAAc,EAAE,IAAI;KACrB,CAAC;IAEF;;;;;;;;;;;;QAsBE,kBAAY,MAA6C;YAAzD,iBAEC;YAFW,uBAAA,EAAA,WAA6C;YAPjD,mBAAc,GAAgB,EAAE,CAAC;YAiEjC,iBAAY,GAAG,UAAC,KAAc;gBACpC,IAAI,KAAK,IAAI,CAAC,KAAI,CAAC,MAAM,CAAC,OAAO,EAAE;oBACjC,KAAI,CAAC,MAAM,EAAE,CAAC;iBACf;qBAAM,IAAI,CAAC,KAAK,IAAI,KAAI,CAAC,MAAM,CAAC,OAAO,EAAE;oBACxC,KAAI,CAAC,OAAO,EAAE,CAAC;iBAChB;aACF,CAAA;YA/DC,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC;SACzD;QAED,wBAAK,GAAL,UAAM,MAAkB;YACtB,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,MAAM,IAAI,KAAK,CAAC,mEAAmE,CAAC,CAAC;aACtF;YAED,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;YAErD,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACvB,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SACF;;;;;;;;;QAWD,6BAAU,GAAV,UAAW,KAAc;YACvB,IAAI,KAAK,KAAK,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACjC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;aAC5C;SACF;;;;;;QAOD,uBAAI,GAAJ,UAAK,KAAY;YACf,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACxB,OAAO;aACR;;YAGD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAChE,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACtD,IAAM,IAAI,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;gBACtE,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;oBAC5C,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBACpB,OAAO;iBACR;aACF;;YAGD,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE;gBAC9C,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;aACpC;SACF;QAUO,yBAAM,GAAd;YAAA,iBAuEC;YAtEC,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;gBAC9B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC;aACjE;iBAAM;gBACL,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC;aACjE;YACD,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;YAE3B,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC;YACf,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC;YAEf,IAAM,UAAU,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,CAAC;YACxC,UAAU,CAAC,OAAO,GAAG,IAAI,CAAC;YAE1B,IAAM,UAAU,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,CAAC;YACxC,UAAU,CAAC,OAAO,GAAG,IAAI,CAAC;YAE1B,IAAI,UAAU,GAAgB,IAAI,CAAC;YAEnC,IAAI,CAAC,oBAAoB,GAAG,UAAC,CAAQ;gBACnC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC,EAAE;oBAClC,IAAI,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;wBACtC,IAAM,WAAW,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,KAAKA,aAAK,CAAC,KAAK,GAAG,UAAU,GAAG,UAAU,CAAC;wBACpF,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;wBAElC,IAAI,UAAU,EAAE;4BACd,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6BAA6B,EAAE,WAAW,CAAC,CAAC;yBAC9D;6BAAM;4BACL,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,0BAA0B,EAAE,WAAW,CAAC,CAAC;4BAC1D,UAAU,GAAG,WAAW,CAAC;yBAC1B;qBAEF;yBAAM;wBACL,KAAI,CAAC,mBAAmB,EAAE,CAAC;qBAC5B;oBACD,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;oBACZ,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;iBACb;aACF,CAAC;YAEF,IAAI,CAAC,mBAAmB,GAAG;gBACzB,IAAI,UAAU,EAAE;oBACd,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6BAA6B,EAAE,UAAU,CAAC,CAAC;oBAC5D,UAAU,GAAG,IAAI,CAAC;iBACnB;gBACD,KAAK,GAAG,CAAC,CAAC,CAAC;gBACX,KAAK,GAAG,CAAC,CAAC,CAAC;aACZ,CAAC;YAEF,IAAI,CAAC,gBAAgB,GAAG,UAAC,CAAQ;gBAC/B,KAAI,CAAC,mBAAmB,EAAE,CAAC;gBAE3B,IAAI,CAAC,IAAI,IAAI,EAAE;oBACb,OAAO;iBACR;gBAED,KAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aACd,CAAC;YAEF,IAAI,CAAC,WAAW,GAAG;gBACjB,IAAM,OAAO,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC;gBACvC,KAAI,CAAC,mBAAmB,EAAE,CAAC;gBAC3B,KAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;aACpC,CAAC;YAEF,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;YAC7D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAErD,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACtD;QAEO,0BAAO,GAAf;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAC5D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAEtD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAEtD,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;;;;QAKO,gCAAa,GAArB;YACE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC;gBACvB,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,EAAE;gBAC1C,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;aACnC,CAAC,CAAC;SACJ;;;;QAKO,mCAAgB,GAAxB;YACE,IAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,CAAC;YAC5C,IAAI,SAAS,EAAE;;gBAEb,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;;gBAGpB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;;gBAGzC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;aAClC;SACF;QACH,eAAC;IAAD,CAAC;;;QC9NC,mBAAY,SAAiB,EAAE,QAAmC;YAAlE,iBAQC;YAR8B,yBAAA,EAAA,aAAmC;YAChE,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;;YAGzB,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,kDAAgD,IAAI,CAAC,SAAW,CAAC;YAC1F,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,GAAA,CAAC,CAAC;SACzE;QAED,0BAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,GAAA,CAAC,CAAC;SACtD;QAED,2BAAO,GAAP;YACE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,OAAO,KAAK,CAAC,OAAO,KAAK,UAAU,IAAI,KAAK,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;SACxF;QACH,gBAAC;IAAD,CAAC;;ICCD,IAAM,aAAa,GAAuB;QACxC,SAAS,EAAE,EAAE;KACd,CAAC;;QAYA,sBAAY,MAAiD;YAAjD,uBAAA,EAAA,WAAiD;YAC3D,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;YAChD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAErC,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,gCAAS,GAAT;YAAA,iBAgEC;YA/DC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,2BAA2B,CAAC;YAErD,IAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACnD,WAAW,CAAC,SAAS,GAAG,0BAA0B,CAAC;YACnD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;YACtC,WAAW,CAAC,gBAAgB,CAAC,QAAQ,EAAE,UAAC,CAAC;gBACvC,CAAC,CAAC,cAAc,EAAE,CAAC;gBACnB,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,UAAU,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;aACvD,CAAC,CAAC;YAEH,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAC9C,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;YAC3B,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,oBAAoB,CAAC;YAC5C,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,yEAAyE,CAAC;YACjG,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;YAChE,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAEpC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACjD,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC;YAC9B,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,oBAAoB,CAAC;YAC/C,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,uEAAuE,CAAC;YAClG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,GAAA,CAAC,CAAC;YACtE,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAEvC,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;YAClD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,4CAA4C,CAAC;YACzE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,GAAG,CAAC;YAC5B,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAC,CAAC;gBACzC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,UAAU,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;aACvD,CAAC,CAAC;YACH,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEzC,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC;YAC1B,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,oBAAoB,CAAC;YAC3C,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,6CAA6C,CAAC;YACpE,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,GAAA,CAAC,CAAC;YAC9D,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEnC,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC;YAC1B,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,oBAAoB,CAAC;YAC3C,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,+CAA+C,CAAC;YACtE,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,GAAA,CAAC,CAAC;YAC9D,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEnC,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBAChC,IAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBAClD,WAAW,CAAC,SAAS,GAAG,0BAA0B,CAAC;gBACnD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBAEtC,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBACpD,UAAU,CAAC,IAAI,GAAG,QAAQ,CAAC;gBAC3B,UAAU,CAAC,SAAS,GAAG,6CAA6C,CAAC;gBACrE,UAAU,CAAC,SAAS,GAAG,6CAA6C,CAAC;gBACrE,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;gBAEpC,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBAC3C,IAAI,CAAC,SAAS,GAAG,kBAAkB,CAAC;gBACpC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;gBAC3B,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aAC/B;SACF;QAED,6BAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAEhD,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;gBAC3B,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SACF;QAED,8BAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACjD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;QAED,6BAAM,GAAN;YACE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,KAAK,CAAC,CAAC;YAEnE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE;gBACnC,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAC3B,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC/B;iBAAM;gBACL,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;gBAC5B,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC;aAChC;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;gBACjD,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAC1B,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC3B;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBAC3B,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;aAC5B;SACF;QAED,sCAAe,GAAf,UAAgB,IAAiB;YAC/B,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACrC,IAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;gBACpD,eAAe,CAAC,SAAS,GAAG,uBAAuB,CAAC;gBACpD,eAAe,CAAC,QAAQ,GAAG,CAAC,CAAC;gBAC7B,eAAe,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAI,CAAC;gBAC5C,eAAe,CAAC,IAAI,GAAG,qBAAqB,CAAC;gBAE7C,IAAI,QAAQ,CAAC,cAAc,IAAI,QAAQ,CAAC,cAAc,EAAE,EAAE;oBACxD,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;iBACjE;gBAED,eAAe,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,CAAC;oBAC1C,CAAC,CAAC,cAAc,EAAE,CAAC;oBAEnB,IAAM,GAAG,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;oBAEnC,IAAI,QAAQ,CAAC,SAAS,EAAE;wBACtB,IAAI,CAAC,GAAG,EAAE;4BACR,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC,gCAAgC,CAAC,CAAC;yBACpE;6BAAM;4BACL,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;yBACjE;qBACF;oBAED,eAAe,CAAC,IAAI,EAAE,CAAC;iBACxB,CAAC,CAAC;gBAEH,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;aACnC,CAAC,CAAC;SACJ;;;;QAKM,sBAAS,GAAG;;YAEjB,QAAQ,EAAE,UAAC,MAAkB,IAAK,QAAC;gBACjC,IAAI,EAAE,cAAc;gBACpB,WAAW;oBACT,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,MAAM,CAAC;oBACxE,IAAM,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;oBAEpC,IAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;oBAC5C,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE,6CAA2C,kBAAkB,CAAC,GAAG,CAAG,CAAC,CAAC;oBACnG,OAAO,CAAC,YAAY,CAAC,UAAU,EAAK,IAAI,SAAM,CAAC,CAAC;oBAEhD,OAAO,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;oBAC/B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;oBAEnC,OAAO,CAAC,KAAK,EAAE,CAAC;oBAEhB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;iBACpC;aACF,IAAC;;YAGF,kBAAkB,EAAE,UAAC,cAAiC,IAAK,QAAC;gBAC1D,IAAI,EAAE,qBAAqB;gBAC3B,SAAS,EAAE,IAAI;gBACf,WAAW;oBACT,cAAc,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;oBAClE,OAAO,cAAc,CAAC,MAAM,CAAC,WAAW,CAAC;iBAC1C;gBACD,cAAc,EAAE,cAAM,OAAA,cAAc,CAAC,MAAM,CAAC,WAAW,GAAA;aACxD,IAAC;;YAGF,QAAQ,EAAE,UAAC,QAAkB,IAAK,QAAC;gBACjC,IAAI,EAAE,WAAW;gBACjB,SAAS,EAAE,IAAI;gBACf,WAAW;oBACT,QAAQ,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;oBAC9C,OAAO,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC;iBAChC;gBACD,cAAc,EAAE,cAAM,OAAA,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAA;aAC9C,IAAC;SACH,CAAC;QACJ,mBAAC;KAnMD;;;QCdE,6BAAoB,MAAiC,EAAU,SAA6B;YAAxE,WAAM,GAAN,MAAM,CAA2B;YAAU,cAAS,GAAT,SAAS,CAAoB;YAC1F,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;SACvC;QAED,oCAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACtC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAEnC,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;QAED,oCAAM,GAAN;YACE,IAAM,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAE3D,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,qBAAqB,EAAE;;gBAE1C,IAAM,WAAW,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;gBAC7C,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;gBACnE,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC;gBAC3B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtB;iBAAM,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,qBAAqB,EAAE;;gBAEjD,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;gBAChD,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;gBACxE,IAAI,CAAC,OAAO,GAAG,gBAAgB,CAAC;gBAChC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;aACrB;SACF;QAED,qCAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACvC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YAEnB,IAAI,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,KAAK,UAAU,EAAE;gBAChD,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;aAC1B;SACF;QAEO,mDAAqB,GAA7B;YACE,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,CAAC;YACrD,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC;YAEvD,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,KAAK,EAAE;gBAChE,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,MAAM,EAAE;gBACnE,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,KAAK,EAAE;gBAChE,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,MAAM,EAAE;gBACnE,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,KAAK,UAAU,IAAI,KAAK,GAAG,MAAM,EAAE;gBAC5D,OAAO,KAAK,CAAC;aACd;YAED,OAAO,IAAI,CAAC;SACb;QAEO,+CAAiB,GAAzB;;YAEE,OAAO,QAAQ,CAAC,aAAa,CAAC,qCAAkC,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,UAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,MAAG,CAAC,CAAC;SAC7K;QACH,0BAAC;IAAD,CAAC;;;QCxEC,mBAAY,KAAwB;YAClC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,SAAS,GAAG,KAAK,KAAKA,aAAK,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC;YAC/C,IAAI,CAAC,SAAS,GAAG,KAAK,KAAKA,aAAK,CAAC,CAAC,GAAG,OAAO,GAAG,OAAO,CAAC;YAEvD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACvC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACvC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACvC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;YAGvC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,wCAAwC,CAAC;YAElE,IAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACpD,aAAa,CAAC,SAAS,GAAG,8BAA8B,CAAC;YACzD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;YAExC,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACxD,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAElD,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;YACzD,IAAI,CAAC,iBAAiB,CAAC,SAAS,GAAG,oCAAoC,CAAC;YACxE,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAElD,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACvD,IAAI,CAAC,iBAAiB,CAAC,SAAS,GAAG,kEAAgE,IAAI,CAAC,SAAW,CAAC;YACpH,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,GAAG,CAAC;YACzC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;;YAGjD,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SACxD;QAED,0BAAM,GAAN,UAAO,MAAiB;YACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;YAGrB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,iBAAe,IAAI,CAAC,SAAW,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,gBAAc,IAAI,CAAC,SAAS,MAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,gBAAc,IAAI,CAAC,SAAS,MAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;;YAGjD,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;QAED,2BAAO,GAAP;YACE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,iBAAe,IAAI,CAAC,SAAW,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC/D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAc,IAAI,CAAC,SAAS,MAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC/D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAc,IAAI,CAAC,SAAS,MAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC/D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAElD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;QAED,2BAAO,GAAP,UAAQ,KAA6B;YACnC,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC;SACpE;QAED,2BAAO,GAAP,UAAQ,KAA6B;YACnC,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC;SAClD;QAED,2BAAO,GAAP,UAAQ,KAA6B;YACnC,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC;SAClD;QAED,2BAAO,GAAP;YACE,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAC;SACpG;QAEO,8BAAU,GAAlB;YACE,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;gBACxB,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAI,IAAI,CAAC,SAAW,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC;gBAC9G,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAI,IAAI,CAAC,SAAS,MAAG,CAAC,IAAI,EAAE,CAAC;gBAClG,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAI,IAAI,CAAC,SAAS,MAAG,CAAC,IAAI,EAAE,CAAC;aACnG;YACD,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;gBACpB,IAAI,CAAC,OAAO,EAAE,CAAC;aAChB;SACF;QACH,gBAAC;IAAD,CAAC;;ICzED,IAAM4B,eAAa,yBACd,sBAAsB,KACzB,KAAK,EAAE,8BAA8B,EACrC,QAAQ,aACN,OAAO,EAAE,IAAI,IACV,uBAAuB,GAE5B,QAAQ,aACN,OAAO,EAAE,IAAI,IACV,wBAAwB,GAE7B,OAAO,EAAE,IAAI,EACb,GAAG,EAAE,IAAI,GACV,CAAC;;QAEwC,gCAAS;QAIjD,sBAAY,IAAiB,EAAE,MAAiD;YAAjD,uBAAA,EAAA,WAAiD;YAAhF,YACE,iBAAO,SAOR;;YAJC,KAAI,CAAC,MAAM,GAAG,UAAU,CAACA,eAAa,EAAE,MAAM,CAAC,CAAC;YAEhD,KAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,KAAI,CAAC,IAAI,EAAE,CAAC;;SACb;QAED,2BAAI,GAAJ;YAAA,iBA6CC;YA5CC,IAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;YAChC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAEnB,IAAM,iBAAiB,GAAG,IAAI,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAEnE,IAAM,kBAAkB,GAAG;gBACzB,SAAS,EAAE;oBACT,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC;oBACzC,YAAY,CAAC,SAAS,CAAC,kBAAkB,CAAC,iBAAiB,CAAC;oBAC5D,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC;iBACtC;aACF,CAAC;YAEF,IAAM,SAAS,GAAG,IAAI,SAAS,CAAC,QAAQ,EAAE;gBACxC,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,SAAS,CAAC,KAAK,EAAE;oBAC9D,IAAI,SAAS,CAAC5B,aAAK,CAAC,CAAC,CAAC;oBACtB,IAAI,SAAS,CAACA,aAAK,CAAC,CAAC,CAAC;iBACvB,CAAC,CAAC;gBACH,IAAI,SAAS,CAAC,KAAK,EAAE;oBACnB,iBAAiB;oBACjB,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,SAAS,CAAC,QAAQ,EAAE;wBACjE,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,SAAS,CAACA,aAAK,CAAC,CAAC,CAAC,CAAC;wBAClE,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,SAAS,CAACA,aAAK,CAAC,CAAC,CAAC,CAAC;wBAClE,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,YAAY,CAAC,kBAAkB,CAAC,CAAC;wBAChF,IAAI,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;wBACrC,IAAI,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;qBACtC,CAAC,CAAC;iBACJ,CAAC;gBACF,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,YAAY,CAAC,kBAAkB,CAAC,CAAC;gBAChF,IAAI,mBAAmB,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;aAClF,CAAC,CAAC;YAEH,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAErC,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;aAClD;iBAAM,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;;gBAE9B,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAC7B,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,IAAI,EAAE,GAAA,CAC5B,CAAC,IAAI,CACJ,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAA,CAChD,CAAC;aACH;SACF;QACH,mBAAC;IAAD,CA5DA,CAA0C,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}