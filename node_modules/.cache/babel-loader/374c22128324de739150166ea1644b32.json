{"ast":null,"code":"/**\n * SVGoban\n * serializer.js\n *\n */\nvar Geo = require('./geometry');\n\nvar Css = require('./styles');\n/** @todo Replace all string concatenations with ES6 templates? */\n\n\nvar _toElem = function (shapes) {\n  var typeofShape;\n  var txt = null;\n  var ret = '';\n\n  for (var i = 0; i < shapes.length; i++) {\n    typeofShape = shapes[i].type;\n    txt = shapes[i].txt || '';\n    delete shapes[i].txt;\n    delete shapes[i].type;\n    ret += '<' + typeofShape + ' ';\n    ret += 'style=\"';\n\n    for (var j in shapes[i].style) {\n      ret += j + ':' + shapes[i].style[j] + ';';\n    }\n\n    ret += '\" ';\n    delete shapes[i].style;\n\n    for (var k in shapes[i]) {\n      if (k == \"key\") continue;\n      ret += k + '=\"' + shapes[i][k] + '\" ';\n    }\n\n    ret += '>';\n    ret += txt;\n    ret += '</' + typeofShape + '>';\n  }\n\n  return ret;\n};\n\nvar _addBackgroundLayer = function (str, noMargin) {\n  str += '<g class=\"background_layer\">';\n  str += _toElem(Geo.shapeBackground(noMargin));\n  str += '</g>';\n  return str;\n};\n\nvar _addGridLayer = function (str, size) {\n  str += '<g class=\"grid_layer\">';\n  str += _toElem(Geo.shapeGrid(size));\n  str += '</g>';\n  return str;\n};\n\nvar _addStarPointsLayer = function (str, size) {\n  str += '<g class=\"starpoints_layer\">';\n  str += _toElem(Geo.shapeStarPoints(size));\n  str += '</g>';\n  return str;\n};\n\nvar _addStonesLayer = function (str, size, pos) {\n  str += '<g class=\"stones_layer\">';\n  str += _toElem(Geo.shapeStones(size, pos));\n  str += '</g>';\n  return str;\n};\n\nvar _addMarkersLayer = function (str, size, markers, pos) {\n  str += '<g class=\"markers_layer\">';\n  str += _toElem(Geo.shapeMarkers(size, markers, pos));\n  str += '</g>';\n  return str;\n};\n\nvar _addLastMarkersLayer = function (str, size, markers, pos) {\n  str += '<g class=\"Lastmarkers_layer\">';\n  str += _toElem(Geo.shapeMarkers(size, markers, pos));\n  str += '</g>';\n  return str;\n};\n\nvar _addMapLayer = function (str, size, markers, pos) {\n  str += '<g class=\"map_layer\">';\n  str += _toElem(Geo.mapMarkers(size, markers, pos));\n  str += '</g>';\n  return str;\n};\n\nvar _addLettersLayer = function (str, size, coordSystem) {\n  str += '<g class=\"labels_layer\">';\n  str += _toElem(Geo.shapeLabels(size, coordSystem));\n  str += '</g>';\n  return str;\n};\n\nvar _addGradient = function (str, color) {\n  var rad = Css.defineRadialColors(color);\n  var attr = '';\n  attr += 'id=\"' + rad.id + '\" ';\n\n  for (var i in rad.gradient) {\n    attr += i + '=\"' + rad.gradient[i] + '\" ';\n  }\n\n  str += '<radialGradient ';\n  str += attr + '>';\n  str += '<stop offset=\"0%\" style=\"stop-color:' + rad.a + ';stop-opacity:1\" />';\n  str += '<stop offset=\"100%\" style=\"stop-color:' + rad.z + ';stop-opacity:1\" />';\n  str += '</radialGradient>';\n  return str;\n};\n\nvar _addStyles = function (str, theme) {\n  str += '<style type=\"text/css\"><![CDATA[';\n  str += Css.Themes[theme]();\n  str += ']]></style>';\n  return str;\n};\n/**\n * Serializes a full SVG goban into a string.\n *\n * @param {object} config object with size and theme attributes\n * @param {object} pos object containing locations of stones\n * @returns {string} \n */\n\n\nvar serializeSVG = function (config, pos, markers) {\n  var size = config.size || 19;\n  var theme = config.theme || \"classic\";\n  var coordSystem = config.coordSystem || \"A1\";\n  var noMargin = typeof config.noMargin == \"undefined\" ? false : config.noMargin;\n  var hideMargin = typeof config.hideMargin == \"undefined\" ? false : config.hideMargin;\n  var viewBox = Geo.shapeArea(hideMargin, config.zoom, size).join(\" \");\n  var str = '<svg class=\"svgoban\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" ';\n  str += 'height=\"100%\" viewBox=\"' + viewBox + '\" >';\n  str += '<defs>';\n  str = _addGradient(str, \"black\");\n  str = _addGradient(str, \"white\");\n  str = _addStyles(str, theme);\n  str += '</defs>';\n  str += '<g class=\"layers\">';\n  str = _addBackgroundLayer(str, noMargin);\n  str = _addGridLayer(str, size);\n  str = _addLettersLayer(str, size, coordSystem);\n  str = _addStarPointsLayer(str, size);\n  str = _addStonesLayer(str, size, pos);\n  str = _addMarkersLayer(str, size, markers, pos);\n  str = _addLastMarkersLayer(str, size, markers, pos);\n  str = _addMapLayer(str, size, markers, pos);\n  str += '</g>';\n  str += '</svg>';\n  return str;\n};\n\nmodule.exports = serializeSVG;","map":{"version":3,"sources":["/Users/garinegorgmail.com/Downloads/gohackathon-base-client-instance-master/node_modules/svgoban/src/serializer.js"],"names":["Geo","require","Css","_toElem","shapes","typeofShape","txt","ret","i","length","type","j","style","k","_addBackgroundLayer","str","noMargin","shapeBackground","_addGridLayer","size","shapeGrid","_addStarPointsLayer","shapeStarPoints","_addStonesLayer","pos","shapeStones","_addMarkersLayer","markers","shapeMarkers","_addLastMarkersLayer","_addMapLayer","mapMarkers","_addLettersLayer","coordSystem","shapeLabels","_addGradient","color","rad","defineRadialColors","attr","id","gradient","a","z","_addStyles","theme","Themes","serializeSVG","config","hideMargin","viewBox","shapeArea","zoom","join","module","exports"],"mappings":"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","sourcesContent":["/**\n * SVGoban\n * serializer.js\n *\n */\n\nvar Geo = require('./geometry');\nvar Css = require('./styles');\n\n/** @todo Replace all string concatenations with ES6 templates? */\n\n\nvar _toElem = function(shapes) {\n    var typeofShape;\n    var txt = null;\n    var ret = '';\n\n    for (var i = 0; i < shapes.length; i++) {\n        typeofShape = shapes[i].type;\n\n        txt = shapes[i].txt || '';\n        delete shapes[i].txt;\n\n        delete shapes[i].type;\n\tret += '<' + typeofShape + ' ';\n\t\n\tret += 'style=\"';\n\tfor (var j in shapes[i].style) {\n\t    ret += j + ':' + shapes[i].style[j] + ';';\n\t}\n\tret += '\" ';\n        delete shapes[i].style;\n\n\tfor (var k in shapes[i]) {\n\t    if (k == \"key\") continue;\n\t    ret += k + '=\"' + shapes[i][k] + '\" ';\n\t}\n\tret += '>' \n\tret += txt;\n\tret += '</' + typeofShape + '>';\n    }\n    return ret;\n}\n\nvar _addBackgroundLayer = function(str, noMargin) {\n    str += '<g class=\"background_layer\">'\n    str +=   _toElem(Geo.shapeBackground(noMargin));\n    str += '</g>'\n    return str;\n}\n\nvar _addGridLayer = function(str, size) {\n    str += '<g class=\"grid_layer\">'\n    str +=   _toElem(Geo.shapeGrid(size));\n    str += '</g>'\n    return str;\n}\n\nvar _addStarPointsLayer = function(str, size) {\n    str += '<g class=\"starpoints_layer\">'\n    str +=   _toElem(Geo.shapeStarPoints(size));\n    str += '</g>'\n    return str;\n}\n\nvar _addStonesLayer = function(str, size, pos) {\n    str += '<g class=\"stones_layer\">'\n    str +=   _toElem(Geo.shapeStones(size, pos));\n    str += '</g>'\n    return str;\n}\n\nvar _addMarkersLayer = function(str, size, markers, pos) {\n    str += '<g class=\"markers_layer\">'\n    str +=   _toElem(Geo.shapeMarkers(size, markers, pos));\n    str += '</g>'\n    return str;\n}\nvar _addLastMarkersLayer = function(str, size, markers, pos) {\n    str += '<g class=\"Lastmarkers_layer\">'\n    str +=   _toElem(Geo.shapeMarkers(size, markers, pos));\n    str += '</g>'\n    return str;\n}\n\nvar _addMapLayer = function(str, size, markers, pos) {\n    str += '<g class=\"map_layer\">'\n    str +=   _toElem(Geo.mapMarkers(size, markers, pos));\n    str += '</g>'\n    return str;\n}\n\nvar _addLettersLayer = function(str, size, coordSystem) {\n    str += '<g class=\"labels_layer\">'\n    str +=   _toElem(Geo.shapeLabels(size, coordSystem));\n    str += '</g>'\n    return str;\n}\n\nvar _addGradient = function(str, color) {\n    var rad = Css.defineRadialColors(color);\n\tvar attr = '';\n\tattr += 'id=\"' + rad.id + '\" ';\n    for (var i in rad.gradient) {\n        attr += i + '=\"' + rad.gradient[i] + '\" ';\n    }\n    str += '<radialGradient ';\n    str += attr + '>';\n    str += '<stop offset=\"0%\" style=\"stop-color:' + rad.a + ';stop-opacity:1\" />'\n    str += '<stop offset=\"100%\" style=\"stop-color:' + rad.z + ';stop-opacity:1\" />'\n    str += '</radialGradient>';\n    return str;\n}\n\nvar _addStyles = function(str, theme) {\n    str += '<style type=\"text/css\"><![CDATA['\n    str +=   Css.Themes[theme]();\n    str += ']]></style>'\n    return str;\n}\n\n/**\n * Serializes a full SVG goban into a string.\n *\n * @param {object} config object with size and theme attributes\n * @param {object} pos object containing locations of stones\n * @returns {string} \n */\nvar serializeSVG = function(config, pos, markers) {\n    var size = config.size || 19;\n    var theme = config.theme || \"classic\";\n    var coordSystem = config.coordSystem || \"A1\";\n    var noMargin = (typeof(config.noMargin) == \"undefined\") ? false : config.noMargin;\n    var hideMargin = (typeof(config.hideMargin) == \"undefined\") ? false : config.hideMargin;\n    var viewBox = Geo.shapeArea(hideMargin, config.zoom, size).join(\" \");\n    var str = '<svg class=\"svgoban\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" ';\n    str += 'height=\"100%\" viewBox=\"' + viewBox + '\" >';    \n    str += '<defs>';\n    str = _addGradient(str, \"black\");\n    str = _addGradient(str, \"white\");\n    str = _addStyles(str, theme);\n    str += '</defs>';\n    str += '<g class=\"layers\">';\n    str = _addBackgroundLayer(str, noMargin);\n    str = _addGridLayer(str, size);\n    str = _addLettersLayer(str, size, coordSystem);\n    str = _addStarPointsLayer(str, size);\n    str = _addStonesLayer(str, size, pos);\n    str = _addMarkersLayer(str, size, markers, pos);\n    str = _addLastMarkersLayer(str, size, markers, pos);\n    str = _addMapLayer(str, size, markers, pos);\n    str += '</g>';\n    str += '</svg>';\n    return str;\n}\n\nmodule.exports = serializeSVG;\n"]},"metadata":{},"sourceType":"script"}